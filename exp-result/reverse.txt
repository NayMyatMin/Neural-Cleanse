loading dataset
X_test shape (12630, 32, 32, 3)
Y_test shape (12630, 43)
loading model
processing label 17
resetting state
mask_tanh -3.7462409542995845 3.4530466883337865
pattern_tanh -4.798973586874538 3.9704292714645932
step:   0, cost: 0.00E+00, attack: 0.848, loss: 2.626774, ce: 2.626774, reg: 550.424927, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000112, ce: 0.000112, reg: 575.364441, reg_best: 575.364441
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000048, ce: 0.000048, reg: 576.607422, reg_best: 575.364441
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000033, ce: 0.000033, reg: 580.131165, reg_best: 575.364441
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000084, ce: 0.000084, reg: 586.284790, reg_best: 575.364441
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 588.490112, reg_best: 575.364441
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.996, loss: 0.484255, ce: 0.065558, reg: 418.697174, reg_best: 418.697174
step:   7, cost: 1.00E-03, attack: 0.997, loss: 0.329286, ce: 0.040010, reg: 289.276459, reg_best: 289.276459
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.269986, ce: 0.022991, reg: 246.994827, reg_best: 246.994827
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.233334, ce: 0.017944, reg: 215.390625, reg_best: 215.390625
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 1.000, loss: 0.395990, ce: 0.019654, reg: 188.167938, reg_best: 188.167938
step:  11, cost: 2.00E-03, attack: 0.997, loss: 0.370896, ce: 0.040555, reg: 165.170486, reg_best: 165.170486
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.350763, ce: 0.029787, reg: 160.500259, reg_best: 160.500259
step:  13, cost: 2.00E-03, attack: 1.000, loss: 0.313793, ce: 0.004888, reg: 154.452438, reg_best: 154.452438
step:  14, cost: 2.00E-03, attack: 0.997, loss: 0.337654, ce: 0.048741, reg: 144.456284, reg_best: 144.456284
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 1.000, loss: 0.560796, ce: 0.018900, reg: 135.473969, reg_best: 135.473969
step:  16, cost: 4.00E-03, attack: 0.999, loss: 0.548570, ce: 0.029886, reg: 129.670929, reg_best: 129.670929
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.544672, ce: 0.045183, reg: 124.872131, reg_best: 124.872131
step:  18, cost: 4.00E-03, attack: 0.999, loss: 0.499779, ce: 0.023866, reg: 118.978180, reg_best: 118.978180
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.512867, ce: 0.043668, reg: 117.299866, reg_best: 117.299866
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.998, loss: 0.955138, ce: 0.034713, reg: 115.053062, reg_best: 115.053062
step:  21, cost: 8.00E-03, attack: 0.996, loss: 0.944294, ce: 0.066839, reg: 109.681801, reg_best: 109.681801
step:  22, cost: 8.00E-03, attack: 0.999, loss: 0.909000, ce: 0.031232, reg: 109.720985, reg_best: 109.681801
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.947028, ce: 0.079513, reg: 108.439301, reg_best: 108.439301
step:  24, cost: 8.00E-03, attack: 0.998, loss: 0.874869, ce: 0.039049, reg: 104.477516, reg_best: 104.477516
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.993, loss: 1.758124, ce: 0.120245, reg: 102.363449, reg_best: 102.363449
step:  26, cost: 1.60E-02, attack: 0.993, loss: 1.700763, ce: 0.105137, reg: 99.726585, reg_best: 99.726585
step:  27, cost: 1.60E-02, attack: 0.995, loss: 1.680203, ce: 0.097021, reg: 98.948875, reg_best: 98.948875
step:  28, cost: 1.60E-02, attack: 0.990, loss: 1.711812, ce: 0.174014, reg: 96.112381, reg_best: 98.948875
step:  29, cost: 1.60E-02, attack: 0.991, loss: 1.733003, ce: 0.146869, reg: 99.133408, reg_best: 98.948875
step:  30, cost: 1.60E-02, attack: 0.999, loss: 1.609796, ce: 0.025745, reg: 99.003204, reg_best: 98.948875
step:  31, cost: 1.60E-02, attack: 0.991, loss: 1.675801, ce: 0.142737, reg: 95.816475, reg_best: 95.816475
step:  32, cost: 1.60E-02, attack: 0.992, loss: 1.595971, ce: 0.134372, reg: 91.349892, reg_best: 91.349892
step:  33, cost: 1.60E-02, attack: 0.991, loss: 1.631010, ce: 0.146442, reg: 92.785461, reg_best: 91.349892
up cost from 1.60E-02 to 3.20E-02
step:  34, cost: 3.20E-02, attack: 0.990, loss: 3.042298, ce: 0.178074, reg: 89.506981, reg_best: 91.349892
step:  35, cost: 3.20E-02, attack: 0.988, loss: 3.071765, ce: 0.203984, reg: 89.618172, reg_best: 91.349892
step:  36, cost: 3.20E-02, attack: 0.989, loss: 3.097489, ce: 0.188543, reg: 90.904541, reg_best: 91.349892
step:  37, cost: 3.20E-02, attack: 0.985, loss: 3.053792, ce: 0.258719, reg: 87.346031, reg_best: 91.349892
step:  38, cost: 3.20E-02, attack: 0.989, loss: 3.067144, ce: 0.206689, reg: 89.376144, reg_best: 91.349892
down cost from 3.20E-02 to 1.13E-02
step:  39, cost: 1.13E-02, attack: 0.989, loss: 1.188308, ce: 0.178614, reg: 89.245171, reg_best: 91.349892
step:  40, cost: 1.13E-02, attack: 0.992, loss: 1.146283, ce: 0.135742, reg: 89.320030, reg_best: 89.320030
step:  41, cost: 1.13E-02, attack: 0.992, loss: 1.147830, ce: 0.132020, reg: 89.785812, reg_best: 89.320030
step:  42, cost: 1.13E-02, attack: 0.996, loss: 1.113317, ce: 0.074679, reg: 91.803497, reg_best: 89.320030
step:  43, cost: 1.13E-02, attack: 0.994, loss: 1.159192, ce: 0.109717, reg: 92.761414, reg_best: 89.320030
step:  44, cost: 1.13E-02, attack: 0.995, loss: 1.139227, ce: 0.100349, reg: 91.824669, reg_best: 89.320030
up cost from 1.13E-02 to 2.26E-02
step:  45, cost: 2.26E-02, attack: 0.994, loss: 2.111969, ce: 0.116878, reg: 88.171410, reg_best: 88.171410
step:  46, cost: 2.26E-02, attack: 0.983, loss: 2.210779, ce: 0.274034, reg: 85.592842, reg_best: 88.171410
step:  47, cost: 2.26E-02, attack: 0.986, loss: 2.233926, ce: 0.235309, reg: 88.327225, reg_best: 88.171410
step:  48, cost: 2.26E-02, attack: 0.990, loss: 2.135888, ce: 0.191331, reg: 85.938065, reg_best: 88.171410
step:  49, cost: 2.26E-02, attack: 0.982, loss: 2.204408, ce: 0.296719, reg: 84.308739, reg_best: 88.171410
step:  50, cost: 2.26E-02, attack: 0.993, loss: 2.103517, ce: 0.121655, reg: 87.588913, reg_best: 87.588913
step:  51, cost: 2.26E-02, attack: 0.989, loss: 2.162014, ce: 0.163268, reg: 88.332909, reg_best: 87.588913
step:  52, cost: 2.26E-02, attack: 0.986, loss: 2.156253, ce: 0.237111, reg: 84.814926, reg_best: 87.588913
step:  53, cost: 2.26E-02, attack: 0.991, loss: 2.172605, ce: 0.168347, reg: 88.576530, reg_best: 87.588913
step:  54, cost: 2.26E-02, attack: 0.990, loss: 2.107335, ce: 0.143290, reg: 86.799355, reg_best: 87.588913
step:  55, cost: 2.26E-02, attack: 0.991, loss: 2.138907, ce: 0.143391, reg: 88.190208, reg_best: 87.588913
step:  56, cost: 2.26E-02, attack: 0.996, loss: 2.077217, ce: 0.081553, reg: 88.196709, reg_best: 87.588913
step:  57, cost: 2.26E-02, attack: 0.983, loss: 2.201282, ce: 0.273106, reg: 85.214142, reg_best: 87.588913
step:  58, cost: 2.26E-02, attack: 0.994, loss: 2.080405, ce: 0.120631, reg: 86.610565, reg_best: 86.610565
step:  59, cost: 2.26E-02, attack: 0.980, loss: 2.269130, ce: 0.339373, reg: 85.284004, reg_best: 86.610565
step:  60, cost: 2.26E-02, attack: 0.992, loss: 2.118799, ce: 0.146548, reg: 87.162025, reg_best: 86.610565
step:  61, cost: 2.26E-02, attack: 0.989, loss: 2.165414, ce: 0.190728, reg: 87.269608, reg_best: 86.610565
step:  62, cost: 2.26E-02, attack: 0.989, loss: 2.173666, ce: 0.189735, reg: 87.678177, reg_best: 86.610565
step:  63, cost: 2.26E-02, attack: 0.991, loss: 2.046956, ce: 0.168434, reg: 83.003975, reg_best: 83.003975
step:  64, cost: 2.26E-02, attack: 0.979, loss: 2.226188, ce: 0.344339, reg: 83.166763, reg_best: 83.003975
step:  65, cost: 2.26E-02, attack: 0.989, loss: 2.058520, ce: 0.201059, reg: 82.088966, reg_best: 83.003975
step:  66, cost: 2.26E-02, attack: 0.990, loss: 2.091754, ce: 0.172781, reg: 84.807434, reg_best: 83.003975
step:  67, cost: 2.26E-02, attack: 0.990, loss: 2.083774, ce: 0.177750, reg: 84.235184, reg_best: 83.003975
step:  68, cost: 2.26E-02, attack: 0.997, loss: 2.009608, ce: 0.076356, reg: 85.438446, reg_best: 83.003975
step:  69, cost: 2.26E-02, attack: 0.990, loss: 2.070403, ce: 0.161791, reg: 84.349564, reg_best: 83.003975
step:  70, cost: 2.26E-02, attack: 0.989, loss: 2.080329, ce: 0.198414, reg: 83.169701, reg_best: 83.003975
step:  71, cost: 2.26E-02, attack: 0.984, loss: 2.169289, ce: 0.282681, reg: 83.377090, reg_best: 83.003975
step:  72, cost: 2.26E-02, attack: 0.987, loss: 2.089678, ce: 0.231838, reg: 82.105705, reg_best: 83.003975
step:  73, cost: 2.26E-02, attack: 0.991, loss: 2.063179, ce: 0.147898, reg: 84.644272, reg_best: 83.003975
step:  74, cost: 2.26E-02, attack: 0.994, loss: 2.050402, ce: 0.142405, reg: 84.322342, reg_best: 83.003975
step:  75, cost: 2.26E-02, attack: 0.992, loss: 2.062375, ce: 0.143866, reg: 84.786934, reg_best: 83.003975
step:  76, cost: 2.26E-02, attack: 0.987, loss: 2.118867, ce: 0.225173, reg: 83.679909, reg_best: 83.003975
step:  77, cost: 2.26E-02, attack: 0.990, loss: 2.054744, ce: 0.157982, reg: 83.825829, reg_best: 83.003975
step:  78, cost: 2.26E-02, attack: 0.989, loss: 2.045411, ce: 0.187498, reg: 82.108955, reg_best: 83.003975
step:  79, cost: 2.26E-02, attack: 0.988, loss: 2.110683, ce: 0.205154, reg: 84.213303, reg_best: 83.003975
step:  80, cost: 2.26E-02, attack: 0.992, loss: 2.074344, ce: 0.147939, reg: 85.135841, reg_best: 83.003975
step:  81, cost: 2.26E-02, attack: 0.987, loss: 2.070075, ce: 0.215732, reg: 81.951134, reg_best: 83.003975
step:  82, cost: 2.26E-02, attack: 0.987, loss: 2.097386, ce: 0.204715, reg: 83.645035, reg_best: 83.003975
step:  83, cost: 2.26E-02, attack: 0.989, loss: 2.105833, ce: 0.187087, reg: 84.797356, reg_best: 83.003975
step:  84, cost: 2.26E-02, attack: 0.992, loss: 2.095673, ce: 0.129407, reg: 86.897469, reg_best: 83.003975
step:  85, cost: 2.26E-02, attack: 0.995, loss: 2.018102, ce: 0.062430, reg: 86.429276, reg_best: 83.003975
step:  86, cost: 2.26E-02, attack: 0.996, loss: 2.019531, ce: 0.061174, reg: 86.547966, reg_best: 83.003975
step:  87, cost: 2.26E-02, attack: 0.993, loss: 2.003861, ce: 0.135384, reg: 82.575829, reg_best: 82.575829
step:  88, cost: 2.26E-02, attack: 0.988, loss: 2.069681, ce: 0.195412, reg: 82.831795, reg_best: 82.575829
step:  89, cost: 2.26E-02, attack: 0.987, loss: 2.113747, ce: 0.214761, reg: 83.933212, reg_best: 82.575829
step:  90, cost: 2.26E-02, attack: 0.995, loss: 2.025535, ce: 0.087670, reg: 85.642311, reg_best: 82.575829
step:  91, cost: 2.26E-02, attack: 0.990, loss: 2.080093, ce: 0.188820, reg: 83.583237, reg_best: 82.575829
step:  92, cost: 2.26E-02, attack: 0.984, loss: 2.103302, ce: 0.245236, reg: 82.115669, reg_best: 82.575829
step:  93, cost: 2.26E-02, attack: 0.989, loss: 2.081755, ce: 0.179845, reg: 84.053337, reg_best: 82.575829
step:  94, cost: 2.26E-02, attack: 0.990, loss: 2.021703, ce: 0.175070, reg: 81.610390, reg_best: 82.575829
step:  95, cost: 2.26E-02, attack: 0.986, loss: 2.060899, ce: 0.245610, reg: 80.225235, reg_best: 82.575829
down cost from 2.26E-02 to 8.00E-03
step:  96, cost: 8.00E-03, attack: 0.997, loss: 0.749727, ce: 0.074261, reg: 84.433220, reg_best: 82.575829
step:  97, cost: 8.00E-03, attack: 0.993, loss: 0.783474, ce: 0.108437, reg: 84.379654, reg_best: 82.575829
step:  98, cost: 8.00E-03, attack: 0.994, loss: 0.798442, ce: 0.117239, reg: 85.150360, reg_best: 82.575829
step:  99, cost: 8.00E-03, attack: 0.997, loss: 0.766802, ce: 0.044427, reg: 90.296898, reg_best: 82.575829
pattern, shape: (32, 32, 3), min: 0.000008, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 17: 84.404083
visualization cost 32.356516 seconds
processing label 0
resetting state
mask_tanh -5.462564342814189 3.939082937948137
pattern_tanh -4.4555964568747966 4.3607454704322555
step:   0, cost: 0.00E+00, attack: 0.872, loss: 2.140462, ce: 2.140462, reg: 540.864868, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.002795, ce: 0.002795, reg: 561.541321, reg_best: 561.541321
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000008, ce: 0.000008, reg: 565.474731, reg_best: 561.541321
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000011, ce: 0.000011, reg: 566.132996, reg_best: 561.541321
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000003, ce: 0.000003, reg: 567.790344, reg_best: 561.541321
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 568.543335, reg_best: 561.541321
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.998, loss: 0.416730, ce: 0.036165, reg: 380.564667, reg_best: 380.564667
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.300053, ce: 0.034189, reg: 265.864136, reg_best: 265.864136
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.234334, ce: 0.009642, reg: 224.691910, reg_best: 224.691910
step:   9, cost: 1.00E-03, attack: 1.000, loss: 0.201944, ce: 0.010058, reg: 191.885620, reg_best: 191.885620
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 1.000, loss: 0.335945, ce: 0.002289, reg: 166.827972, reg_best: 166.827972
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.284234, ce: 0.024862, reg: 129.685989, reg_best: 129.685989
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.236445, ce: 0.008905, reg: 113.769867, reg_best: 113.769867
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.216572, ce: 0.012870, reg: 101.851189, reg_best: 101.851189
step:  14, cost: 2.00E-03, attack: 1.000, loss: 0.198510, ce: 0.009308, reg: 94.575096, reg_best: 94.575096
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.999, loss: 0.356722, ce: 0.019026, reg: 84.423897, reg_best: 84.423897
step:  16, cost: 4.00E-03, attack: 1.000, loss: 0.317937, ce: 0.005937, reg: 78.000008, reg_best: 78.000008
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.320952, ce: 0.027561, reg: 73.347580, reg_best: 73.347580
step:  18, cost: 4.00E-03, attack: 0.997, loss: 0.329148, ce: 0.035359, reg: 73.447327, reg_best: 73.347580
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.297602, ce: 0.014245, reg: 70.839363, reg_best: 70.839363
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.999, loss: 0.516635, ce: 0.023182, reg: 61.681652, reg_best: 61.681652
step:  21, cost: 8.00E-03, attack: 0.991, loss: 0.603746, ce: 0.138321, reg: 58.178127, reg_best: 58.178127
step:  22, cost: 8.00E-03, attack: 1.000, loss: 0.488897, ce: 0.007269, reg: 60.203396, reg_best: 58.178127
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.554883, ce: 0.082673, reg: 59.026295, reg_best: 58.178127
step:  24, cost: 8.00E-03, attack: 0.998, loss: 0.505577, ce: 0.038481, reg: 58.387012, reg_best: 58.178127
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.990, loss: 1.042851, ce: 0.167226, reg: 54.726551, reg_best: 58.178127
step:  26, cost: 1.60E-02, attack: 0.993, loss: 0.972785, ce: 0.115978, reg: 53.550434, reg_best: 53.550434
step:  27, cost: 1.60E-02, attack: 0.997, loss: 0.889846, ce: 0.042994, reg: 52.916397, reg_best: 52.916397
step:  28, cost: 1.60E-02, attack: 0.992, loss: 0.946495, ce: 0.123539, reg: 51.434784, reg_best: 51.434784
step:  29, cost: 1.60E-02, attack: 0.990, loss: 0.958131, ce: 0.148500, reg: 50.601971, reg_best: 51.434784
step:  30, cost: 1.60E-02, attack: 0.993, loss: 0.931583, ce: 0.104125, reg: 51.716080, reg_best: 51.434784
step:  31, cost: 1.60E-02, attack: 0.996, loss: 0.896071, ce: 0.059948, reg: 52.257664, reg_best: 51.434784
step:  32, cost: 1.60E-02, attack: 0.995, loss: 0.919763, ce: 0.091943, reg: 51.738785, reg_best: 51.434784
step:  33, cost: 1.60E-02, attack: 0.993, loss: 0.907048, ce: 0.123849, reg: 48.949894, reg_best: 48.949894
step:  34, cost: 1.60E-02, attack: 0.995, loss: 0.899735, ce: 0.077632, reg: 51.381428, reg_best: 48.949894
up cost from 1.60E-02 to 3.20E-02
step:  35, cost: 3.20E-02, attack: 0.992, loss: 1.757915, ce: 0.151656, reg: 50.195602, reg_best: 48.949894
step:  36, cost: 3.20E-02, attack: 0.989, loss: 1.685040, ce: 0.187643, reg: 46.793652, reg_best: 48.949894
step:  37, cost: 3.20E-02, attack: 0.987, loss: 1.701696, ce: 0.219343, reg: 46.323502, reg_best: 48.949894
step:  38, cost: 3.20E-02, attack: 0.990, loss: 1.666673, ce: 0.164790, reg: 46.933846, reg_best: 48.949894
step:  39, cost: 3.20E-02, attack: 0.990, loss: 1.678853, ce: 0.164614, reg: 47.319935, reg_best: 48.949894
step:  40, cost: 3.20E-02, attack: 0.990, loss: 1.715789, ce: 0.180828, reg: 47.968662, reg_best: 48.949894
down cost from 3.20E-02 to 1.13E-02
step:  41, cost: 1.13E-02, attack: 0.996, loss: 0.617495, ce: 0.067134, reg: 48.645535, reg_best: 48.645535
step:  42, cost: 1.13E-02, attack: 0.996, loss: 0.618500, ce: 0.066920, reg: 48.753220, reg_best: 48.645535
step:  43, cost: 1.13E-02, attack: 0.997, loss: 0.619045, ce: 0.052696, reg: 50.058643, reg_best: 48.645535
step:  44, cost: 1.13E-02, attack: 0.996, loss: 0.650064, ce: 0.069275, reg: 51.334942, reg_best: 48.645535
step:  45, cost: 1.13E-02, attack: 0.996, loss: 0.614278, ce: 0.057577, reg: 49.205902, reg_best: 48.645535
up cost from 1.13E-02 to 2.26E-02
step:  46, cost: 2.26E-02, attack: 0.994, loss: 1.196809, ce: 0.109614, reg: 48.047665, reg_best: 48.047665
step:  47, cost: 2.26E-02, attack: 0.993, loss: 1.229363, ce: 0.120269, reg: 49.015503, reg_best: 48.047665
step:  48, cost: 2.26E-02, attack: 0.993, loss: 1.187758, ce: 0.102561, reg: 47.959396, reg_best: 47.959396
step:  49, cost: 2.26E-02, attack: 0.987, loss: 1.315267, ce: 0.210219, reg: 48.836685, reg_best: 47.959396
step:  50, cost: 2.26E-02, attack: 0.994, loss: 1.247090, ce: 0.111512, reg: 50.185936, reg_best: 47.959396
step:  51, cost: 2.26E-02, attack: 0.985, loss: 1.264369, ce: 0.233016, reg: 45.579796, reg_best: 47.959396
step:  52, cost: 2.26E-02, attack: 0.987, loss: 1.307458, ce: 0.208365, reg: 48.599365, reg_best: 47.959396
step:  53, cost: 2.26E-02, attack: 0.992, loss: 1.222768, ce: 0.132134, reg: 48.199677, reg_best: 47.959396
step:  54, cost: 2.26E-02, attack: 0.991, loss: 1.235309, ce: 0.138882, reg: 48.455658, reg_best: 47.959396
step:  55, cost: 2.26E-02, attack: 0.994, loss: 1.199768, ce: 0.113140, reg: 48.022610, reg_best: 47.959396
step:  56, cost: 2.26E-02, attack: 0.990, loss: 1.225785, ce: 0.161392, reg: 47.039948, reg_best: 47.959396
step:  57, cost: 2.26E-02, attack: 0.991, loss: 1.267642, ce: 0.168152, reg: 48.591038, reg_best: 47.959396
step:  58, cost: 2.26E-02, attack: 0.993, loss: 1.192994, ce: 0.120945, reg: 47.378292, reg_best: 47.378292
step:  59, cost: 2.26E-02, attack: 0.993, loss: 1.248843, ce: 0.108714, reg: 50.387054, reg_best: 47.378292
step:  60, cost: 2.26E-02, attack: 0.996, loss: 1.170379, ce: 0.062815, reg: 48.947880, reg_best: 47.378292
step:  61, cost: 2.26E-02, attack: 0.983, loss: 1.267086, ce: 0.271189, reg: 44.012859, reg_best: 47.378292
step:  62, cost: 2.26E-02, attack: 0.993, loss: 1.187281, ce: 0.123615, reg: 47.007820, reg_best: 47.007820
step:  63, cost: 2.26E-02, attack: 0.992, loss: 1.223067, ce: 0.136039, reg: 48.040329, reg_best: 47.007820
step:  64, cost: 2.26E-02, attack: 0.989, loss: 1.240325, ce: 0.168404, reg: 47.372669, reg_best: 47.007820
step:  65, cost: 2.26E-02, attack: 0.998, loss: 1.177972, ce: 0.044160, reg: 50.112946, reg_best: 47.007820
step:  66, cost: 2.26E-02, attack: 0.996, loss: 1.175406, ce: 0.070172, reg: 48.844917, reg_best: 47.007820
step:  67, cost: 2.26E-02, attack: 0.999, loss: 1.122555, ce: 0.039921, reg: 47.846111, reg_best: 47.007820
step:  68, cost: 2.26E-02, attack: 0.989, loss: 1.254058, ce: 0.182502, reg: 47.356548, reg_best: 47.007820
step:  69, cost: 2.26E-02, attack: 0.992, loss: 1.226854, ce: 0.136905, reg: 48.169395, reg_best: 47.007820
step:  70, cost: 2.26E-02, attack: 0.995, loss: 1.221125, ce: 0.093797, reg: 49.821304, reg_best: 47.007820
step:  71, cost: 2.26E-02, attack: 0.995, loss: 1.146208, ce: 0.082918, reg: 46.991219, reg_best: 46.991219
step:  72, cost: 2.26E-02, attack: 0.996, loss: 1.161682, ce: 0.070329, reg: 48.231453, reg_best: 46.991219
step:  73, cost: 2.26E-02, attack: 0.987, loss: 1.226705, ce: 0.209845, reg: 44.939301, reg_best: 46.991219
step:  74, cost: 2.26E-02, attack: 0.987, loss: 1.261832, ce: 0.232866, reg: 45.474300, reg_best: 46.991219
step:  75, cost: 2.26E-02, attack: 0.992, loss: 1.184905, ce: 0.149313, reg: 45.767136, reg_best: 45.767136
step:  76, cost: 2.26E-02, attack: 0.988, loss: 1.246341, ce: 0.204393, reg: 46.048046, reg_best: 45.767136
step:  77, cost: 2.26E-02, attack: 0.990, loss: 1.241433, ce: 0.182363, reg: 46.804729, reg_best: 45.767136
step:  78, cost: 2.26E-02, attack: 0.996, loss: 1.153695, ce: 0.057593, reg: 48.439835, reg_best: 45.767136
step:  79, cost: 2.26E-02, attack: 0.995, loss: 1.131210, ce: 0.084070, reg: 46.277466, reg_best: 45.767136
step:  80, cost: 2.26E-02, attack: 0.995, loss: 1.160877, ce: 0.086940, reg: 47.461800, reg_best: 45.767136
step:  81, cost: 2.26E-02, attack: 0.991, loss: 1.200780, ce: 0.155359, reg: 46.201530, reg_best: 45.767136
step:  82, cost: 2.26E-02, attack: 0.990, loss: 1.229363, ce: 0.168953, reg: 46.863914, reg_best: 45.767136
step:  83, cost: 2.26E-02, attack: 0.993, loss: 1.195709, ce: 0.108055, reg: 48.067928, reg_best: 45.767136
step:  84, cost: 2.26E-02, attack: 0.990, loss: 1.261724, ce: 0.166686, reg: 48.394302, reg_best: 45.767136
step:  85, cost: 2.26E-02, attack: 0.995, loss: 1.157854, ce: 0.078081, reg: 47.719704, reg_best: 45.767136
step:  86, cost: 2.26E-02, attack: 0.995, loss: 1.174447, ce: 0.096579, reg: 47.635475, reg_best: 45.767136
step:  87, cost: 2.26E-02, attack: 0.994, loss: 1.162623, ce: 0.091913, reg: 47.319126, reg_best: 45.767136
step:  88, cost: 2.26E-02, attack: 0.988, loss: 1.231086, ce: 0.202203, reg: 45.470638, reg_best: 45.767136
step:  89, cost: 2.26E-02, attack: 0.988, loss: 1.236369, ce: 0.195554, reg: 45.997948, reg_best: 45.767136
step:  90, cost: 2.26E-02, attack: 0.989, loss: 1.212279, ce: 0.170420, reg: 46.044098, reg_best: 45.767136
step:  91, cost: 2.26E-02, attack: 0.984, loss: 1.285346, ce: 0.269187, reg: 44.902496, reg_best: 45.767136
step:  92, cost: 2.26E-02, attack: 0.991, loss: 1.203418, ce: 0.150386, reg: 46.537865, reg_best: 45.767136
step:  93, cost: 2.26E-02, attack: 0.993, loss: 1.196730, ce: 0.111055, reg: 47.980492, reg_best: 45.767136
step:  94, cost: 2.26E-02, attack: 0.996, loss: 1.155934, ce: 0.061139, reg: 48.383568, reg_best: 45.767136
step:  95, cost: 2.26E-02, attack: 0.994, loss: 1.165301, ce: 0.102514, reg: 46.968987, reg_best: 45.767136
step:  96, cost: 2.26E-02, attack: 0.983, loss: 1.288411, ce: 0.283455, reg: 44.413200, reg_best: 45.767136
step:  97, cost: 2.26E-02, attack: 0.995, loss: 1.150266, ce: 0.100075, reg: 46.412354, reg_best: 45.767136
step:  98, cost: 2.26E-02, attack: 0.994, loss: 1.177827, ce: 0.097826, reg: 47.729755, reg_best: 45.767136
step:  99, cost: 2.26E-02, attack: 0.995, loss: 1.127797, ce: 0.082162, reg: 46.210957, reg_best: 45.767136
pattern, shape: (32, 32, 3), min: 0.000015, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 0: 45.981934
visualization cost 20.446746 seconds
processing label 1
resetting state
mask_tanh -3.9770959784242064 3.752612594584853
pattern_tanh -4.843842538160001 3.8968843099466044
step:   0, cost: 0.00E+00, attack: 0.902, loss: 1.685130, ce: 1.685130, reg: 529.937195, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000025, ce: 0.000025, reg: 546.378357, reg_best: 546.378357
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000003, ce: 0.000003, reg: 546.813416, reg_best: 546.378357
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 546.958557, reg_best: 546.378357
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 547.559631, reg_best: 546.378357
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 548.483154, reg_best: 546.378357
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.453565, ce: 0.060509, reg: 393.055725, reg_best: 393.055725
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.332123, ce: 0.017671, reg: 314.452240, reg_best: 314.452240
step:   8, cost: 1.00E-03, attack: 0.998, loss: 0.284019, ce: 0.038120, reg: 245.899185, reg_best: 245.899185
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.222768, ce: 0.012722, reg: 210.046158, reg_best: 210.046158
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.998, loss: 0.356767, ce: 0.031945, reg: 162.411255, reg_best: 162.411255
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.274450, ce: 0.033286, reg: 120.582291, reg_best: 120.582291
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.259383, ce: 0.017684, reg: 120.849808, reg_best: 120.582291
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.239742, ce: 0.035012, reg: 102.364815, reg_best: 102.364815
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.219087, ce: 0.009665, reg: 104.711220, reg_best: 102.364815
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.997, loss: 0.405560, ce: 0.054057, reg: 87.875816, reg_best: 87.875816
step:  16, cost: 4.00E-03, attack: 0.999, loss: 0.374851, ce: 0.020989, reg: 88.460091, reg_best: 87.875816
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.358291, ce: 0.024713, reg: 83.394508, reg_best: 83.394508
step:  18, cost: 4.00E-03, attack: 0.998, loss: 0.353661, ce: 0.026098, reg: 81.890869, reg_best: 81.890869
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.340802, ce: 0.025358, reg: 78.860977, reg_best: 78.860977
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.997, loss: 0.660728, ce: 0.037572, reg: 77.894516, reg_best: 77.894516
step:  21, cost: 8.00E-03, attack: 0.993, loss: 0.658179, ce: 0.114509, reg: 67.958702, reg_best: 67.958702
step:  22, cost: 8.00E-03, attack: 0.994, loss: 0.649747, ce: 0.106156, reg: 67.948898, reg_best: 67.948898
step:  23, cost: 8.00E-03, attack: 0.998, loss: 0.583966, ce: 0.031659, reg: 69.038353, reg_best: 67.948898
step:  24, cost: 8.00E-03, attack: 0.998, loss: 0.594353, ce: 0.041157, reg: 69.149513, reg_best: 67.948898
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.988, loss: 1.178685, ce: 0.190391, reg: 61.768349, reg_best: 67.948898
step:  26, cost: 1.60E-02, attack: 0.978, loss: 1.294516, ce: 0.366199, reg: 58.019814, reg_best: 67.948898
step:  27, cost: 1.60E-02, attack: 0.979, loss: 1.288011, ce: 0.340584, reg: 59.214191, reg_best: 67.948898
step:  28, cost: 1.60E-02, attack: 0.994, loss: 1.083071, ce: 0.110888, reg: 60.761402, reg_best: 60.761402
step:  29, cost: 1.60E-02, attack: 0.998, loss: 1.033470, ce: 0.053550, reg: 61.261620, reg_best: 60.761402
step:  30, cost: 1.60E-02, attack: 0.990, loss: 1.075260, ce: 0.147784, reg: 57.967236, reg_best: 60.761402
step:  31, cost: 1.60E-02, attack: 0.988, loss: 1.107532, ce: 0.194462, reg: 57.066830, reg_best: 60.761402
step:  32, cost: 1.60E-02, attack: 0.996, loss: 1.014069, ce: 0.061362, reg: 59.544144, reg_best: 59.544144
step:  33, cost: 1.60E-02, attack: 0.989, loss: 1.107272, ce: 0.190490, reg: 57.298874, reg_best: 59.544144
step:  34, cost: 1.60E-02, attack: 0.989, loss: 1.087557, ce: 0.170711, reg: 57.302860, reg_best: 59.544144
step:  35, cost: 1.60E-02, attack: 0.989, loss: 1.038135, ce: 0.179956, reg: 53.636177, reg_best: 59.544144
step:  36, cost: 1.60E-02, attack: 0.991, loss: 1.026760, ce: 0.148672, reg: 54.880531, reg_best: 54.880531
step:  37, cost: 1.60E-02, attack: 0.996, loss: 0.990848, ce: 0.065938, reg: 57.806889, reg_best: 54.880531
step:  38, cost: 1.60E-02, attack: 0.994, loss: 1.018274, ce: 0.092319, reg: 57.872227, reg_best: 54.880531
step:  39, cost: 1.60E-02, attack: 0.994, loss: 1.040053, ce: 0.097893, reg: 58.884960, reg_best: 54.880531
step:  40, cost: 1.60E-02, attack: 0.993, loss: 1.012894, ce: 0.096274, reg: 57.288731, reg_best: 54.880531
up cost from 1.60E-02 to 3.20E-02
step:  41, cost: 3.20E-02, attack: 0.994, loss: 1.929519, ce: 0.090769, reg: 57.460911, reg_best: 54.880531
step:  42, cost: 3.20E-02, attack: 0.987, loss: 1.939617, ce: 0.224688, reg: 53.567375, reg_best: 54.880531
step:  43, cost: 3.20E-02, attack: 0.979, loss: 2.016678, ce: 0.337242, reg: 52.482391, reg_best: 54.880531
step:  44, cost: 3.20E-02, attack: 0.984, loss: 1.859149, ce: 0.250919, reg: 50.257179, reg_best: 54.880531
step:  45, cost: 3.20E-02, attack: 0.979, loss: 1.946845, ce: 0.359397, reg: 49.607735, reg_best: 54.880531
step:  46, cost: 3.20E-02, attack: 0.988, loss: 1.904227, ce: 0.192695, reg: 53.485344, reg_best: 54.880531
down cost from 3.20E-02 to 1.13E-02
step:  47, cost: 1.13E-02, attack: 0.994, loss: 0.706728, ce: 0.081738, reg: 55.241817, reg_best: 54.880531
step:  48, cost: 1.13E-02, attack: 0.996, loss: 0.712160, ce: 0.071651, reg: 56.613605, reg_best: 54.880531
step:  49, cost: 1.13E-02, attack: 0.991, loss: 0.771489, ce: 0.146619, reg: 55.231197, reg_best: 54.880531
step:  50, cost: 1.13E-02, attack: 0.990, loss: 0.762084, ce: 0.160225, reg: 53.197254, reg_best: 54.880531
step:  51, cost: 1.13E-02, attack: 0.996, loss: 0.691843, ce: 0.077377, reg: 54.311623, reg_best: 54.311623
step:  52, cost: 1.13E-02, attack: 0.995, loss: 0.706294, ce: 0.078719, reg: 55.470257, reg_best: 54.311623
step:  53, cost: 1.13E-02, attack: 0.994, loss: 0.711205, ce: 0.101888, reg: 53.856533, reg_best: 53.856533
step:  54, cost: 1.13E-02, attack: 0.990, loss: 0.777982, ce: 0.172445, reg: 53.529144, reg_best: 53.856533
step:  55, cost: 1.13E-02, attack: 0.996, loss: 0.710813, ce: 0.066485, reg: 56.951096, reg_best: 53.856533
step:  56, cost: 1.13E-02, attack: 0.998, loss: 0.685439, ce: 0.038515, reg: 57.180519, reg_best: 53.856533
step:  57, cost: 1.13E-02, attack: 0.998, loss: 0.685052, ce: 0.047259, reg: 56.373497, reg_best: 53.856533
step:  58, cost: 1.13E-02, attack: 0.998, loss: 0.667051, ce: 0.045799, reg: 54.911465, reg_best: 53.856533
step:  59, cost: 1.13E-02, attack: 0.992, loss: 0.750263, ce: 0.135559, reg: 54.332653, reg_best: 53.856533
up cost from 1.13E-02 to 2.26E-02
step:  60, cost: 2.26E-02, attack: 0.986, loss: 1.417236, ce: 0.223623, reg: 52.750740, reg_best: 53.856533
step:  61, cost: 2.26E-02, attack: 0.990, loss: 1.347405, ce: 0.154835, reg: 52.704639, reg_best: 53.856533
step:  62, cost: 2.26E-02, attack: 0.990, loss: 1.308186, ce: 0.163747, reg: 50.577522, reg_best: 53.856533
step:  63, cost: 2.26E-02, attack: 0.987, loss: 1.357972, ce: 0.209541, reg: 50.753979, reg_best: 53.856533
step:  64, cost: 2.26E-02, attack: 0.988, loss: 1.366633, ce: 0.208465, reg: 51.184284, reg_best: 53.856533
down cost from 2.26E-02 to 8.00E-03
step:  65, cost: 8.00E-03, attack: 0.995, loss: 0.514093, ce: 0.084396, reg: 53.712074, reg_best: 53.712074
step:  66, cost: 8.00E-03, attack: 0.995, loss: 0.525880, ce: 0.082273, reg: 55.450897, reg_best: 53.712074
step:  67, cost: 8.00E-03, attack: 0.997, loss: 0.475568, ce: 0.057004, reg: 52.304485, reg_best: 52.304485
step:  68, cost: 8.00E-03, attack: 0.993, loss: 0.537880, ce: 0.115495, reg: 52.798004, reg_best: 52.304485
step:  69, cost: 8.00E-03, attack: 0.995, loss: 0.498248, ce: 0.070784, reg: 53.433067, reg_best: 52.304485
up cost from 8.00E-03 to 1.60E-02
step:  70, cost: 1.60E-02, attack: 0.992, loss: 0.981592, ce: 0.129116, reg: 53.279766, reg_best: 52.304485
step:  71, cost: 1.60E-02, attack: 0.996, loss: 0.960785, ce: 0.070778, reg: 55.625416, reg_best: 52.304485
step:  72, cost: 1.60E-02, attack: 0.996, loss: 0.927718, ce: 0.059572, reg: 54.259163, reg_best: 52.304485
step:  73, cost: 1.60E-02, attack: 0.990, loss: 1.014336, ce: 0.173169, reg: 52.572960, reg_best: 52.304485
step:  74, cost: 1.60E-02, attack: 0.991, loss: 0.958356, ce: 0.154084, reg: 50.266964, reg_best: 50.266964
step:  75, cost: 1.60E-02, attack: 0.986, loss: 1.041943, ce: 0.215212, reg: 51.670670, reg_best: 50.266964
step:  76, cost: 1.60E-02, attack: 0.992, loss: 0.960548, ce: 0.143636, reg: 51.056980, reg_best: 50.266964
step:  77, cost: 1.60E-02, attack: 0.992, loss: 0.980397, ce: 0.124892, reg: 53.469032, reg_best: 50.266964
step:  78, cost: 1.60E-02, attack: 0.997, loss: 0.911800, ce: 0.056283, reg: 53.469799, reg_best: 50.266964
step:  79, cost: 1.60E-02, attack: 0.997, loss: 0.865677, ce: 0.056799, reg: 50.554893, reg_best: 50.266964
step:  80, cost: 1.60E-02, attack: 0.989, loss: 0.969558, ce: 0.166190, reg: 50.194893, reg_best: 50.266964
step:  81, cost: 1.60E-02, attack: 0.995, loss: 0.929969, ce: 0.090595, reg: 52.460838, reg_best: 50.266964
step:  82, cost: 1.60E-02, attack: 0.989, loss: 1.020844, ce: 0.173034, reg: 52.988140, reg_best: 50.266964
step:  83, cost: 1.60E-02, attack: 0.995, loss: 0.898153, ce: 0.088946, reg: 50.575466, reg_best: 50.266964
step:  84, cost: 1.60E-02, attack: 0.994, loss: 0.937396, ce: 0.120816, reg: 51.036228, reg_best: 50.266964
step:  85, cost: 1.60E-02, attack: 0.995, loss: 0.921055, ce: 0.091622, reg: 51.839531, reg_best: 50.266964
step:  86, cost: 1.60E-02, attack: 0.994, loss: 0.938676, ce: 0.103231, reg: 52.215275, reg_best: 50.266964
step:  87, cost: 1.60E-02, attack: 0.991, loss: 0.984775, ce: 0.154090, reg: 51.917862, reg_best: 50.266964
up cost from 1.60E-02 to 3.20E-02
step:  88, cost: 3.20E-02, attack: 0.992, loss: 1.744839, ce: 0.129725, reg: 50.472286, reg_best: 50.266964
step:  89, cost: 3.20E-02, attack: 0.988, loss: 1.750012, ce: 0.200902, reg: 48.409687, reg_best: 50.266964
step:  90, cost: 3.20E-02, attack: 0.985, loss: 1.789434, ce: 0.232751, reg: 48.646336, reg_best: 50.266964
step:  91, cost: 3.20E-02, attack: 0.987, loss: 1.765300, ce: 0.224951, reg: 48.135918, reg_best: 50.266964
step:  92, cost: 3.20E-02, attack: 0.987, loss: 1.760125, ce: 0.201133, reg: 48.718479, reg_best: 50.266964
step:  93, cost: 3.20E-02, attack: 0.989, loss: 1.749565, ce: 0.167665, reg: 49.425648, reg_best: 50.266964
down cost from 3.20E-02 to 1.13E-02
step:  94, cost: 1.13E-02, attack: 0.989, loss: 0.748814, ce: 0.194792, reg: 48.969032, reg_best: 50.266964
step:  95, cost: 1.13E-02, attack: 0.992, loss: 0.703537, ce: 0.136070, reg: 50.157486, reg_best: 50.157486
step:  96, cost: 1.13E-02, attack: 0.994, loss: 0.728800, ce: 0.115316, reg: 54.224773, reg_best: 50.157486
step:  97, cost: 1.13E-02, attack: 0.995, loss: 0.690964, ce: 0.075995, reg: 54.356098, reg_best: 50.157486
step:  98, cost: 1.13E-02, attack: 0.996, loss: 0.673723, ce: 0.064523, reg: 53.846233, reg_best: 50.157486
step:  99, cost: 1.13E-02, attack: 0.998, loss: 0.648585, ce: 0.035749, reg: 54.167561, reg_best: 50.157486
up cost from 1.13E-02 to 2.26E-02
pattern, shape: (32, 32, 3), min: 0.000008, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 1: 48.352943
visualization cost 22.464660 seconds
processing label 2
resetting state
mask_tanh -3.2321952335854456 3.756110846598506
pattern_tanh -4.191190685362992 4.709132145323953
step:   0, cost: 0.00E+00, attack: 0.884, loss: 1.938996, ce: 1.938996, reg: 538.946655, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.001753, ce: 0.001753, reg: 550.340332, reg_best: 550.340332
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.003004, ce: 0.003004, reg: 559.707642, reg_best: 550.340332
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 569.672302, reg_best: 550.340332
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 569.713989, reg_best: 550.340332
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 569.801208, reg_best: 550.340332
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.998, loss: 0.400739, ce: 0.040840, reg: 359.898346, reg_best: 359.898346
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.308712, ce: 0.031922, reg: 276.790344, reg_best: 276.790344
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.222890, ce: 0.004158, reg: 218.732010, reg_best: 218.732010
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.228003, ce: 0.035426, reg: 192.577316, reg_best: 192.577316
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.371606, ce: 0.015814, reg: 177.896027, reg_best: 177.896027
step:  11, cost: 2.00E-03, attack: 1.000, loss: 0.321637, ce: 0.013095, reg: 154.270950, reg_best: 154.270950
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.325511, ce: 0.032576, reg: 146.467499, reg_best: 146.467499
step:  13, cost: 2.00E-03, attack: 0.998, loss: 0.302793, ce: 0.044491, reg: 129.151169, reg_best: 129.151169
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.286183, ce: 0.020442, reg: 132.870728, reg_best: 129.151169
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.997, loss: 0.553491, ce: 0.042171, reg: 127.830070, reg_best: 127.830070
step:  16, cost: 4.00E-03, attack: 0.996, loss: 0.489289, ce: 0.052552, reg: 109.184357, reg_best: 109.184357
step:  17, cost: 4.00E-03, attack: 0.995, loss: 0.499644, ce: 0.083107, reg: 104.134163, reg_best: 104.134163
step:  18, cost: 4.00E-03, attack: 0.998, loss: 0.445389, ce: 0.041393, reg: 101.011803, reg_best: 101.011803
step:  19, cost: 4.00E-03, attack: 0.997, loss: 0.461428, ce: 0.066540, reg: 98.721970, reg_best: 98.721970
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.998, loss: 0.787224, ce: 0.042473, reg: 93.093834, reg_best: 93.093834
step:  21, cost: 8.00E-03, attack: 0.990, loss: 0.843989, ce: 0.158876, reg: 85.639099, reg_best: 93.093834
step:  22, cost: 8.00E-03, attack: 0.994, loss: 0.756457, ce: 0.115258, reg: 80.149811, reg_best: 80.149811
step:  23, cost: 8.00E-03, attack: 0.986, loss: 0.835667, ce: 0.218818, reg: 77.106056, reg_best: 80.149811
step:  24, cost: 8.00E-03, attack: 0.998, loss: 0.672270, ce: 0.040762, reg: 78.938492, reg_best: 78.938492
step:  25, cost: 8.00E-03, attack: 0.994, loss: 0.736130, ce: 0.103687, reg: 79.055260, reg_best: 78.938492
step:  26, cost: 8.00E-03, attack: 0.995, loss: 0.683155, ce: 0.064612, reg: 77.317902, reg_best: 77.317902
step:  27, cost: 8.00E-03, attack: 0.998, loss: 0.669639, ce: 0.041543, reg: 78.511948, reg_best: 77.317902
step:  28, cost: 8.00E-03, attack: 0.999, loss: 0.611833, ce: 0.027584, reg: 73.031075, reg_best: 73.031075
up cost from 8.00E-03 to 1.60E-02
step:  29, cost: 1.60E-02, attack: 0.992, loss: 1.208730, ce: 0.124524, reg: 67.762871, reg_best: 67.762871
step:  30, cost: 1.60E-02, attack: 0.994, loss: 1.197176, ce: 0.123461, reg: 67.107170, reg_best: 67.107170
step:  31, cost: 1.60E-02, attack: 0.999, loss: 1.075157, ce: 0.011773, reg: 66.496330, reg_best: 66.496330
step:  32, cost: 1.60E-02, attack: 0.990, loss: 1.208541, ce: 0.168790, reg: 64.984451, reg_best: 66.496330
step:  33, cost: 1.60E-02, attack: 0.997, loss: 1.132061, ce: 0.052905, reg: 67.447220, reg_best: 66.496330
step:  34, cost: 1.60E-02, attack: 0.990, loss: 1.170638, ce: 0.165237, reg: 62.837502, reg_best: 66.496330
step:  35, cost: 1.60E-02, attack: 0.997, loss: 1.137380, ce: 0.067184, reg: 66.887230, reg_best: 66.496330
step:  36, cost: 1.60E-02, attack: 0.996, loss: 1.146895, ce: 0.071186, reg: 67.231781, reg_best: 66.496330
step:  37, cost: 1.60E-02, attack: 0.995, loss: 1.102764, ce: 0.085026, reg: 63.608624, reg_best: 63.608624
step:  38, cost: 1.60E-02, attack: 0.984, loss: 1.250316, ce: 0.273582, reg: 61.045883, reg_best: 63.608624
step:  39, cost: 1.60E-02, attack: 0.990, loss: 1.129192, ce: 0.154801, reg: 60.899395, reg_best: 63.608624
step:  40, cost: 1.60E-02, attack: 0.996, loss: 1.073018, ce: 0.084037, reg: 61.811291, reg_best: 61.811291
step:  41, cost: 1.60E-02, attack: 0.997, loss: 1.048829, ce: 0.054813, reg: 62.126049, reg_best: 61.811291
step:  42, cost: 1.60E-02, attack: 0.995, loss: 1.066584, ce: 0.093630, reg: 60.809628, reg_best: 60.809628
step:  43, cost: 1.60E-02, attack: 0.992, loss: 1.074645, ce: 0.135289, reg: 58.709724, reg_best: 58.709724
step:  44, cost: 1.60E-02, attack: 0.993, loss: 1.102301, ce: 0.106517, reg: 62.200752, reg_best: 58.709724
up cost from 1.60E-02 to 3.20E-02
step:  45, cost: 3.20E-02, attack: 0.993, loss: 2.002832, ce: 0.119774, reg: 58.845592, reg_best: 58.709724
step:  46, cost: 3.20E-02, attack: 0.979, loss: 2.069727, ce: 0.356178, reg: 53.548393, reg_best: 58.709724
step:  47, cost: 3.20E-02, attack: 0.993, loss: 1.963329, ce: 0.122491, reg: 57.526203, reg_best: 57.526203
step:  48, cost: 3.20E-02, attack: 0.977, loss: 2.065393, ce: 0.366305, reg: 53.096512, reg_best: 57.526203
step:  49, cost: 3.20E-02, attack: 0.977, loss: 2.063883, ce: 0.384753, reg: 52.472836, reg_best: 57.526203
step:  50, cost: 3.20E-02, attack: 0.979, loss: 2.125604, ce: 0.348413, reg: 55.537220, reg_best: 57.526203
step:  51, cost: 3.20E-02, attack: 0.994, loss: 1.945685, ce: 0.095105, reg: 57.830608, reg_best: 57.526203
step:  52, cost: 3.20E-02, attack: 0.987, loss: 1.956472, ce: 0.200501, reg: 54.874088, reg_best: 57.526203
step:  53, cost: 3.20E-02, attack: 0.987, loss: 1.979975, ce: 0.228609, reg: 54.730167, reg_best: 57.526203
step:  54, cost: 3.20E-02, attack: 0.981, loss: 1.968798, ce: 0.312569, reg: 51.757156, reg_best: 57.526203
step:  55, cost: 3.20E-02, attack: 0.970, loss: 2.141912, ce: 0.502842, reg: 51.220924, reg_best: 57.526203
step:  56, cost: 3.20E-02, attack: 0.979, loss: 2.041706, ce: 0.343155, reg: 53.108898, reg_best: 57.526203
down cost from 3.20E-02 to 1.13E-02
step:  57, cost: 1.13E-02, attack: 0.988, loss: 0.814826, ce: 0.199026, reg: 54.429535, reg_best: 57.526203
step:  58, cost: 1.13E-02, attack: 0.994, loss: 0.755882, ce: 0.101465, reg: 57.842766, reg_best: 57.526203
step:  59, cost: 1.13E-02, attack: 0.996, loss: 0.709414, ce: 0.061759, reg: 57.245197, reg_best: 57.245197
step:  60, cost: 1.13E-02, attack: 0.993, loss: 0.763044, ce: 0.115008, reg: 57.278839, reg_best: 57.245197
step:  61, cost: 1.13E-02, attack: 0.992, loss: 0.768285, ce: 0.117135, reg: 57.554050, reg_best: 57.245197
step:  62, cost: 1.13E-02, attack: 0.994, loss: 0.740682, ce: 0.094609, reg: 57.105267, reg_best: 57.105267
up cost from 1.13E-02 to 2.26E-02
step:  63, cost: 2.26E-02, attack: 0.981, loss: 1.516397, ce: 0.302321, reg: 53.655106, reg_best: 57.105267
step:  64, cost: 2.26E-02, attack: 0.988, loss: 1.440242, ce: 0.209414, reg: 54.395451, reg_best: 57.105267
step:  65, cost: 2.26E-02, attack: 0.985, loss: 1.467065, ce: 0.247960, reg: 53.877338, reg_best: 57.105267
step:  66, cost: 2.26E-02, attack: 0.985, loss: 1.507048, ce: 0.252672, reg: 55.436111, reg_best: 57.105267
step:  67, cost: 2.26E-02, attack: 0.985, loss: 1.476178, ce: 0.237344, reg: 54.749214, reg_best: 57.105267
down cost from 2.26E-02 to 8.00E-03
step:  68, cost: 8.00E-03, attack: 0.994, loss: 0.541723, ce: 0.077335, reg: 58.048531, reg_best: 57.105267
step:  69, cost: 8.00E-03, attack: 0.997, loss: 0.533562, ce: 0.056313, reg: 59.651031, reg_best: 57.105267
step:  70, cost: 8.00E-03, attack: 0.992, loss: 0.591998, ce: 0.117231, reg: 59.345943, reg_best: 57.105267
step:  71, cost: 8.00E-03, attack: 0.997, loss: 0.535963, ce: 0.054804, reg: 60.144855, reg_best: 57.105267
step:  72, cost: 8.00E-03, attack: 0.992, loss: 0.579284, ce: 0.116997, reg: 57.785843, reg_best: 57.105267
up cost from 8.00E-03 to 1.60E-02
step:  73, cost: 1.60E-02, attack: 0.995, loss: 1.004979, ce: 0.083741, reg: 57.577316, reg_best: 57.105267
step:  74, cost: 1.60E-02, attack: 0.991, loss: 1.039846, ce: 0.145415, reg: 55.901939, reg_best: 55.901939
step:  75, cost: 1.60E-02, attack: 0.987, loss: 1.104012, ce: 0.214035, reg: 55.623547, reg_best: 55.901939
step:  76, cost: 1.60E-02, attack: 0.985, loss: 1.117300, ce: 0.264931, reg: 53.273067, reg_best: 55.901939
step:  77, cost: 1.60E-02, attack: 0.993, loss: 1.038276, ce: 0.123148, reg: 57.195522, reg_best: 55.901939
step:  78, cost: 1.60E-02, attack: 0.994, loss: 1.005547, ce: 0.106717, reg: 56.176861, reg_best: 55.901939
step:  79, cost: 1.60E-02, attack: 0.995, loss: 0.980716, ce: 0.090143, reg: 55.660831, reg_best: 55.660831
step:  80, cost: 1.60E-02, attack: 0.987, loss: 1.089035, ce: 0.210786, reg: 54.890533, reg_best: 55.660831
step:  81, cost: 1.60E-02, attack: 0.991, loss: 1.045131, ce: 0.153319, reg: 55.738258, reg_best: 55.660831
step:  82, cost: 1.60E-02, attack: 0.994, loss: 1.040670, ce: 0.099074, reg: 58.844902, reg_best: 55.660831
step:  83, cost: 1.60E-02, attack: 0.995, loss: 0.995656, ce: 0.082675, reg: 57.061356, reg_best: 55.660831
step:  84, cost: 1.60E-02, attack: 0.994, loss: 0.992312, ce: 0.104807, reg: 55.469028, reg_best: 55.469028
step:  85, cost: 1.60E-02, attack: 0.991, loss: 0.993986, ce: 0.146905, reg: 52.942574, reg_best: 52.942574
up cost from 1.60E-02 to 3.20E-02
step:  86, cost: 3.20E-02, attack: 0.988, loss: 1.939831, ce: 0.209232, reg: 54.081215, reg_best: 52.942574
step:  87, cost: 3.20E-02, attack: 0.981, loss: 1.966051, ce: 0.298988, reg: 52.095711, reg_best: 52.942574
step:  88, cost: 3.20E-02, attack: 0.978, loss: 2.092417, ce: 0.359491, reg: 54.153942, reg_best: 52.942574
step:  89, cost: 3.20E-02, attack: 0.985, loss: 2.008151, ce: 0.251658, reg: 54.890408, reg_best: 52.942574
step:  90, cost: 3.20E-02, attack: 0.985, loss: 1.943734, ce: 0.250071, reg: 52.926975, reg_best: 52.942574
down cost from 3.20E-02 to 1.13E-02
step:  91, cost: 1.13E-02, attack: 0.992, loss: 0.758888, ce: 0.145218, reg: 54.241257, reg_best: 52.942574
step:  92, cost: 1.13E-02, attack: 0.998, loss: 0.703924, ce: 0.044466, reg: 58.288368, reg_best: 52.942574
step:  93, cost: 1.13E-02, attack: 0.995, loss: 0.739210, ce: 0.079470, reg: 58.313271, reg_best: 52.942574
step:  94, cost: 1.13E-02, attack: 0.992, loss: 0.766644, ce: 0.129929, reg: 56.272572, reg_best: 52.942574
step:  95, cost: 1.13E-02, attack: 0.996, loss: 0.752756, ce: 0.089950, reg: 58.584366, reg_best: 52.942574
up cost from 1.13E-02 to 2.26E-02
step:  96, cost: 2.26E-02, attack: 0.993, loss: 1.389353, ce: 0.114292, reg: 56.350254, reg_best: 52.942574
step:  97, cost: 2.26E-02, attack: 0.989, loss: 1.396642, ce: 0.169889, reg: 54.215313, reg_best: 52.942574
step:  98, cost: 2.26E-02, attack: 0.992, loss: 1.439677, ce: 0.118123, reg: 58.404999, reg_best: 52.942574
step:  99, cost: 2.26E-02, attack: 0.992, loss: 1.382948, ce: 0.145809, reg: 54.674324, reg_best: 52.942574
pattern, shape: (32, 32, 3), min: 0.000008, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 2: 53.246582
visualization cost 20.217417 seconds
processing label 3
resetting state
mask_tanh -3.064455585706759 4.046927375223886
pattern_tanh -4.891510248040816 4.115368316274503
step:   0, cost: 0.00E+00, attack: 0.901, loss: 1.617101, ce: 1.617101, reg: 541.164673, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000250, ce: 0.000250, reg: 550.943970, reg_best: 550.943970
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000009, ce: 0.000009, reg: 552.785950, reg_best: 550.943970
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 553.168274, reg_best: 550.943970
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 553.502136, reg_best: 550.943970
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 556.780640, reg_best: 550.943970
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 1.000, loss: 0.365293, ce: 0.007053, reg: 358.239624, reg_best: 358.239624
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.261989, ce: 0.031990, reg: 229.684082, reg_best: 229.684082
step:   8, cost: 1.00E-03, attack: 0.998, loss: 0.184451, ce: 0.028670, reg: 155.781677, reg_best: 155.781677
step:   9, cost: 1.00E-03, attack: 0.997, loss: 0.178705, ce: 0.045785, reg: 132.920334, reg_best: 132.920334
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.995, loss: 0.312029, ce: 0.087653, reg: 112.187988, reg_best: 112.187988
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.227437, ce: 0.031210, reg: 98.113235, reg_best: 98.113235
step:  12, cost: 2.00E-03, attack: 0.997, loss: 0.228066, ce: 0.041241, reg: 93.412750, reg_best: 93.412750
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.200845, ce: 0.018402, reg: 91.221565, reg_best: 91.221565
step:  14, cost: 2.00E-03, attack: 1.000, loss: 0.176459, ce: 0.001328, reg: 87.565224, reg_best: 87.565224
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.997, loss: 0.333152, ce: 0.042665, reg: 72.621918, reg_best: 72.621918
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.322482, ce: 0.029609, reg: 73.218262, reg_best: 72.621918
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.303211, ce: 0.023105, reg: 70.026421, reg_best: 70.026421
step:  18, cost: 4.00E-03, attack: 0.994, loss: 0.361616, ce: 0.099633, reg: 65.495789, reg_best: 65.495789
step:  19, cost: 4.00E-03, attack: 0.997, loss: 0.295650, ce: 0.043166, reg: 63.121159, reg_best: 63.121159
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.992, loss: 0.588414, ce: 0.126019, reg: 57.780762, reg_best: 57.780762
step:  21, cost: 8.00E-03, attack: 0.997, loss: 0.557828, ce: 0.061471, reg: 62.044666, reg_best: 57.780762
step:  22, cost: 8.00E-03, attack: 0.995, loss: 0.548967, ce: 0.078522, reg: 58.805569, reg_best: 57.780762
step:  23, cost: 8.00E-03, attack: 0.998, loss: 0.507116, ce: 0.040700, reg: 58.301994, reg_best: 57.780762
step:  24, cost: 8.00E-03, attack: 0.996, loss: 0.526094, ce: 0.067562, reg: 57.316509, reg_best: 57.316509
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.997, loss: 0.925981, ce: 0.046858, reg: 54.945221, reg_best: 54.945221
step:  26, cost: 1.60E-02, attack: 0.987, loss: 1.031037, ce: 0.211753, reg: 51.205223, reg_best: 54.945221
step:  27, cost: 1.60E-02, attack: 0.995, loss: 0.956357, ce: 0.079145, reg: 54.825695, reg_best: 54.825695
step:  28, cost: 1.60E-02, attack: 0.993, loss: 0.945534, ce: 0.108106, reg: 52.339264, reg_best: 52.339264
step:  29, cost: 1.60E-02, attack: 0.992, loss: 0.927429, ce: 0.122880, reg: 50.284302, reg_best: 50.284302
step:  30, cost: 1.60E-02, attack: 0.996, loss: 0.889250, ce: 0.073016, reg: 51.014645, reg_best: 50.284302
step:  31, cost: 1.60E-02, attack: 0.994, loss: 0.903742, ce: 0.108791, reg: 49.684414, reg_best: 49.684414
up cost from 1.60E-02 to 3.20E-02
step:  32, cost: 3.20E-02, attack: 0.987, loss: 1.773463, ce: 0.205774, reg: 48.990273, reg_best: 49.684414
step:  33, cost: 3.20E-02, attack: 0.980, loss: 1.839914, ce: 0.337260, reg: 46.925396, reg_best: 49.684414
step:  34, cost: 3.20E-02, attack: 0.971, loss: 1.881736, ce: 0.473975, reg: 43.992523, reg_best: 49.684414
step:  35, cost: 3.20E-02, attack: 0.983, loss: 1.794472, ce: 0.282237, reg: 47.257332, reg_best: 49.684414
step:  36, cost: 3.20E-02, attack: 0.982, loss: 1.743783, ce: 0.283146, reg: 45.644905, reg_best: 49.684414
down cost from 3.20E-02 to 1.13E-02
step:  37, cost: 1.13E-02, attack: 0.984, loss: 0.783907, ce: 0.257305, reg: 46.545544, reg_best: 49.684414
step:  38, cost: 1.13E-02, attack: 0.992, loss: 0.683343, ce: 0.130661, reg: 48.850651, reg_best: 48.850651
step:  39, cost: 1.13E-02, attack: 0.990, loss: 0.726354, ce: 0.148029, reg: 51.117222, reg_best: 48.850651
step:  40, cost: 1.13E-02, attack: 0.998, loss: 0.596108, ce: 0.029759, reg: 50.058613, reg_best: 48.850651
step:  41, cost: 1.13E-02, attack: 0.989, loss: 0.739690, ce: 0.161921, reg: 51.068089, reg_best: 48.850651
step:  42, cost: 1.13E-02, attack: 0.998, loss: 0.629292, ce: 0.037934, reg: 52.269119, reg_best: 48.850651
step:  43, cost: 1.13E-02, attack: 0.994, loss: 0.666331, ce: 0.103974, reg: 49.705795, reg_best: 48.850651
step:  44, cost: 1.13E-02, attack: 0.993, loss: 0.668314, ce: 0.119312, reg: 48.525429, reg_best: 48.525429
step:  45, cost: 1.13E-02, attack: 0.993, loss: 0.654953, ce: 0.117089, reg: 47.559486, reg_best: 47.559486
step:  46, cost: 1.13E-02, attack: 0.997, loss: 0.621653, ce: 0.057283, reg: 49.883743, reg_best: 47.559486
up cost from 1.13E-02 to 2.26E-02
step:  47, cost: 2.26E-02, attack: 0.994, loss: 1.193005, ce: 0.101739, reg: 48.227604, reg_best: 47.559486
step:  48, cost: 2.26E-02, attack: 0.993, loss: 1.233711, ce: 0.133482, reg: 48.623703, reg_best: 47.559486
step:  49, cost: 2.26E-02, attack: 0.990, loss: 1.238236, ce: 0.164573, reg: 47.449623, reg_best: 47.559486
step:  50, cost: 2.26E-02, attack: 0.991, loss: 1.250840, ce: 0.159558, reg: 48.228287, reg_best: 47.559486
step:  51, cost: 2.26E-02, attack: 0.985, loss: 1.272080, ce: 0.233876, reg: 45.882572, reg_best: 47.559486
step:  52, cost: 2.26E-02, attack: 0.992, loss: 1.209593, ce: 0.133864, reg: 47.540936, reg_best: 47.540936
step:  53, cost: 2.26E-02, attack: 0.986, loss: 1.333978, ce: 0.228614, reg: 48.850639, reg_best: 47.540936
step:  54, cost: 2.26E-02, attack: 0.996, loss: 1.236287, ce: 0.091931, reg: 50.573895, reg_best: 47.540936
step:  55, cost: 2.26E-02, attack: 0.996, loss: 1.220796, ce: 0.070329, reg: 50.843967, reg_best: 47.540936
step:  56, cost: 2.26E-02, attack: 0.983, loss: 1.352904, ce: 0.292892, reg: 46.846333, reg_best: 47.540936
step:  57, cost: 2.26E-02, attack: 0.991, loss: 1.268271, ce: 0.165246, reg: 48.747272, reg_best: 47.540936
step:  58, cost: 2.26E-02, attack: 0.991, loss: 1.256351, ce: 0.163335, reg: 48.300735, reg_best: 47.540936
step:  59, cost: 2.26E-02, attack: 0.994, loss: 1.251135, ce: 0.086885, reg: 51.453083, reg_best: 47.540936
step:  60, cost: 2.26E-02, attack: 0.994, loss: 1.209816, ce: 0.092844, reg: 49.363693, reg_best: 47.540936
step:  61, cost: 2.26E-02, attack: 0.993, loss: 1.190210, ce: 0.107050, reg: 47.869350, reg_best: 47.540936
up cost from 2.26E-02 to 4.53E-02
step:  62, cost: 4.53E-02, attack: 0.987, loss: 2.305705, ce: 0.213227, reg: 46.237675, reg_best: 47.540936
step:  63, cost: 4.53E-02, attack: 0.982, loss: 2.325768, ce: 0.283991, reg: 45.117313, reg_best: 47.540936
step:  64, cost: 4.53E-02, attack: 0.990, loss: 2.251137, ce: 0.177979, reg: 45.810760, reg_best: 47.540936
step:  65, cost: 4.53E-02, attack: 0.985, loss: 2.377898, ce: 0.273520, reg: 46.500622, reg_best: 47.540936
step:  66, cost: 4.53E-02, attack: 0.990, loss: 2.272456, ce: 0.177232, reg: 46.298336, reg_best: 47.540936
down cost from 4.53E-02 to 1.60E-02
step:  67, cost: 1.60E-02, attack: 0.987, loss: 0.989181, ce: 0.226102, reg: 47.692471, reg_best: 47.540936
step:  68, cost: 1.60E-02, attack: 0.990, loss: 0.964977, ce: 0.147766, reg: 51.075657, reg_best: 47.540936
step:  69, cost: 1.60E-02, attack: 0.994, loss: 0.902117, ce: 0.116114, reg: 49.125206, reg_best: 47.540936
step:  70, cost: 1.60E-02, attack: 0.994, loss: 0.920094, ce: 0.102759, reg: 51.083450, reg_best: 47.540936
step:  71, cost: 1.60E-02, attack: 0.996, loss: 0.857493, ce: 0.063634, reg: 49.609081, reg_best: 47.540936
step:  72, cost: 1.60E-02, attack: 0.995, loss: 0.868508, ce: 0.097873, reg: 48.164726, reg_best: 47.540936
step:  73, cost: 1.60E-02, attack: 0.991, loss: 0.902075, ce: 0.162508, reg: 46.222935, reg_best: 46.222935
up cost from 1.60E-02 to 3.20E-02
step:  74, cost: 3.20E-02, attack: 0.990, loss: 1.662535, ce: 0.179729, reg: 46.337669, reg_best: 46.222935
step:  75, cost: 3.20E-02, attack: 0.981, loss: 1.835461, ce: 0.323655, reg: 47.243935, reg_best: 46.222935
step:  76, cost: 3.20E-02, attack: 0.991, loss: 1.644747, ce: 0.156105, reg: 46.520050, reg_best: 46.222935
step:  77, cost: 3.20E-02, attack: 0.981, loss: 1.739437, ce: 0.332208, reg: 43.975914, reg_best: 46.222935
step:  78, cost: 3.20E-02, attack: 0.980, loss: 1.815870, ce: 0.325182, reg: 46.584007, reg_best: 46.222935
step:  79, cost: 3.20E-02, attack: 0.986, loss: 1.673224, ce: 0.231134, reg: 45.065311, reg_best: 46.222935
step:  80, cost: 3.20E-02, attack: 0.969, loss: 1.880247, ce: 0.504658, reg: 42.987167, reg_best: 46.222935
step:  81, cost: 3.20E-02, attack: 0.992, loss: 1.688717, ce: 0.159681, reg: 47.782356, reg_best: 46.222935
step:  82, cost: 3.20E-02, attack: 0.980, loss: 1.787486, ce: 0.331528, reg: 45.498707, reg_best: 46.222935
step:  83, cost: 3.20E-02, attack: 0.989, loss: 1.670294, ce: 0.178087, reg: 46.631489, reg_best: 46.222935
step:  84, cost: 3.20E-02, attack: 0.979, loss: 1.746926, ce: 0.343036, reg: 43.882561, reg_best: 46.222935
step:  85, cost: 3.20E-02, attack: 0.985, loss: 1.738629, ce: 0.252077, reg: 46.454762, reg_best: 46.222935
step:  86, cost: 3.20E-02, attack: 0.991, loss: 1.715657, ce: 0.135922, reg: 49.366737, reg_best: 46.222935
step:  87, cost: 3.20E-02, attack: 0.998, loss: 1.610645, ce: 0.042784, reg: 48.995632, reg_best: 46.222935
step:  88, cost: 3.20E-02, attack: 0.981, loss: 1.786006, ce: 0.309586, reg: 46.138134, reg_best: 46.222935
step:  89, cost: 3.20E-02, attack: 0.986, loss: 1.664606, ce: 0.238401, reg: 44.568913, reg_best: 46.222935
step:  90, cost: 3.20E-02, attack: 0.989, loss: 1.654097, ce: 0.196812, reg: 45.540150, reg_best: 46.222935
step:  91, cost: 3.20E-02, attack: 0.986, loss: 1.649841, ce: 0.225506, reg: 44.510456, reg_best: 46.222935
step:  92, cost: 3.20E-02, attack: 0.987, loss: 1.717981, ce: 0.233400, reg: 46.393154, reg_best: 46.222935
down cost from 3.20E-02 to 1.13E-02
step:  93, cost: 1.13E-02, attack: 0.987, loss: 0.735580, ce: 0.215299, reg: 45.986759, reg_best: 46.222935
step:  94, cost: 1.13E-02, attack: 0.986, loss: 0.750278, ce: 0.216123, reg: 47.213043, reg_best: 46.222935
step:  95, cost: 1.13E-02, attack: 0.995, loss: 0.658929, ce: 0.095533, reg: 49.797623, reg_best: 46.222935
step:  96, cost: 1.13E-02, attack: 0.994, loss: 0.670779, ce: 0.104335, reg: 50.062069, reg_best: 46.222935
step:  97, cost: 1.13E-02, attack: 0.991, loss: 0.685648, ce: 0.155579, reg: 46.851925, reg_best: 46.222935
step:  98, cost: 1.13E-02, attack: 0.991, loss: 0.669724, ce: 0.150479, reg: 45.895195, reg_best: 45.895195
step:  99, cost: 1.13E-02, attack: 0.994, loss: 0.666203, ce: 0.106364, reg: 49.483276, reg_best: 45.895195
up cost from 1.13E-02 to 2.26E-02
pattern, shape: (32, 32, 3), min: 0.000000, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 3: 45.156578
visualization cost 20.221793 seconds
processing label 4
resetting state
mask_tanh -3.330917890278451 3.28633330308388
pattern_tanh -3.8120697538437445 6.389546071450725
step:   0, cost: 0.00E+00, attack: 0.880, loss: 2.026919, ce: 2.026919, reg: 554.824646, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000033, ce: 0.000033, reg: 572.291199, reg_best: 572.291199
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000114, ce: 0.000114, reg: 573.077026, reg_best: 572.291199
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 576.099182, reg_best: 572.291199
step:   4, cost: 0.00E+00, attack: 0.999, loss: 0.016189, ce: 0.016189, reg: 579.717896, reg_best: 572.291199
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000057, ce: 0.000057, reg: 587.476196, reg_best: 572.291199
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.465047, ce: 0.048730, reg: 416.316406, reg_best: 416.316406
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.358994, ce: 0.024452, reg: 334.542450, reg_best: 334.542450
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.262498, ce: 0.000622, reg: 261.876038, reg_best: 261.876038
step:   9, cost: 1.00E-03, attack: 0.997, loss: 0.252507, ce: 0.049184, reg: 203.336533, reg_best: 203.336533
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.993, loss: 0.428673, ce: 0.116387, reg: 156.142990, reg_best: 156.142990
step:  11, cost: 2.00E-03, attack: 0.997, loss: 0.305130, ce: 0.039022, reg: 133.054138, reg_best: 133.054138
step:  12, cost: 2.00E-03, attack: 0.993, loss: 0.360518, ce: 0.110158, reg: 125.180153, reg_best: 125.180153
step:  13, cost: 2.00E-03, attack: 0.997, loss: 0.282065, ce: 0.057049, reg: 112.508080, reg_best: 112.508080
step:  14, cost: 2.00E-03, attack: 0.996, loss: 0.275704, ce: 0.066856, reg: 104.424026, reg_best: 104.424026
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.996, loss: 0.449373, ce: 0.076788, reg: 93.146172, reg_best: 93.146172
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.400656, ce: 0.032234, reg: 92.105515, reg_best: 92.105515
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.393423, ce: 0.044788, reg: 87.158623, reg_best: 87.158623
step:  18, cost: 4.00E-03, attack: 0.996, loss: 0.394436, ce: 0.063923, reg: 82.628136, reg_best: 82.628136
step:  19, cost: 4.00E-03, attack: 0.995, loss: 0.387558, ce: 0.079348, reg: 77.052574, reg_best: 77.052574
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.993, loss: 0.686350, ce: 0.102643, reg: 72.963295, reg_best: 72.963295
step:  21, cost: 8.00E-03, attack: 0.994, loss: 0.658289, ce: 0.097332, reg: 70.119667, reg_best: 70.119667
step:  22, cost: 8.00E-03, attack: 0.990, loss: 0.745014, ce: 0.172624, reg: 71.547066, reg_best: 70.119667
step:  23, cost: 8.00E-03, attack: 0.997, loss: 0.624738, ce: 0.056602, reg: 71.016960, reg_best: 70.119667
step:  24, cost: 8.00E-03, attack: 0.995, loss: 0.612520, ce: 0.091163, reg: 65.169617, reg_best: 65.169617
step:  25, cost: 8.00E-03, attack: 0.995, loss: 0.594053, ce: 0.088193, reg: 63.232517, reg_best: 63.232517
step:  26, cost: 8.00E-03, attack: 0.997, loss: 0.588359, ce: 0.056930, reg: 66.428642, reg_best: 63.232517
step:  27, cost: 8.00E-03, attack: 0.993, loss: 0.619464, ce: 0.112918, reg: 63.318287, reg_best: 63.232517
up cost from 8.00E-03 to 1.60E-02
step:  28, cost: 1.60E-02, attack: 0.990, loss: 1.127721, ce: 0.183594, reg: 59.007965, reg_best: 63.232517
step:  29, cost: 1.60E-02, attack: 0.987, loss: 1.152049, ce: 0.201798, reg: 59.390640, reg_best: 63.232517
step:  30, cost: 1.60E-02, attack: 0.992, loss: 1.046902, ce: 0.140911, reg: 56.624447, reg_best: 56.624447
step:  31, cost: 1.60E-02, attack: 0.993, loss: 1.058221, ce: 0.119174, reg: 58.690399, reg_best: 56.624447
step:  32, cost: 1.60E-02, attack: 0.993, loss: 1.017976, ce: 0.127114, reg: 55.678905, reg_best: 55.678905
step:  33, cost: 1.60E-02, attack: 0.989, loss: 1.073129, ce: 0.173640, reg: 56.218048, reg_best: 55.678905
step:  34, cost: 1.60E-02, attack: 0.980, loss: 1.170235, ce: 0.320811, reg: 53.089005, reg_best: 55.678905
step:  35, cost: 1.60E-02, attack: 0.989, loss: 1.060750, ce: 0.193836, reg: 54.154320, reg_best: 55.678905
step:  36, cost: 1.60E-02, attack: 0.990, loss: 1.013379, ce: 0.163228, reg: 53.134396, reg_best: 55.678905
step:  37, cost: 1.60E-02, attack: 0.981, loss: 1.157453, ce: 0.303299, reg: 53.384586, reg_best: 55.678905
down cost from 1.60E-02 to 5.66E-03
step:  38, cost: 5.66E-03, attack: 0.994, loss: 0.417746, ce: 0.100181, reg: 56.138069, reg_best: 55.678905
step:  39, cost: 5.66E-03, attack: 0.995, loss: 0.429489, ce: 0.082374, reg: 61.361935, reg_best: 55.678905
step:  40, cost: 5.66E-03, attack: 0.999, loss: 0.383088, ce: 0.029833, reg: 62.447208, reg_best: 55.678905
step:  41, cost: 5.66E-03, attack: 0.994, loss: 0.412358, ce: 0.098657, reg: 55.454971, reg_best: 55.454971
step:  42, cost: 5.66E-03, attack: 0.996, loss: 0.401319, ce: 0.069846, reg: 58.596664, reg_best: 55.454971
up cost from 5.66E-03 to 1.13E-02
step:  43, cost: 1.13E-02, attack: 0.991, loss: 0.797515, ce: 0.149401, reg: 57.285721, reg_best: 55.454971
step:  44, cost: 1.13E-02, attack: 0.993, loss: 0.779956, ce: 0.107765, reg: 59.413803, reg_best: 55.454971
step:  45, cost: 1.13E-02, attack: 0.996, loss: 0.705831, ce: 0.059491, reg: 57.128891, reg_best: 55.454971
step:  46, cost: 1.13E-02, attack: 0.997, loss: 0.717747, ce: 0.060377, reg: 58.103874, reg_best: 55.454971
step:  47, cost: 1.13E-02, attack: 0.996, loss: 0.728018, ce: 0.079186, reg: 57.329594, reg_best: 55.454971
up cost from 1.13E-02 to 2.26E-02
step:  48, cost: 2.26E-02, attack: 0.988, loss: 1.432794, ce: 0.210837, reg: 54.003399, reg_best: 55.454971
step:  49, cost: 2.26E-02, attack: 0.991, loss: 1.333083, ce: 0.160071, reg: 51.840267, reg_best: 51.840267
step:  50, cost: 2.26E-02, attack: 0.992, loss: 1.336223, ce: 0.130708, reg: 53.276726, reg_best: 51.840267
step:  51, cost: 2.26E-02, attack: 0.987, loss: 1.364776, ce: 0.202451, reg: 51.367989, reg_best: 51.840267
step:  52, cost: 2.26E-02, attack: 0.993, loss: 1.333914, ce: 0.114477, reg: 53.892002, reg_best: 51.840267
step:  53, cost: 2.26E-02, attack: 0.986, loss: 1.416812, ce: 0.220141, reg: 52.885902, reg_best: 51.840267
step:  54, cost: 2.26E-02, attack: 0.984, loss: 1.406371, ce: 0.256004, reg: 50.839504, reg_best: 51.840267
step:  55, cost: 2.26E-02, attack: 0.986, loss: 1.360366, ce: 0.236535, reg: 49.666771, reg_best: 51.840267
step:  56, cost: 2.26E-02, attack: 0.980, loss: 1.468279, ce: 0.329558, reg: 50.324833, reg_best: 51.840267
step:  57, cost: 2.26E-02, attack: 0.994, loss: 1.305941, ce: 0.092228, reg: 53.639069, reg_best: 51.840267
step:  58, cost: 2.26E-02, attack: 0.981, loss: 1.431506, ce: 0.306315, reg: 49.726860, reg_best: 51.840267
step:  59, cost: 2.26E-02, attack: 0.991, loss: 1.372035, ce: 0.145944, reg: 54.186073, reg_best: 51.840267
step:  60, cost: 2.26E-02, attack: 0.997, loss: 1.345774, ce: 0.057515, reg: 56.934444, reg_best: 51.840267
step:  61, cost: 2.26E-02, attack: 0.993, loss: 1.379129, ce: 0.115908, reg: 55.827038, reg_best: 51.840267
step:  62, cost: 2.26E-02, attack: 0.993, loss: 1.332152, ce: 0.119330, reg: 53.599682, reg_best: 51.840267
step:  63, cost: 2.26E-02, attack: 0.986, loss: 1.412123, ce: 0.220225, reg: 52.674953, reg_best: 51.840267
step:  64, cost: 2.26E-02, attack: 0.981, loss: 1.439975, ce: 0.316165, reg: 49.665829, reg_best: 51.840267
step:  65, cost: 2.26E-02, attack: 0.990, loss: 1.325349, ce: 0.172698, reg: 50.940498, reg_best: 51.840267
step:  66, cost: 2.26E-02, attack: 0.991, loss: 1.347498, ce: 0.147073, reg: 53.051785, reg_best: 51.840267
step:  67, cost: 2.26E-02, attack: 0.990, loss: 1.350847, ce: 0.165237, reg: 52.397022, reg_best: 51.840267
step:  68, cost: 2.26E-02, attack: 0.993, loss: 1.325131, ce: 0.132454, reg: 52.709385, reg_best: 51.840267
step:  69, cost: 2.26E-02, attack: 0.987, loss: 1.415960, ce: 0.215649, reg: 53.046745, reg_best: 51.840267
step:  70, cost: 2.26E-02, attack: 0.986, loss: 1.369842, ce: 0.204354, reg: 51.507763, reg_best: 51.840267
step:  71, cost: 2.26E-02, attack: 0.993, loss: 1.291609, ce: 0.123344, reg: 51.630508, reg_best: 51.630508
step:  72, cost: 2.26E-02, attack: 0.991, loss: 1.354807, ce: 0.153860, reg: 53.074879, reg_best: 51.630508
step:  73, cost: 2.26E-02, attack: 0.990, loss: 1.319157, ce: 0.162790, reg: 51.108383, reg_best: 51.630508
step:  74, cost: 2.26E-02, attack: 0.993, loss: 1.327351, ce: 0.126466, reg: 53.072136, reg_best: 51.630508
step:  75, cost: 2.26E-02, attack: 0.988, loss: 1.376981, ce: 0.210390, reg: 51.556507, reg_best: 51.630508
step:  76, cost: 2.26E-02, attack: 0.988, loss: 1.390806, ce: 0.177640, reg: 53.614857, reg_best: 51.630508
step:  77, cost: 2.26E-02, attack: 0.994, loss: 1.298209, ce: 0.105339, reg: 52.717869, reg_best: 51.630508
step:  78, cost: 2.26E-02, attack: 0.988, loss: 1.398975, ce: 0.197256, reg: 53.108982, reg_best: 51.630508
step:  79, cost: 2.26E-02, attack: 0.995, loss: 1.317009, ce: 0.100769, reg: 53.750755, reg_best: 51.630508
step:  80, cost: 2.26E-02, attack: 0.990, loss: 1.343176, ce: 0.175949, reg: 51.584644, reg_best: 51.630508
step:  81, cost: 2.26E-02, attack: 0.993, loss: 1.343441, ce: 0.128111, reg: 53.710526, reg_best: 51.630508
step:  82, cost: 2.26E-02, attack: 0.992, loss: 1.310085, ce: 0.153481, reg: 51.115135, reg_best: 51.115135
step:  83, cost: 2.26E-02, attack: 0.991, loss: 1.340968, ce: 0.141655, reg: 53.002613, reg_best: 51.115135
step:  84, cost: 2.26E-02, attack: 0.990, loss: 1.312466, ce: 0.162384, reg: 50.826897, reg_best: 51.115135
step:  85, cost: 2.26E-02, attack: 0.983, loss: 1.393914, ce: 0.271019, reg: 49.625439, reg_best: 51.115135
step:  86, cost: 2.26E-02, attack: 0.991, loss: 1.354299, ce: 0.136487, reg: 53.821873, reg_best: 51.115135
step:  87, cost: 2.26E-02, attack: 0.984, loss: 1.411429, ce: 0.274875, reg: 50.229073, reg_best: 51.115135
step:  88, cost: 2.26E-02, attack: 0.986, loss: 1.408791, ce: 0.231812, reg: 52.015598, reg_best: 51.115135
step:  89, cost: 2.26E-02, attack: 0.988, loss: 1.377104, ce: 0.201070, reg: 51.973831, reg_best: 51.115135
step:  90, cost: 2.26E-02, attack: 0.981, loss: 1.427439, ce: 0.286964, reg: 50.402332, reg_best: 51.115135
step:  91, cost: 2.26E-02, attack: 0.989, loss: 1.374808, ce: 0.163402, reg: 53.537079, reg_best: 51.115135
down cost from 2.26E-02 to 8.00E-03
step:  92, cost: 8.00E-03, attack: 0.993, loss: 0.568865, ce: 0.130640, reg: 54.778240, reg_best: 51.115135
step:  93, cost: 8.00E-03, attack: 0.999, loss: 0.456771, ce: 0.016397, reg: 55.046795, reg_best: 51.115135
step:  94, cost: 8.00E-03, attack: 0.999, loss: 0.467323, ce: 0.030314, reg: 54.626106, reg_best: 51.115135
step:  95, cost: 8.00E-03, attack: 0.998, loss: 0.483575, ce: 0.036328, reg: 55.905834, reg_best: 51.115135
step:  96, cost: 8.00E-03, attack: 0.997, loss: 0.505691, ce: 0.055790, reg: 56.237576, reg_best: 51.115135
up cost from 8.00E-03 to 1.60E-02
step:  97, cost: 1.60E-02, attack: 0.996, loss: 0.942148, ce: 0.077410, reg: 54.046062, reg_best: 51.115135
step:  98, cost: 1.60E-02, attack: 0.993, loss: 0.974670, ce: 0.119723, reg: 53.419796, reg_best: 51.115135
step:  99, cost: 1.60E-02, attack: 0.994, loss: 0.948405, ce: 0.098279, reg: 53.132847, reg_best: 51.115135
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 4: 52.193169
visualization cost 26.831110 seconds
processing label 5
resetting state
mask_tanh -3.1897277893292895 2.961709102216112
pattern_tanh -4.60066018478943 3.7986067388861704
step:   0, cost: 0.00E+00, attack: 0.920, loss: 1.361689, ce: 1.361689, reg: 555.101196, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000182, ce: 0.000182, reg: 569.696716, reg_best: 569.696716
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000079, ce: 0.000079, reg: 572.718811, reg_best: 569.696716
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 573.440918, reg_best: 569.696716
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000005, ce: 0.000005, reg: 573.990662, reg_best: 569.696716
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 579.653076, reg_best: 569.696716
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.483556, ce: 0.056571, reg: 426.984222, reg_best: 426.984222
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.339342, ce: 0.003087, reg: 336.254974, reg_best: 336.254974
step:   8, cost: 1.00E-03, attack: 0.997, loss: 0.274124, ce: 0.050272, reg: 223.851486, reg_best: 223.851486
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.217051, ce: 0.038131, reg: 178.920792, reg_best: 178.920792
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.336492, ce: 0.017353, reg: 159.569229, reg_best: 159.569229
step:  11, cost: 2.00E-03, attack: 1.000, loss: 0.289768, ce: 0.001115, reg: 144.302612, reg_best: 144.302612
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.282965, ce: 0.028576, reg: 127.194397, reg_best: 127.194397
step:  13, cost: 2.00E-03, attack: 0.998, loss: 0.275224, ce: 0.025376, reg: 124.924034, reg_best: 124.924034
step:  14, cost: 2.00E-03, attack: 1.000, loss: 0.246258, ce: 0.007730, reg: 119.263763, reg_best: 119.263763
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.994, loss: 0.528932, ce: 0.101364, reg: 106.891869, reg_best: 106.891869
step:  16, cost: 4.00E-03, attack: 0.996, loss: 0.467086, ce: 0.071225, reg: 98.965317, reg_best: 98.965317
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.451911, ce: 0.052349, reg: 99.890594, reg_best: 98.965317
step:  18, cost: 4.00E-03, attack: 0.998, loss: 0.430517, ce: 0.041349, reg: 97.291779, reg_best: 97.291779
step:  19, cost: 4.00E-03, attack: 0.995, loss: 0.476750, ce: 0.088621, reg: 97.032372, reg_best: 97.032372
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.993, loss: 0.807775, ce: 0.109679, reg: 87.261963, reg_best: 87.261963
step:  21, cost: 8.00E-03, attack: 0.998, loss: 0.733193, ce: 0.039209, reg: 86.747993, reg_best: 86.747993
step:  22, cost: 8.00E-03, attack: 0.992, loss: 0.783090, ce: 0.130328, reg: 81.595276, reg_best: 81.595276
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.752033, ce: 0.098264, reg: 81.721153, reg_best: 81.595276
step:  24, cost: 8.00E-03, attack: 0.997, loss: 0.677531, ce: 0.059236, reg: 77.281662, reg_best: 77.281662
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.992, loss: 1.301408, ce: 0.123674, reg: 73.608391, reg_best: 73.608391
step:  26, cost: 1.60E-02, attack: 0.992, loss: 1.275746, ce: 0.141435, reg: 70.894394, reg_best: 70.894394
step:  27, cost: 1.60E-02, attack: 0.991, loss: 1.238006, ce: 0.140123, reg: 68.617668, reg_best: 68.617668
step:  28, cost: 1.60E-02, attack: 0.989, loss: 1.267421, ce: 0.172898, reg: 68.407715, reg_best: 68.617668
step:  29, cost: 1.60E-02, attack: 0.991, loss: 1.231834, ce: 0.170755, reg: 66.317451, reg_best: 66.317451
step:  30, cost: 1.60E-02, attack: 0.994, loss: 1.161576, ce: 0.098824, reg: 66.422028, reg_best: 66.317451
step:  31, cost: 1.60E-02, attack: 0.996, loss: 1.164529, ce: 0.081164, reg: 67.710365, reg_best: 66.317451
step:  32, cost: 1.60E-02, attack: 0.987, loss: 1.244898, ce: 0.201902, reg: 65.187218, reg_best: 66.317451
step:  33, cost: 1.60E-02, attack: 0.992, loss: 1.151252, ce: 0.138794, reg: 63.278606, reg_best: 63.278606
step:  34, cost: 1.60E-02, attack: 0.988, loss: 1.249112, ce: 0.206162, reg: 65.184357, reg_best: 63.278606
step:  35, cost: 1.60E-02, attack: 0.982, loss: 1.277369, ce: 0.276533, reg: 62.552204, reg_best: 63.278606
step:  36, cost: 1.60E-02, attack: 0.985, loss: 1.242887, ce: 0.254713, reg: 61.760929, reg_best: 63.278606
step:  37, cost: 1.60E-02, attack: 0.986, loss: 1.229401, ce: 0.230558, reg: 62.412930, reg_best: 63.278606
step:  38, cost: 1.60E-02, attack: 0.991, loss: 1.186455, ce: 0.178514, reg: 62.996319, reg_best: 62.996319
step:  39, cost: 1.60E-02, attack: 0.990, loss: 1.177720, ce: 0.164713, reg: 63.312958, reg_best: 62.996319
step:  40, cost: 1.60E-02, attack: 0.986, loss: 1.214665, ce: 0.236102, reg: 61.160152, reg_best: 62.996319
step:  41, cost: 1.60E-02, attack: 0.991, loss: 1.128780, ce: 0.140731, reg: 61.753033, reg_best: 61.753033
step:  42, cost: 1.60E-02, attack: 0.989, loss: 1.174441, ce: 0.199398, reg: 60.940144, reg_best: 61.753033
step:  43, cost: 1.60E-02, attack: 0.991, loss: 1.148576, ce: 0.158135, reg: 61.902607, reg_best: 61.753033
step:  44, cost: 1.60E-02, attack: 0.990, loss: 1.143849, ce: 0.155872, reg: 61.748566, reg_best: 61.753033
step:  45, cost: 1.60E-02, attack: 0.990, loss: 1.178497, ce: 0.181140, reg: 62.334805, reg_best: 61.753033
step:  46, cost: 1.60E-02, attack: 0.985, loss: 1.229234, ce: 0.244198, reg: 61.564739, reg_best: 61.753033
step:  47, cost: 1.60E-02, attack: 0.985, loss: 1.211302, ce: 0.245730, reg: 60.348217, reg_best: 61.753033
step:  48, cost: 1.60E-02, attack: 0.986, loss: 1.175086, ce: 0.234191, reg: 58.805935, reg_best: 61.753033
down cost from 1.60E-02 to 5.66E-03
step:  49, cost: 5.66E-03, attack: 0.995, loss: 0.455733, ce: 0.090489, reg: 64.572723, reg_best: 61.753033
step:  50, cost: 5.66E-03, attack: 0.996, loss: 0.437179, ce: 0.075424, reg: 63.949829, reg_best: 61.753033
step:  51, cost: 5.66E-03, attack: 0.994, loss: 0.445857, ce: 0.094480, reg: 62.115181, reg_best: 61.753033
step:  52, cost: 5.66E-03, attack: 0.992, loss: 0.481708, ce: 0.122042, reg: 63.580570, reg_best: 61.753033
step:  53, cost: 5.66E-03, attack: 0.995, loss: 0.440109, ce: 0.077234, reg: 64.147835, reg_best: 61.753033
up cost from 5.66E-03 to 1.13E-02
step:  54, cost: 1.13E-02, attack: 0.992, loss: 0.875708, ce: 0.141732, reg: 64.874893, reg_best: 61.753033
step:  55, cost: 1.13E-02, attack: 0.995, loss: 0.783257, ce: 0.082346, reg: 61.952381, reg_best: 61.753033
step:  56, cost: 1.13E-02, attack: 0.989, loss: 0.864858, ce: 0.191359, reg: 59.529491, reg_best: 61.753033
step:  57, cost: 1.13E-02, attack: 0.990, loss: 0.881207, ce: 0.173318, reg: 62.569099, reg_best: 61.753033
step:  58, cost: 1.13E-02, attack: 0.987, loss: 0.908786, ce: 0.207907, reg: 61.949543, reg_best: 61.753033
step:  59, cost: 1.13E-02, attack: 0.994, loss: 0.826260, ce: 0.109368, reg: 63.364918, reg_best: 61.753033
step:  60, cost: 1.13E-02, attack: 0.997, loss: 0.767971, ce: 0.063397, reg: 62.276180, reg_best: 61.753033
step:  61, cost: 1.13E-02, attack: 0.993, loss: 0.799688, ce: 0.099630, reg: 61.876991, reg_best: 61.753033
step:  62, cost: 1.13E-02, attack: 0.993, loss: 0.808665, ce: 0.112070, reg: 61.575020, reg_best: 61.575020
step:  63, cost: 1.13E-02, attack: 0.994, loss: 0.802086, ce: 0.095332, reg: 62.468895, reg_best: 61.575020
up cost from 1.13E-02 to 2.26E-02
step:  64, cost: 2.26E-02, attack: 0.989, loss: 1.564756, ce: 0.170342, reg: 61.624985, reg_best: 61.575020
step:  65, cost: 2.26E-02, attack: 0.995, loss: 1.455970, ce: 0.103909, reg: 59.753231, reg_best: 59.753231
step:  66, cost: 2.26E-02, attack: 0.983, loss: 1.618193, ce: 0.292482, reg: 58.588718, reg_best: 59.753231
step:  67, cost: 2.26E-02, attack: 0.987, loss: 1.552474, ce: 0.206666, reg: 59.476894, reg_best: 59.753231
step:  68, cost: 2.26E-02, attack: 0.988, loss: 1.515056, ce: 0.205626, reg: 57.869160, reg_best: 59.753231
step:  69, cost: 2.26E-02, attack: 0.995, loss: 1.395790, ce: 0.104320, reg: 57.075443, reg_best: 57.075443
step:  70, cost: 2.26E-02, attack: 0.992, loss: 1.420385, ce: 0.142110, reg: 56.492290, reg_best: 56.492290
step:  71, cost: 2.26E-02, attack: 0.987, loss: 1.481212, ce: 0.219645, reg: 55.753887, reg_best: 56.492290
step:  72, cost: 2.26E-02, attack: 0.980, loss: 1.628779, ce: 0.319632, reg: 57.856674, reg_best: 56.492290
step:  73, cost: 2.26E-02, attack: 0.992, loss: 1.502866, ce: 0.161796, reg: 59.267487, reg_best: 56.492290
step:  74, cost: 2.26E-02, attack: 0.981, loss: 1.575555, ce: 0.311277, reg: 55.873722, reg_best: 56.492290
step:  75, cost: 2.26E-02, attack: 0.987, loss: 1.510215, ce: 0.236401, reg: 56.289478, reg_best: 56.492290
step:  76, cost: 2.26E-02, attack: 0.985, loss: 1.559460, ce: 0.263605, reg: 57.269257, reg_best: 56.492290
step:  77, cost: 2.26E-02, attack: 0.987, loss: 1.476230, ce: 0.199233, reg: 56.435799, reg_best: 56.492290
step:  78, cost: 2.26E-02, attack: 0.987, loss: 1.535555, ce: 0.205091, reg: 58.798771, reg_best: 56.492290
down cost from 2.26E-02 to 8.00E-03
step:  79, cost: 8.00E-03, attack: 0.996, loss: 0.559564, ce: 0.073747, reg: 60.727165, reg_best: 56.492290
step:  80, cost: 8.00E-03, attack: 0.992, loss: 0.617478, ce: 0.118222, reg: 62.406948, reg_best: 56.492290
step:  81, cost: 8.00E-03, attack: 0.996, loss: 0.589335, ce: 0.071673, reg: 64.707710, reg_best: 56.492290
step:  82, cost: 8.00E-03, attack: 0.993, loss: 0.601751, ce: 0.102492, reg: 62.407333, reg_best: 56.492290
step:  83, cost: 8.00E-03, attack: 0.995, loss: 0.573853, ce: 0.074200, reg: 62.456654, reg_best: 56.492290
up cost from 8.00E-03 to 1.60E-02
step:  84, cost: 1.60E-02, attack: 0.994, loss: 1.078412, ce: 0.098555, reg: 61.241016, reg_best: 56.492290
step:  85, cost: 1.60E-02, attack: 0.994, loss: 1.059767, ce: 0.097441, reg: 60.145367, reg_best: 56.492290
step:  86, cost: 1.60E-02, attack: 0.992, loss: 1.071911, ce: 0.133312, reg: 58.662460, reg_best: 56.492290
step:  87, cost: 1.60E-02, attack: 0.993, loss: 1.071991, ce: 0.115964, reg: 59.751690, reg_best: 56.492290
step:  88, cost: 1.60E-02, attack: 0.992, loss: 1.053663, ce: 0.141249, reg: 57.026630, reg_best: 56.492290
up cost from 1.60E-02 to 3.20E-02
step:  89, cost: 3.20E-02, attack: 0.989, loss: 2.040634, ce: 0.170224, reg: 58.450333, reg_best: 56.492290
step:  90, cost: 3.20E-02, attack: 0.992, loss: 1.974482, ce: 0.127802, reg: 57.708744, reg_best: 56.492290
step:  91, cost: 3.20E-02, attack: 0.982, loss: 2.099694, ce: 0.284316, reg: 56.730556, reg_best: 56.492290
step:  92, cost: 3.20E-02, attack: 0.986, loss: 1.969083, ce: 0.222319, reg: 54.586380, reg_best: 56.492290
step:  93, cost: 3.20E-02, attack: 0.980, loss: 2.104782, ce: 0.326777, reg: 55.562672, reg_best: 56.492290
step:  94, cost: 3.20E-02, attack: 0.994, loss: 1.932656, ce: 0.104744, reg: 57.122246, reg_best: 56.492290
step:  95, cost: 3.20E-02, attack: 0.966, loss: 2.215018, ce: 0.546376, reg: 52.145058, reg_best: 56.492290
early stop
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 5: 56.751656
visualization cost 31.872215 seconds
processing label 6
resetting state
mask_tanh -3.928969162810687 4.012443621998195
pattern_tanh -4.09571604200144 3.9522589308587026
step:   0, cost: 0.00E+00, attack: 0.880, loss: 1.968337, ce: 1.968337, reg: 542.726807, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 557.755798, reg_best: 557.755798
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000008, ce: 0.000008, reg: 557.891357, reg_best: 557.755798
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000008, ce: 0.000008, reg: 558.740173, reg_best: 557.755798
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000004, ce: 0.000004, reg: 560.140869, reg_best: 557.755798
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 563.442322, reg_best: 557.755798
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.471718, ce: 0.061430, reg: 410.288025, reg_best: 410.288025
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.319215, ce: 0.005033, reg: 314.181793, reg_best: 314.181793
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.266675, ce: 0.010483, reg: 256.191498, reg_best: 256.191498
step:   9, cost: 1.00E-03, attack: 0.997, loss: 0.249315, ce: 0.053204, reg: 196.111557, reg_best: 196.111557
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.345477, ce: 0.015556, reg: 164.960815, reg_best: 164.960815
step:  11, cost: 2.00E-03, attack: 0.992, loss: 0.397706, ce: 0.127098, reg: 135.303711, reg_best: 135.303711
step:  12, cost: 2.00E-03, attack: 1.000, loss: 0.268617, ce: 0.005466, reg: 131.575150, reg_best: 131.575150
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.277420, ce: 0.016765, reg: 130.327469, reg_best: 130.327469
step:  14, cost: 2.00E-03, attack: 0.997, loss: 0.300642, ce: 0.046712, reg: 126.964844, reg_best: 126.964844
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.999, loss: 0.503387, ce: 0.014791, reg: 122.148926, reg_best: 122.148926
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.474717, ce: 0.024066, reg: 112.662758, reg_best: 112.662758
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.458075, ce: 0.021876, reg: 109.042320, reg_best: 109.042320
step:  18, cost: 4.00E-03, attack: 0.997, loss: 0.453901, ce: 0.048723, reg: 101.294327, reg_best: 101.294327
step:  19, cost: 4.00E-03, attack: 0.994, loss: 0.501723, ce: 0.114056, reg: 96.916725, reg_best: 96.916725
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.998, loss: 0.828867, ce: 0.032168, reg: 99.587418, reg_best: 96.916725
step:  21, cost: 8.00E-03, attack: 0.994, loss: 0.879412, ce: 0.096389, reg: 97.877907, reg_best: 96.916725
step:  22, cost: 8.00E-03, attack: 0.998, loss: 0.773506, ce: 0.036249, reg: 92.157150, reg_best: 92.157150
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.798893, ce: 0.095326, reg: 87.945961, reg_best: 87.945961
step:  24, cost: 8.00E-03, attack: 0.995, loss: 0.782949, ce: 0.079861, reg: 87.886032, reg_best: 87.886032
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.994, loss: 1.455869, ce: 0.109617, reg: 84.140755, reg_best: 84.140755
step:  26, cost: 1.60E-02, attack: 0.988, loss: 1.449756, ce: 0.193013, reg: 78.546440, reg_best: 84.140755
step:  27, cost: 1.60E-02, attack: 0.984, loss: 1.510283, ce: 0.257082, reg: 78.325043, reg_best: 84.140755
step:  28, cost: 1.60E-02, attack: 0.995, loss: 1.409328, ce: 0.079624, reg: 83.106476, reg_best: 83.106476
step:  29, cost: 1.60E-02, attack: 0.992, loss: 1.407681, ce: 0.136623, reg: 79.441101, reg_best: 79.441101
step:  30, cost: 1.60E-02, attack: 0.996, loss: 1.367820, ce: 0.076638, reg: 80.686607, reg_best: 79.441101
step:  31, cost: 1.60E-02, attack: 0.997, loss: 1.387600, ce: 0.084357, reg: 81.452675, reg_best: 79.441101
step:  32, cost: 1.60E-02, attack: 0.996, loss: 1.371646, ce: 0.060012, reg: 81.977081, reg_best: 79.441101
up cost from 1.60E-02 to 3.20E-02
step:  33, cost: 3.20E-02, attack: 0.990, loss: 2.628009, ce: 0.184153, reg: 76.370529, reg_best: 79.441101
step:  34, cost: 3.20E-02, attack: 0.985, loss: 2.699435, ce: 0.243330, reg: 76.753273, reg_best: 79.441101
step:  35, cost: 3.20E-02, attack: 0.985, loss: 2.651414, ce: 0.272435, reg: 74.343063, reg_best: 79.441101
step:  36, cost: 3.20E-02, attack: 0.970, loss: 2.758643, ce: 0.490117, reg: 70.891441, reg_best: 79.441101
step:  37, cost: 3.20E-02, attack: 0.980, loss: 2.595747, ce: 0.324118, reg: 70.988411, reg_best: 79.441101
down cost from 3.20E-02 to 1.13E-02
step:  38, cost: 1.13E-02, attack: 0.991, loss: 0.999403, ce: 0.147002, reg: 75.342346, reg_best: 75.342346
step:  39, cost: 1.13E-02, attack: 0.993, loss: 0.979181, ce: 0.116918, reg: 76.214012, reg_best: 75.342346
step:  40, cost: 1.13E-02, attack: 0.994, loss: 0.985851, ce: 0.097440, reg: 78.525139, reg_best: 75.342346
step:  41, cost: 1.13E-02, attack: 0.995, loss: 0.947483, ce: 0.078693, reg: 76.790848, reg_best: 75.342346
step:  42, cost: 1.13E-02, attack: 0.990, loss: 1.017011, ce: 0.153382, reg: 76.334770, reg_best: 75.342346
step:  43, cost: 1.13E-02, attack: 0.991, loss: 1.004582, ce: 0.147850, reg: 75.747467, reg_best: 75.342346
step:  44, cost: 1.13E-02, attack: 0.987, loss: 1.039945, ce: 0.197337, reg: 74.476753, reg_best: 75.342346
step:  45, cost: 1.13E-02, attack: 0.990, loss: 1.025088, ce: 0.180770, reg: 74.627853, reg_best: 75.342346
step:  46, cost: 1.13E-02, attack: 0.995, loss: 0.950241, ce: 0.085037, reg: 76.473930, reg_best: 75.342346
step:  47, cost: 1.13E-02, attack: 0.991, loss: 0.982208, ce: 0.126061, reg: 75.673454, reg_best: 75.342346
step:  48, cost: 1.13E-02, attack: 0.992, loss: 0.985343, ce: 0.151648, reg: 73.688995, reg_best: 73.688995
step:  49, cost: 1.13E-02, attack: 0.995, loss: 0.987973, ce: 0.107156, reg: 77.853966, reg_best: 73.688995
step:  50, cost: 1.13E-02, attack: 0.997, loss: 0.915923, ce: 0.043921, reg: 77.074883, reg_best: 73.688995
up cost from 1.13E-02 to 2.26E-02
step:  51, cost: 2.26E-02, attack: 0.994, loss: 1.765093, ce: 0.107272, reg: 73.266006, reg_best: 73.266006
step:  52, cost: 2.26E-02, attack: 0.986, loss: 1.798371, ce: 0.257718, reg: 68.087883, reg_best: 73.266006
step:  53, cost: 2.26E-02, attack: 0.987, loss: 1.782290, ce: 0.185428, reg: 70.571976, reg_best: 73.266006
step:  54, cost: 2.26E-02, attack: 0.981, loss: 1.916915, ce: 0.326954, reg: 70.267021, reg_best: 73.266006
step:  55, cost: 2.26E-02, attack: 0.990, loss: 1.805283, ce: 0.159485, reg: 72.735397, reg_best: 73.266006
step:  56, cost: 2.26E-02, attack: 0.994, loss: 1.699398, ce: 0.105310, reg: 70.449425, reg_best: 70.449425
step:  57, cost: 2.26E-02, attack: 0.988, loss: 1.830886, ce: 0.212614, reg: 71.518204, reg_best: 70.449425
step:  58, cost: 2.26E-02, attack: 0.991, loss: 1.797050, ce: 0.144752, reg: 73.021957, reg_best: 70.449425
step:  59, cost: 2.26E-02, attack: 0.988, loss: 1.793117, ce: 0.171268, reg: 71.676277, reg_best: 70.449425
step:  60, cost: 2.26E-02, attack: 0.989, loss: 1.787275, ce: 0.193824, reg: 70.421288, reg_best: 70.449425
step:  61, cost: 2.26E-02, attack: 0.991, loss: 1.759206, ce: 0.160273, reg: 70.663536, reg_best: 70.449425
step:  62, cost: 2.26E-02, attack: 0.993, loss: 1.767399, ce: 0.112228, reg: 73.148895, reg_best: 70.449425
step:  63, cost: 2.26E-02, attack: 0.993, loss: 1.790328, ce: 0.147290, reg: 72.612686, reg_best: 70.449425
step:  64, cost: 2.26E-02, attack: 0.980, loss: 1.862060, ce: 0.313320, reg: 68.445259, reg_best: 70.449425
step:  65, cost: 2.26E-02, attack: 0.983, loss: 1.919919, ce: 0.280745, reg: 72.441956, reg_best: 70.449425
step:  66, cost: 2.26E-02, attack: 0.988, loss: 1.846636, ce: 0.197224, reg: 72.894440, reg_best: 70.449425
step:  67, cost: 2.26E-02, attack: 0.987, loss: 1.758816, ce: 0.217933, reg: 68.098030, reg_best: 70.449425
step:  68, cost: 2.26E-02, attack: 0.991, loss: 1.717921, ce: 0.181701, reg: 67.903236, reg_best: 67.903236
step:  69, cost: 2.26E-02, attack: 0.983, loss: 1.810300, ce: 0.294715, reg: 66.980026, reg_best: 67.903236
step:  70, cost: 2.26E-02, attack: 0.990, loss: 1.725520, ce: 0.189270, reg: 67.893326, reg_best: 67.903236
step:  71, cost: 2.26E-02, attack: 0.987, loss: 1.825206, ce: 0.217388, reg: 71.056213, reg_best: 67.903236
step:  72, cost: 2.26E-02, attack: 0.985, loss: 1.838750, ce: 0.249254, reg: 70.246490, reg_best: 67.903236
step:  73, cost: 2.26E-02, attack: 0.987, loss: 1.724902, ce: 0.203667, reg: 67.229698, reg_best: 67.903236
down cost from 2.26E-02 to 8.00E-03
step:  74, cost: 8.00E-03, attack: 0.989, loss: 0.739150, ce: 0.173031, reg: 70.764847, reg_best: 67.903236
step:  75, cost: 8.00E-03, attack: 0.992, loss: 0.739686, ce: 0.136914, reg: 75.346603, reg_best: 67.903236
step:  76, cost: 8.00E-03, attack: 0.996, loss: 0.675574, ce: 0.068816, reg: 75.844749, reg_best: 67.903236
step:  77, cost: 8.00E-03, attack: 0.997, loss: 0.657838, ce: 0.053338, reg: 75.562462, reg_best: 67.903236
step:  78, cost: 8.00E-03, attack: 0.997, loss: 0.653264, ce: 0.062715, reg: 73.818687, reg_best: 67.903236
step:  79, cost: 8.00E-03, attack: 0.997, loss: 0.658350, ce: 0.052258, reg: 75.761513, reg_best: 67.903236
up cost from 8.00E-03 to 1.60E-02
step:  80, cost: 1.60E-02, attack: 0.992, loss: 1.264455, ce: 0.107309, reg: 72.321663, reg_best: 67.903236
step:  81, cost: 1.60E-02, attack: 0.994, loss: 1.272917, ce: 0.100005, reg: 73.319931, reg_best: 67.903236
step:  82, cost: 1.60E-02, attack: 0.992, loss: 1.298710, ce: 0.122792, reg: 73.494873, reg_best: 67.903236
step:  83, cost: 1.60E-02, attack: 0.993, loss: 1.274356, ce: 0.134500, reg: 71.241020, reg_best: 67.903236
step:  84, cost: 1.60E-02, attack: 0.993, loss: 1.242229, ce: 0.113989, reg: 70.514992, reg_best: 67.903236
up cost from 1.60E-02 to 3.20E-02
step:  85, cost: 3.20E-02, attack: 0.983, loss: 2.429675, ce: 0.279946, reg: 67.179016, reg_best: 67.903236
step:  86, cost: 3.20E-02, attack: 0.984, loss: 2.406107, ce: 0.270843, reg: 66.726982, reg_best: 67.903236
step:  87, cost: 3.20E-02, attack: 0.969, loss: 2.568286, ce: 0.509417, reg: 64.339661, reg_best: 67.903236
step:  88, cost: 3.20E-02, attack: 0.988, loss: 2.320404, ce: 0.222854, reg: 65.548431, reg_best: 67.903236
step:  89, cost: 3.20E-02, attack: 0.977, loss: 2.444865, ce: 0.366275, reg: 64.955925, reg_best: 67.903236
down cost from 3.20E-02 to 1.13E-02
step:  90, cost: 1.13E-02, attack: 0.985, loss: 1.027158, ce: 0.252841, reg: 68.440590, reg_best: 67.903236
step:  91, cost: 1.13E-02, attack: 0.994, loss: 0.934816, ce: 0.107012, reg: 73.168251, reg_best: 67.903236
step:  92, cost: 1.13E-02, attack: 0.995, loss: 0.909719, ce: 0.068274, reg: 74.373993, reg_best: 67.903236
step:  93, cost: 1.13E-02, attack: 0.995, loss: 0.924576, ce: 0.081862, reg: 74.484161, reg_best: 67.903236
early stop
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 6: 67.411530
visualization cost 18.942441 seconds
processing label 7
resetting state
mask_tanh -3.5886308732023537 3.047408740405173
pattern_tanh -4.400756854580439 4.321998214324346
step:   0, cost: 0.00E+00, attack: 0.846, loss: 2.553100, ce: 2.553100, reg: 545.626099, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 566.509460, reg_best: 566.509460
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000106, ce: 0.000106, reg: 569.772705, reg_best: 566.509460
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 570.135254, reg_best: 566.509460
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 570.242798, reg_best: 566.509460
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 570.261597, reg_best: 566.509460
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.995, loss: 0.416756, ce: 0.089232, reg: 327.524750, reg_best: 327.524750
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.284714, ce: 0.034562, reg: 250.151230, reg_best: 250.151230
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.220994, ce: 0.018192, reg: 202.802338, reg_best: 202.802338
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.188489, ce: 0.015044, reg: 173.445511, reg_best: 173.445511
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.996, loss: 0.343741, ce: 0.066606, reg: 138.567383, reg_best: 138.567383
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.294186, ce: 0.023415, reg: 135.385635, reg_best: 135.385635
step:  12, cost: 2.00E-03, attack: 0.996, loss: 0.306460, ce: 0.056516, reg: 124.983284, reg_best: 124.983284
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.269228, ce: 0.010976, reg: 129.125931, reg_best: 124.983284
step:  14, cost: 2.00E-03, attack: 0.998, loss: 0.271547, ce: 0.033688, reg: 118.929474, reg_best: 118.929474
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.998, loss: 0.493679, ce: 0.039600, reg: 113.519814, reg_best: 113.519814
step:  16, cost: 4.00E-03, attack: 0.994, loss: 0.510143, ce: 0.100722, reg: 102.355316, reg_best: 102.355316
step:  17, cost: 4.00E-03, attack: 0.998, loss: 0.453685, ce: 0.044315, reg: 102.342438, reg_best: 102.342438
step:  18, cost: 4.00E-03, attack: 0.993, loss: 0.510685, ce: 0.116273, reg: 98.603188, reg_best: 98.603188
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.454333, ce: 0.034245, reg: 105.021942, reg_best: 98.603188
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.998, loss: 0.828045, ce: 0.050491, reg: 97.194344, reg_best: 97.194344
step:  21, cost: 8.00E-03, attack: 0.995, loss: 0.863227, ce: 0.096008, reg: 95.902451, reg_best: 95.902451
step:  22, cost: 8.00E-03, attack: 0.997, loss: 0.784681, ce: 0.048096, reg: 92.073128, reg_best: 92.073128
step:  23, cost: 8.00E-03, attack: 0.994, loss: 0.801071, ce: 0.117070, reg: 85.500107, reg_best: 85.500107
step:  24, cost: 8.00E-03, attack: 0.994, loss: 0.794664, ce: 0.099959, reg: 86.838074, reg_best: 85.500107
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.992, loss: 1.503964, ce: 0.140779, reg: 85.198578, reg_best: 85.198578
step:  26, cost: 1.60E-02, attack: 0.994, loss: 1.453760, ce: 0.120146, reg: 83.350822, reg_best: 83.350822
step:  27, cost: 1.60E-02, attack: 0.988, loss: 1.504239, ce: 0.197473, reg: 81.672890, reg_best: 83.350822
step:  28, cost: 1.60E-02, attack: 0.987, loss: 1.474622, ce: 0.205638, reg: 79.311493, reg_best: 83.350822
step:  29, cost: 1.60E-02, attack: 0.989, loss: 1.486393, ce: 0.202796, reg: 80.224800, reg_best: 83.350822
step:  30, cost: 1.60E-02, attack: 0.995, loss: 1.414229, ce: 0.086819, reg: 82.963150, reg_best: 82.963150
step:  31, cost: 1.60E-02, attack: 0.992, loss: 1.414823, ce: 0.131879, reg: 80.183990, reg_best: 80.183990
step:  32, cost: 1.60E-02, attack: 0.989, loss: 1.476295, ce: 0.194171, reg: 80.132736, reg_best: 80.183990
step:  33, cost: 1.60E-02, attack: 0.989, loss: 1.413312, ce: 0.172519, reg: 77.549507, reg_best: 80.183990
step:  34, cost: 1.60E-02, attack: 0.998, loss: 1.303472, ce: 0.037819, reg: 79.103294, reg_best: 79.103294
step:  35, cost: 1.60E-02, attack: 0.992, loss: 1.369951, ce: 0.130151, reg: 77.487511, reg_best: 77.487511
step:  36, cost: 1.60E-02, attack: 0.990, loss: 1.410759, ce: 0.180201, reg: 76.909874, reg_best: 77.487511
step:  37, cost: 1.60E-02, attack: 0.985, loss: 1.473063, ce: 0.227662, reg: 77.837547, reg_best: 77.487511
step:  38, cost: 1.60E-02, attack: 0.994, loss: 1.360972, ce: 0.105926, reg: 78.442574, reg_best: 77.487511
step:  39, cost: 1.60E-02, attack: 0.994, loss: 1.385358, ce: 0.103834, reg: 80.095245, reg_best: 77.487511
step:  40, cost: 1.60E-02, attack: 0.992, loss: 1.371700, ce: 0.130962, reg: 77.546135, reg_best: 77.487511
step:  41, cost: 1.60E-02, attack: 0.994, loss: 1.306317, ce: 0.113412, reg: 74.556534, reg_best: 74.556534
step:  42, cost: 1.60E-02, attack: 0.989, loss: 1.368649, ce: 0.179618, reg: 74.314453, reg_best: 74.556534
step:  43, cost: 1.60E-02, attack: 0.988, loss: 1.372627, ce: 0.202202, reg: 73.151527, reg_best: 74.556534
step:  44, cost: 1.60E-02, attack: 0.990, loss: 1.401474, ce: 0.168717, reg: 77.047318, reg_best: 74.556534
step:  45, cost: 1.60E-02, attack: 0.990, loss: 1.343207, ce: 0.153037, reg: 74.385582, reg_best: 74.556534
step:  46, cost: 1.60E-02, attack: 0.988, loss: 1.366836, ce: 0.183051, reg: 73.986542, reg_best: 74.556534
down cost from 1.60E-02 to 5.66E-03
step:  47, cost: 5.66E-03, attack: 0.995, loss: 0.519184, ce: 0.085448, reg: 76.674377, reg_best: 74.556534
step:  48, cost: 5.66E-03, attack: 0.996, loss: 0.521473, ce: 0.066355, reg: 80.454208, reg_best: 74.556534
step:  49, cost: 5.66E-03, attack: 0.997, loss: 0.502061, ce: 0.044376, reg: 80.908028, reg_best: 74.556534
step:  50, cost: 5.66E-03, attack: 0.998, loss: 0.484498, ce: 0.043245, reg: 78.002892, reg_best: 74.556534
step:  51, cost: 5.66E-03, attack: 0.997, loss: 0.491365, ce: 0.057634, reg: 76.673569, reg_best: 74.556534
up cost from 5.66E-03 to 1.13E-02
step:  52, cost: 1.13E-02, attack: 0.992, loss: 0.999962, ce: 0.132981, reg: 76.631065, reg_best: 74.556534
step:  53, cost: 1.13E-02, attack: 0.994, loss: 0.953373, ce: 0.094049, reg: 75.954178, reg_best: 74.556534
step:  54, cost: 1.13E-02, attack: 0.996, loss: 0.945763, ce: 0.061279, reg: 78.178055, reg_best: 74.556534
step:  55, cost: 1.13E-02, attack: 0.998, loss: 0.912214, ce: 0.044195, reg: 76.722717, reg_best: 74.556534
step:  56, cost: 1.13E-02, attack: 0.994, loss: 0.940267, ce: 0.106018, reg: 73.737816, reg_best: 73.737816
up cost from 1.13E-02 to 2.26E-02
step:  57, cost: 2.26E-02, attack: 0.983, loss: 1.944552, ce: 0.279813, reg: 73.571747, reg_best: 73.737816
step:  58, cost: 2.26E-02, attack: 0.989, loss: 1.854389, ce: 0.186693, reg: 73.702431, reg_best: 73.737816
step:  59, cost: 2.26E-02, attack: 0.991, loss: 1.811716, ce: 0.155411, reg: 73.199036, reg_best: 73.199036
step:  60, cost: 2.26E-02, attack: 0.984, loss: 1.876194, ce: 0.248226, reg: 71.946709, reg_best: 73.199036
step:  61, cost: 2.26E-02, attack: 0.990, loss: 1.802274, ce: 0.160339, reg: 72.563950, reg_best: 73.199036
step:  62, cost: 2.26E-02, attack: 0.987, loss: 1.849196, ce: 0.209172, reg: 72.479500, reg_best: 73.199036
step:  63, cost: 2.26E-02, attack: 0.993, loss: 1.743902, ce: 0.099789, reg: 72.642708, reg_best: 72.642708
step:  64, cost: 2.26E-02, attack: 0.993, loss: 1.805094, ce: 0.118189, reg: 74.551361, reg_best: 72.642708
step:  65, cost: 2.26E-02, attack: 0.986, loss: 1.834018, ce: 0.222082, reg: 71.238144, reg_best: 72.642708
step:  66, cost: 2.26E-02, attack: 0.990, loss: 1.784198, ce: 0.173731, reg: 71.173271, reg_best: 72.642708
step:  67, cost: 2.26E-02, attack: 0.995, loss: 1.713858, ce: 0.089575, reg: 71.783867, reg_best: 71.783867
step:  68, cost: 2.26E-02, attack: 0.991, loss: 1.750584, ce: 0.150545, reg: 70.712357, reg_best: 70.712357
step:  69, cost: 2.26E-02, attack: 0.994, loss: 1.761725, ce: 0.138083, reg: 71.755508, reg_best: 70.712357
step:  70, cost: 2.26E-02, attack: 0.984, loss: 1.801906, ce: 0.250632, reg: 68.557312, reg_best: 70.712357
step:  71, cost: 2.26E-02, attack: 0.988, loss: 1.832817, ce: 0.221286, reg: 71.220268, reg_best: 70.712357
step:  72, cost: 2.26E-02, attack: 0.992, loss: 1.797772, ce: 0.147175, reg: 72.946800, reg_best: 70.712357
step:  73, cost: 2.26E-02, attack: 0.989, loss: 1.772688, ce: 0.154779, reg: 71.502129, reg_best: 70.712357
step:  74, cost: 2.26E-02, attack: 0.992, loss: 1.693563, ce: 0.133111, reg: 68.962868, reg_best: 68.962868
step:  75, cost: 2.26E-02, attack: 0.983, loss: 1.775262, ce: 0.290957, reg: 65.597633, reg_best: 68.962868
step:  76, cost: 2.26E-02, attack: 0.983, loss: 1.781351, ce: 0.285941, reg: 66.097511, reg_best: 68.962868
step:  77, cost: 2.26E-02, attack: 0.993, loss: 1.716250, ce: 0.137239, reg: 69.783096, reg_best: 68.962868
step:  78, cost: 2.26E-02, attack: 0.991, loss: 1.709876, ce: 0.127542, reg: 69.929924, reg_best: 68.962868
step:  79, cost: 2.26E-02, attack: 0.985, loss: 1.816012, ce: 0.245972, reg: 69.386612, reg_best: 68.962868
step:  80, cost: 2.26E-02, attack: 0.988, loss: 1.753314, ce: 0.197925, reg: 68.739159, reg_best: 68.962868
step:  81, cost: 2.26E-02, attack: 0.987, loss: 1.796367, ce: 0.221954, reg: 69.579887, reg_best: 68.962868
step:  82, cost: 2.26E-02, attack: 0.986, loss: 1.851575, ce: 0.228001, reg: 71.752487, reg_best: 68.962868
step:  83, cost: 2.26E-02, attack: 0.991, loss: 1.727708, ce: 0.160515, reg: 69.260788, reg_best: 68.962868
step:  84, cost: 2.26E-02, attack: 0.991, loss: 1.771438, ce: 0.160695, reg: 71.185440, reg_best: 68.962868
step:  85, cost: 2.26E-02, attack: 0.990, loss: 1.770854, ce: 0.163833, reg: 71.020973, reg_best: 68.962868
step:  86, cost: 2.26E-02, attack: 0.994, loss: 1.711543, ce: 0.128966, reg: 69.940666, reg_best: 68.962868
step:  87, cost: 2.26E-02, attack: 0.994, loss: 1.708773, ce: 0.112966, reg: 70.525383, reg_best: 68.962868
step:  88, cost: 2.26E-02, attack: 0.983, loss: 1.829402, ce: 0.281486, reg: 68.408867, reg_best: 68.962868
step:  89, cost: 2.26E-02, attack: 0.988, loss: 1.774065, ce: 0.181858, reg: 70.375557, reg_best: 68.962868
step:  90, cost: 2.26E-02, attack: 0.990, loss: 1.775780, ce: 0.174193, reg: 70.780815, reg_best: 68.962868
step:  91, cost: 2.26E-02, attack: 0.987, loss: 1.783128, ce: 0.201626, reg: 69.893219, reg_best: 68.962868
step:  92, cost: 2.26E-02, attack: 0.992, loss: 1.710241, ce: 0.105949, reg: 70.900345, reg_best: 68.962868
step:  93, cost: 2.26E-02, attack: 0.984, loss: 1.821303, ce: 0.253888, reg: 69.270592, reg_best: 68.962868
step:  94, cost: 2.26E-02, attack: 0.989, loss: 1.784179, ce: 0.192195, reg: 70.356453, reg_best: 68.962868
step:  95, cost: 2.26E-02, attack: 0.993, loss: 1.751179, ce: 0.122031, reg: 71.998840, reg_best: 68.962868
step:  96, cost: 2.26E-02, attack: 0.989, loss: 1.782401, ce: 0.198224, reg: 70.011391, reg_best: 68.962868
step:  97, cost: 2.26E-02, attack: 0.986, loss: 1.828604, ce: 0.234867, reg: 70.433884, reg_best: 68.962868
step:  98, cost: 2.26E-02, attack: 0.989, loss: 1.744006, ce: 0.193228, reg: 68.535362, reg_best: 68.962868
step:  99, cost: 2.26E-02, attack: 0.989, loss: 1.768188, ce: 0.206581, reg: 69.013939, reg_best: 68.962868
early stop
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 7: 66.850655
visualization cost 20.192558 seconds
processing label 8
resetting state
mask_tanh -5.287960633112325 3.1802627772610848
pattern_tanh -4.298215697687706 5.169730999654665
step:   0, cost: 0.00E+00, attack: 0.871, loss: 2.112470, ce: 2.112470, reg: 530.274536, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000347, ce: 0.000347, reg: 554.281433, reg_best: 554.281433
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 554.505371, reg_best: 554.281433
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 554.553467, reg_best: 554.281433
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000021, ce: 0.000021, reg: 559.437866, reg_best: 554.281433
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 563.702271, reg_best: 554.281433
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.994, loss: 0.429525, ce: 0.091786, reg: 337.739441, reg_best: 337.739441
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.261921, ce: 0.006165, reg: 255.755951, reg_best: 255.755951
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.228414, ce: 0.016565, reg: 211.849075, reg_best: 211.849075
step:   9, cost: 1.00E-03, attack: 0.997, loss: 0.225520, ce: 0.056979, reg: 168.541138, reg_best: 168.541138
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.992, loss: 0.440834, ce: 0.137928, reg: 151.452805, reg_best: 151.452805
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.328589, ce: 0.033795, reg: 147.397125, reg_best: 147.397125
step:  12, cost: 2.00E-03, attack: 0.996, loss: 0.324522, ce: 0.061862, reg: 131.330093, reg_best: 131.330093
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.295288, ce: 0.030763, reg: 132.262314, reg_best: 131.330093
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.279511, ce: 0.009614, reg: 134.958557, reg_best: 131.330093
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.991, loss: 0.609284, ce: 0.143219, reg: 116.516418, reg_best: 116.516418
step:  16, cost: 4.00E-03, attack: 0.994, loss: 0.544057, ce: 0.099407, reg: 111.162544, reg_best: 111.162544
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.470809, ce: 0.023655, reg: 111.788315, reg_best: 111.162544
step:  18, cost: 4.00E-03, attack: 0.998, loss: 0.465985, ce: 0.035549, reg: 107.608994, reg_best: 107.608994
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.439915, ce: 0.033743, reg: 101.542839, reg_best: 101.542839
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.993, loss: 0.883966, ce: 0.121809, reg: 95.269547, reg_best: 95.269547
step:  21, cost: 8.00E-03, attack: 0.997, loss: 0.774589, ce: 0.046379, reg: 91.026161, reg_best: 91.026161
step:  22, cost: 8.00E-03, attack: 0.995, loss: 0.795227, ce: 0.095815, reg: 87.426567, reg_best: 87.426567
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.783074, ce: 0.096187, reg: 85.860847, reg_best: 85.860847
step:  24, cost: 8.00E-03, attack: 0.999, loss: 0.720618, ce: 0.018524, reg: 87.761757, reg_best: 85.860847
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.994, loss: 1.407110, ce: 0.107416, reg: 81.230911, reg_best: 81.230911
step:  26, cost: 1.60E-02, attack: 0.994, loss: 1.394494, ce: 0.106304, reg: 80.511879, reg_best: 80.511879
step:  27, cost: 1.60E-02, attack: 0.993, loss: 1.345321, ce: 0.099251, reg: 77.859482, reg_best: 77.859482
step:  28, cost: 1.60E-02, attack: 0.997, loss: 1.288595, ce: 0.047428, reg: 77.572906, reg_best: 77.572906
step:  29, cost: 1.60E-02, attack: 0.988, loss: 1.414682, ce: 0.203483, reg: 75.699898, reg_best: 77.572906
step:  30, cost: 1.60E-02, attack: 0.990, loss: 1.352357, ce: 0.173479, reg: 73.679863, reg_best: 77.572906
step:  31, cost: 1.60E-02, attack: 0.993, loss: 1.274921, ce: 0.116771, reg: 72.384346, reg_best: 72.384346
step:  32, cost: 1.60E-02, attack: 0.995, loss: 1.279581, ce: 0.121442, reg: 72.383705, reg_best: 72.383705
step:  33, cost: 1.60E-02, attack: 0.989, loss: 1.378470, ce: 0.186319, reg: 74.509407, reg_best: 72.383705
step:  34, cost: 1.60E-02, attack: 0.993, loss: 1.245579, ce: 0.110873, reg: 70.919136, reg_best: 70.919136
step:  35, cost: 1.60E-02, attack: 0.978, loss: 1.442442, ce: 0.347638, reg: 68.425262, reg_best: 70.919136
step:  36, cost: 1.60E-02, attack: 0.992, loss: 1.264670, ce: 0.128825, reg: 70.990341, reg_best: 70.919136
step:  37, cost: 1.60E-02, attack: 0.989, loss: 1.284004, ce: 0.168947, reg: 69.691063, reg_best: 70.919136
step:  38, cost: 1.60E-02, attack: 0.987, loss: 1.314530, ce: 0.199324, reg: 69.700356, reg_best: 70.919136
step:  39, cost: 1.60E-02, attack: 0.994, loss: 1.221857, ce: 0.099136, reg: 70.170082, reg_best: 70.170082
step:  40, cost: 1.60E-02, attack: 0.989, loss: 1.216946, ce: 0.195900, reg: 63.816624, reg_best: 70.170082
step:  41, cost: 1.60E-02, attack: 0.989, loss: 1.266801, ce: 0.180014, reg: 67.924164, reg_best: 70.170082
step:  42, cost: 1.60E-02, attack: 0.995, loss: 1.161393, ce: 0.088429, reg: 67.060234, reg_best: 67.060234
step:  43, cost: 1.60E-02, attack: 0.992, loss: 1.228904, ce: 0.138502, reg: 68.150139, reg_best: 67.060234
step:  44, cost: 1.60E-02, attack: 0.994, loss: 1.188886, ce: 0.084898, reg: 68.999229, reg_best: 67.060234
step:  45, cost: 1.60E-02, attack: 0.990, loss: 1.236288, ce: 0.163798, reg: 67.030663, reg_best: 67.060234
step:  46, cost: 1.60E-02, attack: 0.982, loss: 1.336883, ce: 0.285830, reg: 65.690781, reg_best: 67.060234
step:  47, cost: 1.60E-02, attack: 0.991, loss: 1.239120, ce: 0.141446, reg: 68.604637, reg_best: 67.060234
step:  48, cost: 1.60E-02, attack: 0.995, loss: 1.210530, ce: 0.073644, reg: 71.055351, reg_best: 67.060234
step:  49, cost: 1.60E-02, attack: 0.992, loss: 1.249088, ce: 0.136070, reg: 69.563629, reg_best: 67.060234
step:  50, cost: 1.60E-02, attack: 0.986, loss: 1.333332, ce: 0.242234, reg: 68.193604, reg_best: 67.060234
step:  51, cost: 1.60E-02, attack: 0.993, loss: 1.229113, ce: 0.123338, reg: 69.110924, reg_best: 67.060234
step:  52, cost: 1.60E-02, attack: 0.992, loss: 1.237597, ce: 0.131433, reg: 69.138054, reg_best: 67.060234
step:  53, cost: 1.60E-02, attack: 0.993, loss: 1.195035, ce: 0.102839, reg: 68.262207, reg_best: 67.060234
step:  54, cost: 1.60E-02, attack: 0.995, loss: 1.185765, ce: 0.077785, reg: 69.248726, reg_best: 67.060234
step:  55, cost: 1.60E-02, attack: 0.996, loss: 1.145076, ce: 0.064648, reg: 67.526764, reg_best: 67.060234
up cost from 1.60E-02 to 3.20E-02
step:  56, cost: 3.20E-02, attack: 0.980, loss: 2.453379, ce: 0.331164, reg: 66.319221, reg_best: 67.060234
step:  57, cost: 3.20E-02, attack: 0.980, loss: 2.358341, ce: 0.319293, reg: 63.720234, reg_best: 67.060234
step:  58, cost: 3.20E-02, attack: 0.985, loss: 2.256241, ce: 0.222924, reg: 63.541161, reg_best: 67.060234
step:  59, cost: 3.20E-02, attack: 0.982, loss: 2.312444, ce: 0.274048, reg: 63.699867, reg_best: 67.060234
step:  60, cost: 3.20E-02, attack: 0.973, loss: 2.387256, ce: 0.410245, reg: 61.781601, reg_best: 67.060234
down cost from 3.20E-02 to 1.13E-02
step:  61, cost: 1.13E-02, attack: 0.992, loss: 0.888148, ce: 0.137103, reg: 66.383598, reg_best: 66.383598
step:  62, cost: 1.13E-02, attack: 0.996, loss: 0.872416, ce: 0.076520, reg: 70.347916, reg_best: 66.383598
step:  63, cost: 1.13E-02, attack: 0.994, loss: 0.872865, ce: 0.092761, reg: 68.952141, reg_best: 66.383598
step:  64, cost: 1.13E-02, attack: 0.995, loss: 0.876389, ce: 0.118731, reg: 66.968170, reg_best: 66.383598
step:  65, cost: 1.13E-02, attack: 0.994, loss: 0.876766, ce: 0.098292, reg: 68.798798, reg_best: 66.383598
up cost from 1.13E-02 to 2.26E-02
step:  66, cost: 2.26E-02, attack: 0.981, loss: 1.740888, ce: 0.299015, reg: 63.722359, reg_best: 66.383598
step:  67, cost: 2.26E-02, attack: 0.987, loss: 1.698820, ce: 0.221339, reg: 65.296059, reg_best: 66.383598
step:  68, cost: 2.26E-02, attack: 0.994, loss: 1.606383, ce: 0.115302, reg: 65.897118, reg_best: 65.897118
step:  69, cost: 2.26E-02, attack: 0.983, loss: 1.724068, ce: 0.281732, reg: 63.742828, reg_best: 65.897118
step:  70, cost: 2.26E-02, attack: 0.984, loss: 1.644054, ce: 0.245246, reg: 61.819134, reg_best: 65.897118
step:  71, cost: 2.26E-02, attack: 0.987, loss: 1.631461, ce: 0.208519, reg: 62.885773, reg_best: 65.897118
step:  72, cost: 2.26E-02, attack: 0.987, loss: 1.633358, ce: 0.206074, reg: 63.077610, reg_best: 65.897118
step:  73, cost: 2.26E-02, attack: 0.994, loss: 1.524994, ce: 0.114101, reg: 62.353256, reg_best: 62.353256
step:  74, cost: 2.26E-02, attack: 0.987, loss: 1.616585, ce: 0.230423, reg: 61.260269, reg_best: 62.353256
step:  75, cost: 2.26E-02, attack: 0.986, loss: 1.623258, ce: 0.229057, reg: 61.615562, reg_best: 62.353256
step:  76, cost: 2.26E-02, attack: 0.993, loss: 1.607253, ce: 0.117847, reg: 65.823074, reg_best: 62.353256
step:  77, cost: 2.26E-02, attack: 0.989, loss: 1.627043, ce: 0.184723, reg: 63.742153, reg_best: 62.353256
step:  78, cost: 2.26E-02, attack: 0.983, loss: 1.679245, ce: 0.286668, reg: 61.555805, reg_best: 62.353256
step:  79, cost: 2.26E-02, attack: 0.978, loss: 1.705201, ce: 0.371935, reg: 58.922592, reg_best: 62.353256
step:  80, cost: 2.26E-02, attack: 0.982, loss: 1.754321, ce: 0.291826, reg: 64.633774, reg_best: 62.353256
step:  81, cost: 2.26E-02, attack: 0.992, loss: 1.601170, ce: 0.136666, reg: 64.722542, reg_best: 62.353256
step:  82, cost: 2.26E-02, attack: 0.991, loss: 1.640041, ce: 0.159310, reg: 65.439682, reg_best: 62.353256
step:  83, cost: 2.26E-02, attack: 0.992, loss: 1.560120, ce: 0.138672, reg: 62.819736, reg_best: 62.353256
step:  84, cost: 2.26E-02, attack: 0.992, loss: 1.589804, ce: 0.134801, reg: 64.302673, reg_best: 62.353256
step:  85, cost: 2.26E-02, attack: 0.991, loss: 1.607654, ce: 0.162191, reg: 63.881065, reg_best: 62.353256
up cost from 2.26E-02 to 4.53E-02
step:  86, cost: 4.53E-02, attack: 0.981, loss: 3.034831, ce: 0.314468, reg: 60.112106, reg_best: 62.353256
step:  87, cost: 4.53E-02, attack: 0.973, loss: 3.142104, ce: 0.447223, reg: 59.549026, reg_best: 62.353256
step:  88, cost: 4.53E-02, attack: 0.972, loss: 3.131514, ce: 0.443471, reg: 59.397915, reg_best: 62.353256
step:  89, cost: 4.53E-02, attack: 0.976, loss: 3.065212, ce: 0.408932, reg: 58.696026, reg_best: 62.353256
step:  90, cost: 4.53E-02, attack: 0.980, loss: 3.025301, ce: 0.355431, reg: 58.996342, reg_best: 62.353256
down cost from 4.53E-02 to 1.60E-02
step:  91, cost: 1.60E-02, attack: 0.984, loss: 1.207113, ce: 0.261132, reg: 59.136131, reg_best: 62.353256
step:  92, cost: 1.60E-02, attack: 0.992, loss: 1.132847, ce: 0.137365, reg: 62.217632, reg_best: 62.217632
step:  93, cost: 1.60E-02, attack: 0.992, loss: 1.149020, ce: 0.124930, reg: 64.005585, reg_best: 62.217632
step:  94, cost: 1.60E-02, attack: 0.991, loss: 1.193548, ce: 0.148197, reg: 65.334442, reg_best: 62.217632
step:  95, cost: 1.60E-02, attack: 0.990, loss: 1.167816, ce: 0.161742, reg: 62.879658, reg_best: 62.217632
step:  96, cost: 1.60E-02, attack: 0.987, loss: 1.233756, ce: 0.203109, reg: 64.415451, reg_best: 62.217632
step:  97, cost: 1.60E-02, attack: 0.992, loss: 1.151859, ce: 0.140418, reg: 63.215008, reg_best: 62.217632
step:  98, cost: 1.60E-02, attack: 0.983, loss: 1.294242, ce: 0.267341, reg: 64.181297, reg_best: 62.217632
step:  99, cost: 1.60E-02, attack: 0.992, loss: 1.176133, ce: 0.123851, reg: 65.767639, reg_best: 62.217632
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 8: 62.846085
visualization cost 20.246882 seconds
processing label 9
resetting state
mask_tanh -3.225723675657185 3.371397837584946
pattern_tanh -5.536057221469437 3.812042494797398
step:   0, cost: 0.00E+00, attack: 0.900, loss: 1.698945, ce: 1.698945, reg: 541.846130, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 558.312805, reg_best: 558.312805
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000006, ce: 0.000006, reg: 558.504028, reg_best: 558.312805
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 558.785522, reg_best: 558.312805
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 559.064758, reg_best: 558.312805
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 561.388367, reg_best: 558.312805
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 1.000, loss: 0.400907, ce: 0.010188, reg: 390.719421, reg_best: 390.719421
step:   7, cost: 1.00E-03, attack: 0.995, loss: 0.332825, ce: 0.079107, reg: 253.717911, reg_best: 253.717911
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.226312, ce: 0.015756, reg: 210.556229, reg_best: 210.556229
step:   9, cost: 1.00E-03, attack: 1.000, loss: 0.188064, ce: 0.007253, reg: 180.811310, reg_best: 180.811310
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.995, loss: 0.381444, ce: 0.087366, reg: 147.039108, reg_best: 147.039108
step:  11, cost: 2.00E-03, attack: 0.996, loss: 0.312053, ce: 0.045378, reg: 133.337402, reg_best: 133.337402
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.277838, ce: 0.011885, reg: 132.976227, reg_best: 132.976227
step:  13, cost: 2.00E-03, attack: 0.996, loss: 0.306620, ce: 0.072607, reg: 117.006783, reg_best: 117.006783
step:  14, cost: 2.00E-03, attack: 0.998, loss: 0.243824, ce: 0.022447, reg: 110.688400, reg_best: 110.688400
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.993, loss: 0.536984, ce: 0.108854, reg: 107.032639, reg_best: 107.032639
step:  16, cost: 4.00E-03, attack: 0.997, loss: 0.436807, ce: 0.048966, reg: 96.893105, reg_best: 96.893105
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.444651, ce: 0.050903, reg: 98.436951, reg_best: 96.893105
step:  18, cost: 4.00E-03, attack: 0.998, loss: 0.400970, ce: 0.029327, reg: 92.910774, reg_best: 92.910774
step:  19, cost: 4.00E-03, attack: 0.996, loss: 0.440448, ce: 0.075262, reg: 91.296661, reg_best: 91.296661
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.990, loss: 0.875796, ce: 0.165226, reg: 88.821228, reg_best: 91.296661
step:  21, cost: 8.00E-03, attack: 0.987, loss: 0.891485, ce: 0.225607, reg: 83.234818, reg_best: 91.296661
step:  22, cost: 8.00E-03, attack: 0.993, loss: 0.780579, ce: 0.113353, reg: 83.403290, reg_best: 83.403290
step:  23, cost: 8.00E-03, attack: 0.991, loss: 0.767132, ce: 0.133984, reg: 79.143478, reg_best: 79.143478
step:  24, cost: 8.00E-03, attack: 0.993, loss: 0.746664, ce: 0.103152, reg: 80.438965, reg_best: 79.143478
step:  25, cost: 8.00E-03, attack: 0.990, loss: 0.797162, ce: 0.168516, reg: 78.580788, reg_best: 79.143478
step:  26, cost: 8.00E-03, attack: 0.994, loss: 0.715088, ce: 0.094694, reg: 77.549156, reg_best: 77.549156
step:  27, cost: 8.00E-03, attack: 0.998, loss: 0.677586, ce: 0.046626, reg: 78.870071, reg_best: 77.549156
step:  28, cost: 8.00E-03, attack: 0.992, loss: 0.751169, ce: 0.132698, reg: 77.308937, reg_best: 77.308937
step:  29, cost: 8.00E-03, attack: 0.992, loss: 0.734408, ce: 0.120851, reg: 76.703354, reg_best: 76.703354
step:  30, cost: 8.00E-03, attack: 0.992, loss: 0.735782, ce: 0.134609, reg: 75.146568, reg_best: 75.146568
up cost from 8.00E-03 to 1.60E-02
step:  31, cost: 1.60E-02, attack: 0.995, loss: 1.263740, ce: 0.071094, reg: 74.540390, reg_best: 74.540390
step:  32, cost: 1.60E-02, attack: 0.992, loss: 1.269636, ce: 0.120415, reg: 71.826324, reg_best: 71.826324
step:  33, cost: 1.60E-02, attack: 0.990, loss: 1.273686, ce: 0.156450, reg: 69.827232, reg_best: 71.826324
step:  34, cost: 1.60E-02, attack: 0.989, loss: 1.288938, ce: 0.178470, reg: 69.404274, reg_best: 71.826324
step:  35, cost: 1.60E-02, attack: 0.990, loss: 1.284315, ce: 0.164760, reg: 69.972221, reg_best: 71.826324
step:  36, cost: 1.60E-02, attack: 0.993, loss: 1.286504, ce: 0.138009, reg: 71.780945, reg_best: 71.780945
step:  37, cost: 1.60E-02, attack: 0.989, loss: 1.349625, ce: 0.189473, reg: 72.509483, reg_best: 71.780945
step:  38, cost: 1.60E-02, attack: 0.995, loss: 1.218755, ce: 0.086172, reg: 70.786423, reg_best: 70.786423
step:  39, cost: 1.60E-02, attack: 0.989, loss: 1.337468, ce: 0.196477, reg: 71.311928, reg_best: 70.786423
step:  40, cost: 1.60E-02, attack: 0.990, loss: 1.249172, ce: 0.178455, reg: 66.919769, reg_best: 70.786423
step:  41, cost: 1.60E-02, attack: 0.985, loss: 1.312933, ce: 0.246166, reg: 66.672966, reg_best: 70.786423
step:  42, cost: 1.60E-02, attack: 0.994, loss: 1.218032, ce: 0.083815, reg: 70.916954, reg_best: 70.786423
step:  43, cost: 1.60E-02, attack: 0.990, loss: 1.291090, ce: 0.164588, reg: 70.406342, reg_best: 70.786423
step:  44, cost: 1.60E-02, attack: 0.990, loss: 1.270806, ce: 0.171862, reg: 68.683975, reg_best: 70.786423
step:  45, cost: 1.60E-02, attack: 0.987, loss: 1.290639, ce: 0.221476, reg: 66.822655, reg_best: 70.786423
step:  46, cost: 1.60E-02, attack: 0.987, loss: 1.340913, ce: 0.213676, reg: 70.452316, reg_best: 70.786423
step:  47, cost: 1.60E-02, attack: 0.994, loss: 1.221547, ce: 0.100641, reg: 70.056618, reg_best: 70.056618
step:  48, cost: 1.60E-02, attack: 0.982, loss: 1.340351, ce: 0.276963, reg: 66.461777, reg_best: 70.056618
step:  49, cost: 1.60E-02, attack: 0.990, loss: 1.230704, ce: 0.158981, reg: 66.982704, reg_best: 70.056618
step:  50, cost: 1.60E-02, attack: 0.989, loss: 1.300234, ce: 0.184707, reg: 69.720406, reg_best: 70.056618
step:  51, cost: 1.60E-02, attack: 0.991, loss: 1.214632, ce: 0.152678, reg: 66.372086, reg_best: 66.372086
step:  52, cost: 1.60E-02, attack: 0.987, loss: 1.267238, ce: 0.208295, reg: 66.183945, reg_best: 66.372086
step:  53, cost: 1.60E-02, attack: 0.988, loss: 1.266667, ce: 0.216556, reg: 65.631920, reg_best: 66.372086
step:  54, cost: 1.60E-02, attack: 0.993, loss: 1.155065, ce: 0.104709, reg: 65.647392, reg_best: 65.647392
step:  55, cost: 1.60E-02, attack: 0.981, loss: 1.305339, ce: 0.304581, reg: 62.547382, reg_best: 65.647392
step:  56, cost: 1.60E-02, attack: 0.981, loss: 1.312832, ce: 0.291115, reg: 63.857323, reg_best: 65.647392
step:  57, cost: 1.60E-02, attack: 0.988, loss: 1.230510, ce: 0.198017, reg: 64.530830, reg_best: 65.647392
step:  58, cost: 1.60E-02, attack: 0.984, loss: 1.334625, ce: 0.266720, reg: 66.744041, reg_best: 65.647392
step:  59, cost: 1.60E-02, attack: 0.987, loss: 1.261567, ce: 0.208130, reg: 65.839752, reg_best: 65.647392
down cost from 1.60E-02 to 5.66E-03
step:  60, cost: 5.66E-03, attack: 0.992, loss: 0.533109, ce: 0.150985, reg: 67.550522, reg_best: 65.647392
step:  61, cost: 5.66E-03, attack: 0.996, loss: 0.467945, ce: 0.066533, reg: 70.960388, reg_best: 65.647392
step:  62, cost: 5.66E-03, attack: 0.997, loss: 0.459464, ce: 0.053827, reg: 71.707161, reg_best: 65.647392
step:  63, cost: 5.66E-03, attack: 0.988, loss: 0.579326, ce: 0.194438, reg: 68.039276, reg_best: 65.647392
step:  64, cost: 5.66E-03, attack: 0.992, loss: 0.522503, ce: 0.136741, reg: 68.193672, reg_best: 65.647392
step:  65, cost: 5.66E-03, attack: 0.995, loss: 0.482860, ce: 0.092410, reg: 69.022392, reg_best: 65.647392
step:  66, cost: 5.66E-03, attack: 0.994, loss: 0.477929, ce: 0.099353, reg: 66.923515, reg_best: 65.647392
step:  67, cost: 5.66E-03, attack: 0.992, loss: 0.539350, ce: 0.148071, reg: 69.171471, reg_best: 65.647392
step:  68, cost: 5.66E-03, attack: 0.995, loss: 0.489960, ce: 0.076025, reg: 73.174019, reg_best: 65.647392
up cost from 5.66E-03 to 1.13E-02
step:  69, cost: 1.13E-02, attack: 0.987, loss: 0.981095, ce: 0.231215, reg: 66.280624, reg_best: 65.647392
step:  70, cost: 1.13E-02, attack: 0.993, loss: 0.908640, ce: 0.120327, reg: 69.677742, reg_best: 65.647392
step:  71, cost: 1.13E-02, attack: 0.990, loss: 0.925397, ce: 0.156019, reg: 68.003990, reg_best: 65.647392
step:  72, cost: 1.13E-02, attack: 0.986, loss: 0.951690, ce: 0.223249, reg: 64.385643, reg_best: 65.647392
step:  73, cost: 1.13E-02, attack: 0.992, loss: 0.886301, ce: 0.146003, reg: 65.433769, reg_best: 65.433769
step:  74, cost: 1.13E-02, attack: 0.992, loss: 0.879666, ce: 0.140528, reg: 65.331169, reg_best: 65.331169
step:  75, cost: 1.13E-02, attack: 0.987, loss: 0.929687, ce: 0.196436, reg: 64.810822, reg_best: 65.331169
step:  76, cost: 1.13E-02, attack: 0.991, loss: 0.886449, ce: 0.143423, reg: 65.674782, reg_best: 65.331169
step:  77, cost: 1.13E-02, attack: 0.994, loss: 0.834994, ce: 0.117928, reg: 63.380295, reg_best: 63.380295
step:  78, cost: 1.13E-02, attack: 0.993, loss: 0.863019, ce: 0.118786, reg: 65.781517, reg_best: 63.380295
step:  79, cost: 1.13E-02, attack: 0.992, loss: 0.901645, ce: 0.138512, reg: 67.452042, reg_best: 63.380295
step:  80, cost: 1.13E-02, attack: 0.994, loss: 0.832872, ce: 0.108336, reg: 64.057785, reg_best: 63.380295
up cost from 1.13E-02 to 2.26E-02
step:  81, cost: 2.26E-02, attack: 0.993, loss: 1.555818, ce: 0.133527, reg: 62.856941, reg_best: 62.856941
step:  82, cost: 2.26E-02, attack: 0.980, loss: 1.730440, ce: 0.325516, reg: 62.089485, reg_best: 62.856941
step:  83, cost: 2.26E-02, attack: 0.983, loss: 1.676144, ce: 0.267009, reg: 62.275562, reg_best: 62.856941
step:  84, cost: 2.26E-02, attack: 0.982, loss: 1.676662, ce: 0.299730, reg: 60.852394, reg_best: 62.856941
step:  85, cost: 2.26E-02, attack: 0.984, loss: 1.593461, ce: 0.236135, reg: 59.985928, reg_best: 62.856941
step:  86, cost: 2.26E-02, attack: 0.991, loss: 1.554822, ce: 0.152808, reg: 61.960884, reg_best: 61.960884
step:  87, cost: 2.26E-02, attack: 0.984, loss: 1.604212, ce: 0.258781, reg: 59.460201, reg_best: 61.960884
step:  88, cost: 2.26E-02, attack: 0.984, loss: 1.734101, ce: 0.261330, reg: 65.087914, reg_best: 61.960884
step:  89, cost: 2.26E-02, attack: 0.992, loss: 1.618914, ce: 0.137456, reg: 65.471832, reg_best: 61.960884
step:  90, cost: 2.26E-02, attack: 0.982, loss: 1.705930, ce: 0.312867, reg: 61.565281, reg_best: 61.960884
step:  91, cost: 2.26E-02, attack: 0.985, loss: 1.663217, ce: 0.252012, reg: 62.367039, reg_best: 61.960884
step:  92, cost: 2.26E-02, attack: 0.985, loss: 1.621030, ce: 0.234852, reg: 61.261013, reg_best: 61.960884
step:  93, cost: 2.26E-02, attack: 0.983, loss: 1.620358, ce: 0.259078, reg: 60.159447, reg_best: 61.960884
step:  94, cost: 2.26E-02, attack: 0.982, loss: 1.673465, ce: 0.318754, reg: 59.870323, reg_best: 61.960884
down cost from 2.26E-02 to 8.00E-03
step:  95, cost: 8.00E-03, attack: 0.993, loss: 0.625873, ce: 0.120964, reg: 63.113651, reg_best: 61.960884
step:  96, cost: 8.00E-03, attack: 0.990, loss: 0.678241, ce: 0.153410, reg: 65.603905, reg_best: 61.960884
step:  97, cost: 8.00E-03, attack: 0.995, loss: 0.604990, ce: 0.085110, reg: 64.985062, reg_best: 61.960884
step:  98, cost: 8.00E-03, attack: 0.990, loss: 0.669532, ce: 0.151720, reg: 64.726402, reg_best: 61.960884
step:  99, cost: 8.00E-03, attack: 0.994, loss: 0.634752, ce: 0.098286, reg: 67.058250, reg_best: 61.960884
pattern, shape: (32, 32, 3), min: 0.000008, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 9: 58.942207
visualization cost 20.253423 seconds
processing label 10
resetting state
mask_tanh -4.317188044440259 3.5526349684717866
pattern_tanh -3.7299266699623517 3.8922315063221555
step:   0, cost: 0.00E+00, attack: 0.847, loss: 2.545005, ce: 2.545005, reg: 552.931274, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000775, ce: 0.000775, reg: 576.916382, reg_best: 576.916382
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 578.591309, reg_best: 576.916382
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000189, ce: 0.000189, reg: 582.931030, reg_best: 576.916382
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 584.442078, reg_best: 576.916382
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 585.607727, reg_best: 576.916382
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.995, loss: 0.442538, ce: 0.083443, reg: 359.094421, reg_best: 359.094421
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.268727, ce: 0.016606, reg: 252.120911, reg_best: 252.120911
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.188746, ce: 0.006935, reg: 181.811142, reg_best: 181.811142
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.183512, ce: 0.029258, reg: 154.254593, reg_best: 154.254593
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.997, loss: 0.303504, ce: 0.050807, reg: 126.348114, reg_best: 126.348114
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.251224, ce: 0.031503, reg: 109.860588, reg_best: 109.860588
step:  12, cost: 2.00E-03, attack: 0.997, loss: 0.257885, ce: 0.050393, reg: 103.746323, reg_best: 103.746323
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.219716, ce: 0.013177, reg: 103.269798, reg_best: 103.269798
step:  14, cost: 2.00E-03, attack: 0.997, loss: 0.237382, ce: 0.047127, reg: 95.127235, reg_best: 95.127235
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.997, loss: 0.419979, ce: 0.052935, reg: 91.761093, reg_best: 91.761093
step:  16, cost: 4.00E-03, attack: 0.999, loss: 0.369912, ce: 0.011607, reg: 89.576096, reg_best: 89.576096
step:  17, cost: 4.00E-03, attack: 0.996, loss: 0.387875, ce: 0.071872, reg: 79.000832, reg_best: 79.000832
step:  18, cost: 4.00E-03, attack: 0.993, loss: 0.423725, ce: 0.112167, reg: 77.914459, reg_best: 77.914459
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.335791, ce: 0.022983, reg: 78.202179, reg_best: 77.914459
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.997, loss: 0.659241, ce: 0.066914, reg: 74.040871, reg_best: 74.040871
step:  21, cost: 8.00E-03, attack: 0.998, loss: 0.627100, ce: 0.033859, reg: 74.155174, reg_best: 74.040871
step:  22, cost: 8.00E-03, attack: 0.996, loss: 0.649409, ce: 0.062757, reg: 73.331520, reg_best: 73.331520
step:  23, cost: 8.00E-03, attack: 0.998, loss: 0.646153, ce: 0.027532, reg: 77.327621, reg_best: 73.331520
step:  24, cost: 8.00E-03, attack: 0.992, loss: 0.700281, ce: 0.136047, reg: 70.529274, reg_best: 70.529274
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.993, loss: 1.229229, ce: 0.122386, reg: 69.177673, reg_best: 69.177673
step:  26, cost: 1.60E-02, attack: 0.995, loss: 1.184885, ce: 0.093899, reg: 68.186630, reg_best: 68.186630
step:  27, cost: 1.60E-02, attack: 0.996, loss: 1.138728, ce: 0.075026, reg: 66.481369, reg_best: 66.481369
step:  28, cost: 1.60E-02, attack: 0.998, loss: 1.113506, ce: 0.058120, reg: 65.961647, reg_best: 65.961647
step:  29, cost: 1.60E-02, attack: 0.989, loss: 1.207235, ce: 0.181621, reg: 64.100822, reg_best: 65.961647
step:  30, cost: 1.60E-02, attack: 0.993, loss: 1.138173, ce: 0.138767, reg: 62.462906, reg_best: 62.462906
step:  31, cost: 1.60E-02, attack: 0.993, loss: 1.134867, ce: 0.111852, reg: 63.918617, reg_best: 62.462906
step:  32, cost: 1.60E-02, attack: 0.987, loss: 1.202246, ce: 0.209467, reg: 62.048687, reg_best: 62.462906
step:  33, cost: 1.60E-02, attack: 0.992, loss: 1.163421, ce: 0.131038, reg: 64.523895, reg_best: 62.462906
step:  34, cost: 1.60E-02, attack: 0.998, loss: 1.096510, ce: 0.040103, reg: 66.025452, reg_best: 62.462906
step:  35, cost: 1.60E-02, attack: 0.987, loss: 1.182618, ce: 0.224486, reg: 59.883282, reg_best: 62.462906
step:  36, cost: 1.60E-02, attack: 0.994, loss: 1.159055, ce: 0.119155, reg: 64.993744, reg_best: 62.462906
step:  37, cost: 1.60E-02, attack: 0.996, loss: 1.112702, ce: 0.067453, reg: 65.328110, reg_best: 62.462906
step:  38, cost: 1.60E-02, attack: 0.996, loss: 1.094019, ce: 0.075947, reg: 63.629467, reg_best: 62.462906
step:  39, cost: 1.60E-02, attack: 0.993, loss: 1.128240, ce: 0.102922, reg: 64.082336, reg_best: 62.462906
step:  40, cost: 1.60E-02, attack: 0.994, loss: 1.114799, ce: 0.111128, reg: 62.729401, reg_best: 62.462906
up cost from 1.60E-02 to 3.20E-02
step:  41, cost: 3.20E-02, attack: 0.988, loss: 2.211050, ce: 0.199162, reg: 62.871502, reg_best: 62.462906
step:  42, cost: 3.20E-02, attack: 0.986, loss: 2.197685, ce: 0.238689, reg: 61.218632, reg_best: 62.462906
step:  43, cost: 3.20E-02, attack: 0.990, loss: 2.116187, ce: 0.171115, reg: 60.783501, reg_best: 62.462906
step:  44, cost: 3.20E-02, attack: 0.991, loss: 2.120957, ce: 0.179628, reg: 60.655647, reg_best: 60.655647
step:  45, cost: 3.20E-02, attack: 0.995, loss: 2.004102, ce: 0.088370, reg: 59.866604, reg_best: 59.866604
step:  46, cost: 3.20E-02, attack: 0.986, loss: 2.164091, ce: 0.231036, reg: 60.407955, reg_best: 59.866604
step:  47, cost: 3.20E-02, attack: 0.991, loss: 2.064301, ce: 0.150170, reg: 59.816593, reg_best: 59.816593
step:  48, cost: 3.20E-02, attack: 0.989, loss: 2.101174, ce: 0.183133, reg: 59.938797, reg_best: 59.816593
step:  49, cost: 3.20E-02, attack: 0.985, loss: 2.145822, ce: 0.232987, reg: 59.776073, reg_best: 59.816593
step:  50, cost: 3.20E-02, attack: 0.989, loss: 2.033706, ce: 0.173722, reg: 58.124496, reg_best: 59.816593
step:  51, cost: 3.20E-02, attack: 0.974, loss: 2.193481, ce: 0.420148, reg: 55.416668, reg_best: 59.816593
step:  52, cost: 3.20E-02, attack: 0.982, loss: 2.211658, ce: 0.286178, reg: 60.171227, reg_best: 59.816593
down cost from 3.20E-02 to 1.13E-02
step:  53, cost: 1.13E-02, attack: 0.995, loss: 0.828082, ce: 0.082997, reg: 65.856850, reg_best: 59.816593
step:  54, cost: 1.13E-02, attack: 0.989, loss: 0.901516, ce: 0.181821, reg: 63.612720, reg_best: 59.816593
step:  55, cost: 1.13E-02, attack: 0.994, loss: 0.809431, ce: 0.102942, reg: 62.445412, reg_best: 59.816593
step:  56, cost: 1.13E-02, attack: 0.996, loss: 0.793891, ce: 0.061857, reg: 64.689598, reg_best: 59.816593
step:  57, cost: 1.13E-02, attack: 0.996, loss: 0.799485, ce: 0.082287, reg: 63.391937, reg_best: 59.816593
step:  58, cost: 1.13E-02, attack: 0.992, loss: 0.818529, ce: 0.114477, reg: 62.229965, reg_best: 59.816593
step:  59, cost: 1.13E-02, attack: 0.994, loss: 0.844932, ce: 0.094414, reg: 66.336990, reg_best: 59.816593
up cost from 1.13E-02 to 2.26E-02
step:  60, cost: 2.26E-02, attack: 0.991, loss: 1.523006, ce: 0.154690, reg: 60.471588, reg_best: 59.816593
step:  61, cost: 2.26E-02, attack: 0.994, loss: 1.496614, ce: 0.117722, reg: 60.938972, reg_best: 59.816593
step:  62, cost: 2.26E-02, attack: 0.990, loss: 1.532059, ce: 0.149987, reg: 61.079525, reg_best: 59.816593
step:  63, cost: 2.26E-02, attack: 0.988, loss: 1.601189, ce: 0.204857, reg: 61.709740, reg_best: 59.816593
step:  64, cost: 2.26E-02, attack: 0.993, loss: 1.504775, ce: 0.122251, reg: 61.099503, reg_best: 59.816593
step:  65, cost: 2.26E-02, attack: 0.998, loss: 1.495152, ce: 0.057184, reg: 63.549805, reg_best: 59.816593
step:  66, cost: 2.26E-02, attack: 0.998, loss: 1.464399, ce: 0.050666, reg: 62.478764, reg_best: 59.816593
step:  67, cost: 2.26E-02, attack: 0.986, loss: 1.574374, ce: 0.206413, reg: 60.455894, reg_best: 59.816593
step:  68, cost: 2.26E-02, attack: 0.992, loss: 1.510884, ce: 0.138923, reg: 60.632679, reg_best: 59.816593
step:  69, cost: 2.26E-02, attack: 0.991, loss: 1.511265, ce: 0.160323, reg: 59.707912, reg_best: 59.707912
step:  70, cost: 2.26E-02, attack: 0.995, loss: 1.507280, ce: 0.092103, reg: 62.542583, reg_best: 59.707912
step:  71, cost: 2.26E-02, attack: 0.987, loss: 1.532876, ce: 0.199579, reg: 58.923977, reg_best: 59.707912
step:  72, cost: 2.26E-02, attack: 0.990, loss: 1.528611, ce: 0.147144, reg: 61.052780, reg_best: 59.707912
step:  73, cost: 2.26E-02, attack: 0.993, loss: 1.492151, ce: 0.109759, reg: 61.093655, reg_best: 59.707912
step:  74, cost: 2.26E-02, attack: 0.986, loss: 1.584901, ce: 0.235627, reg: 59.630054, reg_best: 59.707912
step:  75, cost: 2.26E-02, attack: 0.993, loss: 1.489310, ce: 0.121522, reg: 60.448223, reg_best: 59.707912
step:  76, cost: 2.26E-02, attack: 0.986, loss: 1.568432, ce: 0.224518, reg: 59.393162, reg_best: 59.707912
step:  77, cost: 2.26E-02, attack: 0.993, loss: 1.536651, ce: 0.115631, reg: 62.800781, reg_best: 59.707912
step:  78, cost: 2.26E-02, attack: 0.988, loss: 1.573635, ce: 0.183166, reg: 61.450638, reg_best: 59.707912
step:  79, cost: 2.26E-02, attack: 0.990, loss: 1.566743, ce: 0.164906, reg: 61.953022, reg_best: 59.707912
step:  80, cost: 2.26E-02, attack: 0.988, loss: 1.546451, ce: 0.188368, reg: 60.019371, reg_best: 59.707912
step:  81, cost: 2.26E-02, attack: 0.994, loss: 1.539455, ce: 0.096636, reg: 63.764206, reg_best: 59.707912
step:  82, cost: 2.26E-02, attack: 0.995, loss: 1.509797, ce: 0.085500, reg: 62.945473, reg_best: 59.707912
step:  83, cost: 2.26E-02, attack: 0.993, loss: 1.496569, ce: 0.118679, reg: 60.894730, reg_best: 59.707912
step:  84, cost: 2.26E-02, attack: 0.979, loss: 1.652915, ce: 0.347725, reg: 57.681793, reg_best: 59.707912
step:  85, cost: 2.26E-02, attack: 0.990, loss: 1.511333, ce: 0.171012, reg: 59.234390, reg_best: 59.707912
step:  86, cost: 2.26E-02, attack: 0.989, loss: 1.542730, ce: 0.180820, reg: 60.188496, reg_best: 59.707912
step:  87, cost: 2.26E-02, attack: 0.990, loss: 1.566412, ce: 0.158994, reg: 62.199688, reg_best: 59.707912
step:  88, cost: 2.26E-02, attack: 0.989, loss: 1.535453, ce: 0.183705, reg: 59.739357, reg_best: 59.707912
down cost from 2.26E-02 to 8.00E-03
step:  89, cost: 8.00E-03, attack: 0.992, loss: 0.618392, ce: 0.122678, reg: 61.964165, reg_best: 59.707912
step:  90, cost: 8.00E-03, attack: 0.998, loss: 0.554744, ce: 0.039112, reg: 64.453949, reg_best: 59.707912
step:  91, cost: 8.00E-03, attack: 0.995, loss: 0.591067, ce: 0.083314, reg: 63.469048, reg_best: 59.707912
step:  92, cost: 8.00E-03, attack: 0.996, loss: 0.598022, ce: 0.083470, reg: 64.319031, reg_best: 59.707912
step:  93, cost: 8.00E-03, attack: 0.993, loss: 0.618039, ce: 0.115935, reg: 62.763069, reg_best: 59.707912
up cost from 8.00E-03 to 1.60E-02
step:  94, cost: 1.60E-02, attack: 0.995, loss: 1.104694, ce: 0.112802, reg: 62.007896, reg_best: 59.707912
early stop
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 10: 63.534760
visualization cost 19.101250 seconds
processing label 11
resetting state
mask_tanh -3.1262554829533187 3.7536350673211123
pattern_tanh -4.267345516743972 5.184510245577849
step:   0, cost: 0.00E+00, attack: 0.864, loss: 2.246742, ce: 2.246742, reg: 542.957031, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000188, ce: 0.000188, reg: 557.429810, reg_best: 557.429810
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000016, ce: 0.000016, reg: 558.510437, reg_best: 557.429810
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000009, ce: 0.000009, reg: 559.170410, reg_best: 557.429810
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 559.485474, reg_best: 557.429810
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 560.070190, reg_best: 557.429810
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.998, loss: 0.393962, ce: 0.027502, reg: 366.459839, reg_best: 366.459839
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.267659, ce: 0.031468, reg: 236.190353, reg_best: 236.190353
step:   8, cost: 1.00E-03, attack: 0.998, loss: 0.197256, ce: 0.034400, reg: 162.855484, reg_best: 162.855484
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.155241, ce: 0.031794, reg: 123.446632, reg_best: 123.446632
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.222721, ce: 0.017739, reg: 102.491013, reg_best: 102.491013
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.202862, ce: 0.018557, reg: 92.152168, reg_best: 92.152168
step:  12, cost: 2.00E-03, attack: 1.000, loss: 0.183865, ce: 0.009389, reg: 87.200661, reg_best: 87.200661
step:  13, cost: 2.00E-03, attack: 1.000, loss: 0.167835, ce: 0.000502, reg: 83.666504, reg_best: 83.666504
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.182295, ce: 0.031038, reg: 75.628525, reg_best: 75.628525
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.998, loss: 0.324623, ce: 0.032019, reg: 73.151070, reg_best: 73.151070
step:  16, cost: 4.00E-03, attack: 0.995, loss: 0.351321, ce: 0.073869, reg: 69.362877, reg_best: 69.362877
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.299020, ce: 0.013448, reg: 71.393158, reg_best: 69.362877
step:  18, cost: 4.00E-03, attack: 0.996, loss: 0.323166, ce: 0.062736, reg: 65.107605, reg_best: 65.107605
step:  19, cost: 4.00E-03, attack: 0.997, loss: 0.312813, ce: 0.055646, reg: 64.291786, reg_best: 64.291786
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.997, loss: 0.563658, ce: 0.055226, reg: 63.553951, reg_best: 63.553951
step:  21, cost: 8.00E-03, attack: 0.995, loss: 0.546690, ce: 0.071039, reg: 59.456299, reg_best: 59.456299
step:  22, cost: 8.00E-03, attack: 0.996, loss: 0.539107, ce: 0.066390, reg: 59.089695, reg_best: 59.089695
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.549651, ce: 0.081949, reg: 58.462646, reg_best: 58.462646
step:  24, cost: 8.00E-03, attack: 0.997, loss: 0.511056, ce: 0.047485, reg: 57.946266, reg_best: 57.946266
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.998, loss: 0.935762, ce: 0.026214, reg: 56.857918, reg_best: 56.857918
step:  26, cost: 1.60E-02, attack: 0.996, loss: 0.952727, ce: 0.069887, reg: 55.177475, reg_best: 55.177475
step:  27, cost: 1.60E-02, attack: 0.994, loss: 0.950063, ce: 0.093099, reg: 53.560246, reg_best: 53.560246
step:  28, cost: 1.60E-02, attack: 0.988, loss: 1.029059, ce: 0.177582, reg: 53.217323, reg_best: 53.560246
step:  29, cost: 1.60E-02, attack: 0.990, loss: 0.982355, ce: 0.160399, reg: 51.372246, reg_best: 53.560246
step:  30, cost: 1.60E-02, attack: 0.995, loss: 0.879086, ce: 0.070634, reg: 50.528236, reg_best: 50.528236
step:  31, cost: 1.60E-02, attack: 0.996, loss: 0.918524, ce: 0.068775, reg: 53.109329, reg_best: 50.528236
step:  32, cost: 1.60E-02, attack: 0.997, loss: 0.874172, ce: 0.067825, reg: 50.396713, reg_best: 50.396713
step:  33, cost: 1.60E-02, attack: 0.984, loss: 1.023409, ce: 0.249155, reg: 48.390900, reg_best: 50.396713
step:  34, cost: 1.60E-02, attack: 0.993, loss: 0.964215, ce: 0.120452, reg: 52.735199, reg_best: 50.396713
step:  35, cost: 1.60E-02, attack: 0.994, loss: 0.944582, ce: 0.106778, reg: 52.362766, reg_best: 50.396713
step:  36, cost: 1.60E-02, attack: 0.994, loss: 0.934356, ce: 0.111941, reg: 51.400902, reg_best: 50.396713
step:  37, cost: 1.60E-02, attack: 0.991, loss: 0.965325, ce: 0.147488, reg: 51.114819, reg_best: 50.396713
step:  38, cost: 1.60E-02, attack: 0.995, loss: 0.892259, ce: 0.088983, reg: 50.215603, reg_best: 50.215603
up cost from 1.60E-02 to 3.20E-02
step:  39, cost: 3.20E-02, attack: 0.989, loss: 1.698170, ce: 0.184924, reg: 47.288929, reg_best: 50.215603
step:  40, cost: 3.20E-02, attack: 0.973, loss: 1.831271, ce: 0.449852, reg: 43.169334, reg_best: 50.215603
step:  41, cost: 3.20E-02, attack: 0.990, loss: 1.659205, ce: 0.185048, reg: 46.067402, reg_best: 50.215603
step:  42, cost: 3.20E-02, attack: 0.986, loss: 1.700299, ce: 0.204853, reg: 46.732670, reg_best: 50.215603
step:  43, cost: 3.20E-02, attack: 0.993, loss: 1.699793, ce: 0.132692, reg: 48.971889, reg_best: 48.971889
step:  44, cost: 3.20E-02, attack: 0.989, loss: 1.676072, ce: 0.204590, reg: 45.983814, reg_best: 48.971889
step:  45, cost: 3.20E-02, attack: 0.994, loss: 1.590856, ce: 0.108137, reg: 46.334976, reg_best: 46.334976
step:  46, cost: 3.20E-02, attack: 0.991, loss: 1.653253, ce: 0.150680, reg: 46.955379, reg_best: 46.334976
step:  47, cost: 3.20E-02, attack: 0.992, loss: 1.665447, ce: 0.134536, reg: 47.840977, reg_best: 46.334976
step:  48, cost: 3.20E-02, attack: 0.993, loss: 1.653888, ce: 0.139937, reg: 47.310966, reg_best: 46.334976
step:  49, cost: 3.20E-02, attack: 0.985, loss: 1.742048, ce: 0.247046, reg: 46.718819, reg_best: 46.334976
step:  50, cost: 3.20E-02, attack: 0.973, loss: 1.819385, ce: 0.437071, reg: 43.215931, reg_best: 46.334976
step:  51, cost: 3.20E-02, attack: 0.993, loss: 1.634346, ce: 0.148919, reg: 46.419598, reg_best: 46.334976
step:  52, cost: 3.20E-02, attack: 0.979, loss: 1.774560, ce: 0.355251, reg: 44.353397, reg_best: 46.334976
step:  53, cost: 3.20E-02, attack: 0.983, loss: 1.697246, ce: 0.267831, reg: 44.669224, reg_best: 46.334976
step:  54, cost: 3.20E-02, attack: 0.979, loss: 1.757490, ce: 0.351032, reg: 43.951828, reg_best: 46.334976
step:  55, cost: 3.20E-02, attack: 0.990, loss: 1.632231, ce: 0.178769, reg: 45.420677, reg_best: 46.334976
step:  56, cost: 3.20E-02, attack: 0.992, loss: 1.681066, ce: 0.133307, reg: 48.367474, reg_best: 46.334976
step:  57, cost: 3.20E-02, attack: 0.989, loss: 1.642246, ce: 0.163232, reg: 46.219196, reg_best: 46.334976
step:  58, cost: 3.20E-02, attack: 0.981, loss: 1.720351, ce: 0.311727, reg: 44.019489, reg_best: 46.334976
step:  59, cost: 3.20E-02, attack: 0.988, loss: 1.661693, ce: 0.218611, reg: 45.096329, reg_best: 46.334976
step:  60, cost: 3.20E-02, attack: 0.996, loss: 1.577293, ce: 0.088053, reg: 46.538773, reg_best: 46.334976
step:  61, cost: 3.20E-02, attack: 0.988, loss: 1.646658, ce: 0.190833, reg: 45.494537, reg_best: 46.334976
step:  62, cost: 3.20E-02, attack: 0.987, loss: 1.648837, ce: 0.227740, reg: 44.409256, reg_best: 46.334976
step:  63, cost: 3.20E-02, attack: 0.983, loss: 1.647650, ce: 0.280599, reg: 42.721214, reg_best: 46.334976
step:  64, cost: 3.20E-02, attack: 0.976, loss: 1.746235, ce: 0.389484, reg: 42.398479, reg_best: 46.334976
step:  65, cost: 3.20E-02, attack: 0.992, loss: 1.613360, ce: 0.129882, reg: 46.358700, reg_best: 46.334976
step:  66, cost: 3.20E-02, attack: 0.991, loss: 1.640911, ce: 0.183280, reg: 45.550995, reg_best: 45.550995
step:  67, cost: 3.20E-02, attack: 0.993, loss: 1.646064, ce: 0.136437, reg: 47.175869, reg_best: 45.550995
step:  68, cost: 3.20E-02, attack: 0.977, loss: 1.744100, ce: 0.380375, reg: 42.616402, reg_best: 45.550995
step:  69, cost: 3.20E-02, attack: 0.992, loss: 1.621213, ce: 0.130105, reg: 46.597126, reg_best: 45.550995
step:  70, cost: 3.20E-02, attack: 0.989, loss: 1.651395, ce: 0.189351, reg: 45.688892, reg_best: 45.550995
step:  71, cost: 3.20E-02, attack: 0.991, loss: 1.583243, ce: 0.156199, reg: 44.595123, reg_best: 44.595123
step:  72, cost: 3.20E-02, attack: 0.986, loss: 1.698040, ce: 0.214944, reg: 46.346748, reg_best: 44.595123
step:  73, cost: 3.20E-02, attack: 0.993, loss: 1.585835, ce: 0.124655, reg: 45.661873, reg_best: 44.595123
step:  74, cost: 3.20E-02, attack: 0.986, loss: 1.655208, ce: 0.236372, reg: 44.338615, reg_best: 44.595123
step:  75, cost: 3.20E-02, attack: 0.984, loss: 1.669639, ce: 0.253337, reg: 44.259415, reg_best: 44.595123
step:  76, cost: 3.20E-02, attack: 0.984, loss: 1.649810, ce: 0.270263, reg: 43.109596, reg_best: 44.595123
step:  77, cost: 3.20E-02, attack: 0.971, loss: 1.761894, ce: 0.464253, reg: 40.551300, reg_best: 44.595123
step:  78, cost: 3.20E-02, attack: 0.987, loss: 1.628854, ce: 0.225545, reg: 43.853401, reg_best: 44.595123
down cost from 3.20E-02 to 1.13E-02
step:  79, cost: 1.13E-02, attack: 0.993, loss: 0.621010, ce: 0.129117, reg: 43.477596, reg_best: 43.477596
step:  80, cost: 1.13E-02, attack: 0.991, loss: 0.674169, ce: 0.152072, reg: 46.147266, reg_best: 43.477596
step:  81, cost: 1.13E-02, attack: 0.997, loss: 0.609996, ce: 0.060578, reg: 48.562138, reg_best: 43.477596
step:  82, cost: 1.13E-02, attack: 0.993, loss: 0.655555, ce: 0.111539, reg: 48.084610, reg_best: 43.477596
step:  83, cost: 1.13E-02, attack: 0.994, loss: 0.652268, ce: 0.103453, reg: 48.508869, reg_best: 43.477596
up cost from 1.13E-02 to 2.26E-02
step:  84, cost: 2.26E-02, attack: 0.998, loss: 1.180673, ce: 0.047684, reg: 50.071522, reg_best: 43.477596
step:  85, cost: 2.26E-02, attack: 0.988, loss: 1.268224, ce: 0.199923, reg: 47.212685, reg_best: 43.477596
step:  86, cost: 2.26E-02, attack: 0.991, loss: 1.187587, ce: 0.150118, reg: 45.850105, reg_best: 43.477596
step:  87, cost: 2.26E-02, attack: 0.996, loss: 1.115738, ce: 0.076608, reg: 45.923492, reg_best: 43.477596
step:  88, cost: 2.26E-02, attack: 0.986, loss: 1.221463, ce: 0.217363, reg: 44.375366, reg_best: 43.477596
step:  89, cost: 2.26E-02, attack: 0.994, loss: 1.153621, ce: 0.112376, reg: 46.023773, reg_best: 43.477596
step:  90, cost: 2.26E-02, attack: 0.989, loss: 1.205924, ce: 0.167570, reg: 45.889214, reg_best: 43.477596
step:  91, cost: 2.26E-02, attack: 0.992, loss: 1.161426, ce: 0.149459, reg: 44.723045, reg_best: 43.477596
step:  92, cost: 2.26E-02, attack: 0.993, loss: 1.157013, ce: 0.127227, reg: 45.510548, reg_best: 43.477596
step:  93, cost: 2.26E-02, attack: 0.995, loss: 1.128829, ce: 0.091343, reg: 45.850796, reg_best: 43.477596
step:  94, cost: 2.26E-02, attack: 0.988, loss: 1.232908, ce: 0.201612, reg: 45.577278, reg_best: 43.477596
step:  95, cost: 2.26E-02, attack: 0.986, loss: 1.226960, ce: 0.228937, reg: 44.106812, reg_best: 43.477596
step:  96, cost: 2.26E-02, attack: 0.995, loss: 1.117053, ce: 0.096210, reg: 45.115341, reg_best: 43.477596
step:  97, cost: 2.26E-02, attack: 0.994, loss: 1.139141, ce: 0.093095, reg: 46.229153, reg_best: 43.477596
step:  98, cost: 2.26E-02, attack: 0.990, loss: 1.202188, ce: 0.167433, reg: 45.730171, reg_best: 43.477596
step:  99, cost: 2.26E-02, attack: 0.995, loss: 1.159215, ce: 0.086042, reg: 47.427990, reg_best: 43.477596
pattern, shape: (32, 32, 3), min: 0.000008, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 11: 44.925949
visualization cost 22.005913 seconds
processing label 12
resetting state
mask_tanh -3.9859271678403903 3.709758785573506
pattern_tanh -3.636679619315721 3.497246223555598
step:   0, cost: 0.00E+00, attack: 0.892, loss: 1.846490, ce: 1.846490, reg: 545.213318, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000218, ce: 0.000218, reg: 557.783020, reg_best: 557.783020
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.006009, ce: 0.006009, reg: 561.074463, reg_best: 557.783020
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 572.407288, reg_best: 557.783020
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 572.554749, reg_best: 557.783020
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 572.668091, reg_best: 557.783020
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.999, loss: 0.421493, ce: 0.026426, reg: 395.066956, reg_best: 395.066956
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.314696, ce: 0.009015, reg: 305.680328, reg_best: 305.680328
step:   8, cost: 1.00E-03, attack: 0.998, loss: 0.276951, ce: 0.032166, reg: 244.784485, reg_best: 244.784485
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.213206, ce: 0.013304, reg: 199.902115, reg_best: 199.902115
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.350387, ce: 0.014719, reg: 167.834045, reg_best: 167.834045
step:  11, cost: 2.00E-03, attack: 0.996, loss: 0.372031, ce: 0.080474, reg: 145.778290, reg_best: 145.778290
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.306336, ce: 0.016321, reg: 145.007507, reg_best: 145.007507
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.280440, ce: 0.025885, reg: 127.277657, reg_best: 127.277657
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.254736, ce: 0.017910, reg: 118.367424, reg_best: 118.367424
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.998, loss: 0.461608, ce: 0.032767, reg: 107.210266, reg_best: 107.210266
step:  16, cost: 4.00E-03, attack: 1.000, loss: 0.424958, ce: 0.014152, reg: 102.701492, reg_best: 102.701492
step:  17, cost: 4.00E-03, attack: 0.998, loss: 0.442056, ce: 0.036985, reg: 101.267738, reg_best: 101.267738
step:  18, cost: 4.00E-03, attack: 0.997, loss: 0.427672, ce: 0.051799, reg: 93.968246, reg_best: 93.968246
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.403082, ce: 0.019033, reg: 96.012238, reg_best: 93.968246
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.990, loss: 0.838249, ce: 0.168088, reg: 83.770065, reg_best: 93.968246
step:  21, cost: 8.00E-03, attack: 0.998, loss: 0.741285, ce: 0.040897, reg: 87.548515, reg_best: 87.548515
step:  22, cost: 8.00E-03, attack: 0.994, loss: 0.738678, ce: 0.089499, reg: 81.147293, reg_best: 81.147293
step:  23, cost: 8.00E-03, attack: 0.996, loss: 0.704911, ce: 0.048753, reg: 82.019730, reg_best: 81.147293
step:  24, cost: 8.00E-03, attack: 0.993, loss: 0.746729, ce: 0.105760, reg: 80.121063, reg_best: 80.121063
step:  25, cost: 8.00E-03, attack: 0.997, loss: 0.673666, ce: 0.041859, reg: 78.975822, reg_best: 78.975822
up cost from 8.00E-03 to 1.60E-02
step:  26, cost: 1.60E-02, attack: 0.992, loss: 1.338681, ce: 0.151645, reg: 74.189781, reg_best: 74.189781
step:  27, cost: 1.60E-02, attack: 0.993, loss: 1.302864, ce: 0.134806, reg: 73.041061, reg_best: 73.041061
step:  28, cost: 1.60E-02, attack: 0.997, loss: 1.256502, ce: 0.065191, reg: 74.456940, reg_best: 73.041061
step:  29, cost: 1.60E-02, attack: 0.991, loss: 1.243644, ce: 0.146500, reg: 68.571487, reg_best: 68.571487
step:  30, cost: 1.60E-02, attack: 0.994, loss: 1.212753, ce: 0.103707, reg: 69.315369, reg_best: 68.571487
up cost from 1.60E-02 to 3.20E-02
step:  31, cost: 3.20E-02, attack: 0.987, loss: 2.312663, ce: 0.196240, reg: 66.138214, reg_best: 68.571487
step:  32, cost: 3.20E-02, attack: 0.990, loss: 2.231274, ce: 0.169338, reg: 64.435493, reg_best: 68.571487
step:  33, cost: 3.20E-02, attack: 0.979, loss: 2.399498, ce: 0.327835, reg: 64.739464, reg_best: 68.571487
step:  34, cost: 3.20E-02, attack: 0.992, loss: 2.237785, ce: 0.135029, reg: 65.711090, reg_best: 65.711090
step:  35, cost: 3.20E-02, attack: 0.995, loss: 2.193128, ce: 0.106716, reg: 65.200371, reg_best: 65.200371
step:  36, cost: 3.20E-02, attack: 0.984, loss: 2.215015, ce: 0.277636, reg: 60.543091, reg_best: 65.200371
step:  37, cost: 3.20E-02, attack: 0.977, loss: 2.361091, ce: 0.369954, reg: 62.223015, reg_best: 65.200371
step:  38, cost: 3.20E-02, attack: 0.980, loss: 2.299291, ce: 0.333686, reg: 61.425163, reg_best: 65.200371
step:  39, cost: 3.20E-02, attack: 0.989, loss: 2.204603, ce: 0.171460, reg: 63.535709, reg_best: 65.200371
step:  40, cost: 3.20E-02, attack: 0.993, loss: 2.164677, ce: 0.118610, reg: 63.967007, reg_best: 63.967007
step:  41, cost: 3.20E-02, attack: 0.985, loss: 2.217574, ce: 0.246458, reg: 61.597389, reg_best: 63.967007
step:  42, cost: 3.20E-02, attack: 0.983, loss: 2.197842, ce: 0.266151, reg: 60.365334, reg_best: 63.967007
step:  43, cost: 3.20E-02, attack: 0.988, loss: 2.220797, ce: 0.169541, reg: 64.101738, reg_best: 63.967007
step:  44, cost: 3.20E-02, attack: 0.989, loss: 2.225076, ce: 0.153134, reg: 64.748215, reg_best: 63.967007
step:  45, cost: 3.20E-02, attack: 0.993, loss: 2.204395, ce: 0.140166, reg: 64.507126, reg_best: 63.967007
step:  46, cost: 3.20E-02, attack: 0.987, loss: 2.222693, ce: 0.219036, reg: 62.614281, reg_best: 63.967007
step:  47, cost: 3.20E-02, attack: 0.996, loss: 2.060536, ce: 0.078192, reg: 61.948242, reg_best: 61.948242
step:  48, cost: 3.20E-02, attack: 0.986, loss: 2.236487, ce: 0.250641, reg: 62.057686, reg_best: 61.948242
step:  49, cost: 3.20E-02, attack: 0.998, loss: 2.192616, ce: 0.064261, reg: 66.511070, reg_best: 61.948242
step:  50, cost: 3.20E-02, attack: 0.988, loss: 2.222219, ce: 0.203352, reg: 63.089588, reg_best: 61.948242
step:  51, cost: 3.20E-02, attack: 0.986, loss: 2.230682, ce: 0.224851, reg: 62.682209, reg_best: 61.948242
step:  52, cost: 3.20E-02, attack: 0.989, loss: 2.211521, ce: 0.187753, reg: 63.247948, reg_best: 61.948242
step:  53, cost: 3.20E-02, attack: 0.984, loss: 2.203761, ce: 0.288844, reg: 59.841179, reg_best: 61.948242
step:  54, cost: 3.20E-02, attack: 0.990, loss: 2.195927, ce: 0.201875, reg: 62.314117, reg_best: 61.948242
down cost from 3.20E-02 to 1.13E-02
step:  55, cost: 1.13E-02, attack: 0.994, loss: 0.838230, ce: 0.102321, reg: 65.045845, reg_best: 61.948242
step:  56, cost: 1.13E-02, attack: 0.992, loss: 0.911765, ce: 0.145696, reg: 67.711517, reg_best: 61.948242
step:  57, cost: 1.13E-02, attack: 0.999, loss: 0.782459, ce: 0.017362, reg: 67.625595, reg_best: 61.948242
step:  58, cost: 1.13E-02, attack: 0.991, loss: 0.896834, ce: 0.159921, reg: 65.134483, reg_best: 61.948242
step:  59, cost: 1.13E-02, attack: 1.000, loss: 0.771018, ce: 0.014119, reg: 66.901093, reg_best: 61.948242
up cost from 1.13E-02 to 2.26E-02
step:  60, cost: 2.26E-02, attack: 0.992, loss: 1.566275, ce: 0.149460, reg: 62.614948, reg_best: 61.948242
step:  61, cost: 2.26E-02, attack: 0.989, loss: 1.611199, ce: 0.177905, reg: 63.343277, reg_best: 61.948242
step:  62, cost: 2.26E-02, attack: 0.989, loss: 1.615489, ce: 0.170996, reg: 63.838184, reg_best: 61.948242
step:  63, cost: 2.26E-02, attack: 0.991, loss: 1.610878, ce: 0.160403, reg: 64.102547, reg_best: 61.948242
step:  64, cost: 2.26E-02, attack: 0.991, loss: 1.584850, ce: 0.144377, reg: 63.660507, reg_best: 61.948242
step:  65, cost: 2.26E-02, attack: 0.992, loss: 1.619285, ce: 0.149649, reg: 64.960526, reg_best: 61.948242
step:  66, cost: 2.26E-02, attack: 0.992, loss: 1.593663, ce: 0.137491, reg: 64.354347, reg_best: 61.948242
step:  67, cost: 2.26E-02, attack: 0.990, loss: 1.608485, ce: 0.154676, reg: 64.249870, reg_best: 61.948242
step:  68, cost: 2.26E-02, attack: 0.991, loss: 1.557300, ce: 0.152080, reg: 62.102551, reg_best: 61.948242
step:  69, cost: 2.26E-02, attack: 0.987, loss: 1.624938, ce: 0.231113, reg: 61.598949, reg_best: 61.948242
step:  70, cost: 2.26E-02, attack: 0.994, loss: 1.556304, ce: 0.113793, reg: 63.750546, reg_best: 61.948242
step:  71, cost: 2.26E-02, attack: 0.988, loss: 1.586749, ce: 0.175366, reg: 62.374924, reg_best: 61.948242
step:  72, cost: 2.26E-02, attack: 0.986, loss: 1.557488, ce: 0.234758, reg: 58.456963, reg_best: 61.948242
early stop
pattern, shape: (32, 32, 3), min: 0.000000, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 12: 56.280785
visualization cost 14.785893 seconds
processing label 13
resetting state
mask_tanh -3.726115266709015 3.7330482888505547
pattern_tanh -3.721268595378163 3.177522926942593
step:   0, cost: 0.00E+00, attack: 0.895, loss: 1.744073, ce: 1.744073, reg: 542.557495, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000371, ce: 0.000371, reg: 560.537476, reg_best: 560.537476
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.001870, ce: 0.001870, reg: 566.683472, reg_best: 560.537476
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000108, ce: 0.000108, reg: 572.035706, reg_best: 560.537476
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 576.448730, reg_best: 560.537476
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 578.118347, reg_best: 560.537476
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.999, loss: 0.447833, ce: 0.047925, reg: 399.908447, reg_best: 399.908447
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.341238, ce: 0.037977, reg: 303.260986, reg_best: 303.260986
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.262434, ce: 0.022659, reg: 239.774765, reg_best: 239.774765
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.237128, ce: 0.035549, reg: 201.578644, reg_best: 201.578644
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.998, loss: 0.413822, ce: 0.028100, reg: 192.861389, reg_best: 192.861389
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.368757, ce: 0.019099, reg: 174.828812, reg_best: 174.828812
step:  12, cost: 2.00E-03, attack: 0.997, loss: 0.376190, ce: 0.055262, reg: 160.463943, reg_best: 160.463943
step:  13, cost: 2.00E-03, attack: 0.998, loss: 0.350812, ce: 0.040991, reg: 154.910309, reg_best: 154.910309
step:  14, cost: 2.00E-03, attack: 1.000, loss: 0.308939, ce: 0.004420, reg: 152.259354, reg_best: 152.259354
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.997, loss: 0.590376, ce: 0.057913, reg: 133.115646, reg_best: 133.115646
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.538760, ce: 0.038591, reg: 125.042252, reg_best: 125.042252
step:  17, cost: 4.00E-03, attack: 0.998, loss: 0.539018, ce: 0.050138, reg: 122.219864, reg_best: 122.219864
step:  18, cost: 4.00E-03, attack: 0.994, loss: 0.575681, ce: 0.104396, reg: 117.827698, reg_best: 117.827698
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.509350, ce: 0.044619, reg: 116.182877, reg_best: 116.182877
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.995, loss: 0.949383, ce: 0.079946, reg: 108.679695, reg_best: 108.679695
step:  21, cost: 8.00E-03, attack: 0.995, loss: 0.918865, ce: 0.096776, reg: 102.761116, reg_best: 102.761116
step:  22, cost: 8.00E-03, attack: 0.993, loss: 0.941083, ce: 0.111536, reg: 103.693283, reg_best: 102.761116
step:  23, cost: 8.00E-03, attack: 0.991, loss: 0.919892, ce: 0.133858, reg: 98.254143, reg_best: 98.254143
step:  24, cost: 8.00E-03, attack: 0.996, loss: 0.870102, ce: 0.084009, reg: 98.261528, reg_best: 98.254143
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.990, loss: 1.621360, ce: 0.158303, reg: 91.441093, reg_best: 98.254143
step:  26, cost: 1.60E-02, attack: 0.993, loss: 1.561610, ce: 0.135024, reg: 89.161606, reg_best: 89.161606
step:  27, cost: 1.60E-02, attack: 0.994, loss: 1.522718, ce: 0.100698, reg: 88.876251, reg_best: 88.876251
step:  28, cost: 1.60E-02, attack: 0.988, loss: 1.575125, ce: 0.190790, reg: 86.520889, reg_best: 88.876251
step:  29, cost: 1.60E-02, attack: 0.991, loss: 1.547224, ce: 0.151629, reg: 87.224686, reg_best: 87.224686
step:  30, cost: 1.60E-02, attack: 0.989, loss: 1.553121, ce: 0.157800, reg: 87.222549, reg_best: 87.224686
step:  31, cost: 1.60E-02, attack: 0.988, loss: 1.541636, ce: 0.196664, reg: 84.060783, reg_best: 87.224686
step:  32, cost: 1.60E-02, attack: 0.989, loss: 1.523748, ce: 0.198686, reg: 82.816322, reg_best: 87.224686
step:  33, cost: 1.60E-02, attack: 0.994, loss: 1.471985, ce: 0.119274, reg: 84.544426, reg_best: 84.544426
step:  34, cost: 1.60E-02, attack: 0.994, loss: 1.446758, ce: 0.108999, reg: 83.609901, reg_best: 83.609901
step:  35, cost: 1.60E-02, attack: 0.992, loss: 1.501327, ce: 0.146335, reg: 84.687012, reg_best: 83.609901
step:  36, cost: 1.60E-02, attack: 0.993, loss: 1.452792, ce: 0.113951, reg: 83.677536, reg_best: 83.609901
step:  37, cost: 1.60E-02, attack: 0.990, loss: 1.523839, ce: 0.151932, reg: 85.744225, reg_best: 83.609901
step:  38, cost: 1.60E-02, attack: 0.994, loss: 1.391217, ce: 0.112101, reg: 79.944733, reg_best: 79.944733
step:  39, cost: 1.60E-02, attack: 0.994, loss: 1.434911, ce: 0.123780, reg: 81.945717, reg_best: 79.944733
step:  40, cost: 1.60E-02, attack: 0.993, loss: 1.442880, ce: 0.144691, reg: 81.136826, reg_best: 79.944733
step:  41, cost: 1.60E-02, attack: 0.990, loss: 1.464131, ce: 0.175410, reg: 80.545021, reg_best: 79.944733
step:  42, cost: 1.60E-02, attack: 0.992, loss: 1.428926, ce: 0.134844, reg: 80.880112, reg_best: 79.944733
step:  43, cost: 1.60E-02, attack: 0.989, loss: 1.447228, ce: 0.176376, reg: 79.406151, reg_best: 79.944733
step:  44, cost: 1.60E-02, attack: 0.989, loss: 1.440378, ce: 0.182272, reg: 78.631607, reg_best: 79.944733
step:  45, cost: 1.60E-02, attack: 0.986, loss: 1.446275, ce: 0.218772, reg: 76.718933, reg_best: 79.944733
step:  46, cost: 1.60E-02, attack: 0.986, loss: 1.436499, ce: 0.203200, reg: 77.081238, reg_best: 79.944733
step:  47, cost: 1.60E-02, attack: 0.988, loss: 1.495578, ce: 0.214758, reg: 80.051270, reg_best: 79.944733
down cost from 1.60E-02 to 5.66E-03
step:  48, cost: 5.66E-03, attack: 0.997, loss: 0.540434, ce: 0.061818, reg: 84.608238, reg_best: 79.944733
step:  49, cost: 5.66E-03, attack: 0.998, loss: 0.529939, ce: 0.036862, reg: 87.164383, reg_best: 79.944733
step:  50, cost: 5.66E-03, attack: 0.994, loss: 0.586225, ce: 0.108755, reg: 84.405563, reg_best: 79.944733
step:  51, cost: 5.66E-03, attack: 0.992, loss: 0.597203, ce: 0.120667, reg: 84.240463, reg_best: 79.944733
step:  52, cost: 5.66E-03, attack: 0.998, loss: 0.513921, ce: 0.035143, reg: 84.636787, reg_best: 79.944733
up cost from 5.66E-03 to 1.13E-02
step:  53, cost: 1.13E-02, attack: 0.989, loss: 1.092938, ce: 0.193541, reg: 79.496201, reg_best: 79.944733
step:  54, cost: 1.13E-02, attack: 0.994, loss: 1.032800, ce: 0.103180, reg: 82.167526, reg_best: 79.944733
step:  55, cost: 1.13E-02, attack: 0.994, loss: 1.050535, ce: 0.103305, reg: 83.724113, reg_best: 79.944733
step:  56, cost: 1.13E-02, attack: 0.991, loss: 1.039013, ce: 0.140868, reg: 79.381744, reg_best: 79.381744
step:  57, cost: 1.13E-02, attack: 0.993, loss: 1.047088, ce: 0.132580, reg: 80.831894, reg_best: 79.381744
step:  58, cost: 1.13E-02, attack: 0.995, loss: 1.006460, ce: 0.090537, reg: 80.956856, reg_best: 79.381744
up cost from 1.13E-02 to 2.26E-02
step:  59, cost: 2.26E-02, attack: 0.987, loss: 2.002862, ce: 0.200121, reg: 79.670662, reg_best: 79.381744
step:  60, cost: 2.26E-02, attack: 0.982, loss: 2.071819, ce: 0.302369, reg: 78.199379, reg_best: 79.381744
step:  61, cost: 2.26E-02, attack: 0.995, loss: 1.803239, ce: 0.107325, reg: 74.949532, reg_best: 74.949532
step:  62, cost: 2.26E-02, attack: 0.990, loss: 1.942266, ce: 0.182207, reg: 77.784363, reg_best: 74.949532
step:  63, cost: 2.26E-02, attack: 0.984, loss: 1.980643, ce: 0.282087, reg: 75.066299, reg_best: 74.949532
step:  64, cost: 2.26E-02, attack: 0.990, loss: 1.917513, ce: 0.168177, reg: 77.310463, reg_best: 74.949532
step:  65, cost: 2.26E-02, attack: 0.995, loss: 1.845127, ce: 0.099102, reg: 77.164139, reg_best: 74.949532
step:  66, cost: 2.26E-02, attack: 0.982, loss: 2.019797, ce: 0.281924, reg: 76.803894, reg_best: 74.949532
step:  67, cost: 2.26E-02, attack: 0.989, loss: 1.967031, ce: 0.177285, reg: 79.096321, reg_best: 74.949532
step:  68, cost: 2.26E-02, attack: 0.985, loss: 1.980889, ce: 0.247530, reg: 76.604362, reg_best: 74.949532
step:  69, cost: 2.26E-02, attack: 0.993, loss: 1.885054, ce: 0.125477, reg: 77.764122, reg_best: 74.949532
step:  70, cost: 2.26E-02, attack: 0.990, loss: 1.883795, ce: 0.175112, reg: 75.513847, reg_best: 74.949532
step:  71, cost: 2.26E-02, attack: 0.982, loss: 2.087355, ce: 0.308913, reg: 78.596794, reg_best: 74.949532
step:  72, cost: 2.26E-02, attack: 0.993, loss: 1.845005, ce: 0.127555, reg: 75.901291, reg_best: 74.949532
step:  73, cost: 2.26E-02, attack: 0.994, loss: 1.855537, ce: 0.142602, reg: 75.701744, reg_best: 74.949532
step:  74, cost: 2.26E-02, attack: 0.988, loss: 1.884118, ce: 0.212914, reg: 73.857460, reg_best: 74.949532
step:  75, cost: 2.26E-02, attack: 0.979, loss: 2.005158, ce: 0.358637, reg: 72.766602, reg_best: 74.949532
step:  76, cost: 2.26E-02, attack: 0.993, loss: 1.874884, ce: 0.133140, reg: 76.974922, reg_best: 74.949532
step:  77, cost: 2.26E-02, attack: 0.985, loss: 1.958610, ce: 0.253569, reg: 75.352859, reg_best: 74.949532
step:  78, cost: 2.26E-02, attack: 0.983, loss: 1.983564, ce: 0.267218, reg: 75.852486, reg_best: 74.949532
step:  79, cost: 2.26E-02, attack: 0.993, loss: 1.934466, ce: 0.136255, reg: 79.470482, reg_best: 74.949532
step:  80, cost: 2.26E-02, attack: 0.989, loss: 1.952258, ce: 0.166114, reg: 78.937180, reg_best: 74.949532
step:  81, cost: 2.26E-02, attack: 0.979, loss: 2.025440, ce: 0.351133, reg: 73.970131, reg_best: 74.949532
step:  82, cost: 2.26E-02, attack: 0.991, loss: 1.911541, ce: 0.184741, reg: 76.314491, reg_best: 74.949532
step:  83, cost: 2.26E-02, attack: 0.988, loss: 1.926286, ce: 0.180428, reg: 77.156761, reg_best: 74.949532
step:  84, cost: 2.26E-02, attack: 0.984, loss: 1.975282, ce: 0.271875, reg: 75.280663, reg_best: 74.949532
step:  85, cost: 2.26E-02, attack: 0.990, loss: 1.898234, ce: 0.153983, reg: 77.085732, reg_best: 74.949532
step:  86, cost: 2.26E-02, attack: 0.990, loss: 1.891471, ce: 0.177022, reg: 75.768631, reg_best: 74.949532
early stop
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 13: 76.308640
visualization cost 17.515475 seconds
processing label 14
resetting state
mask_tanh -4.946720365233252 3.3687844622080347
pattern_tanh -5.166714665099192 5.323425100580071
step:   0, cost: 0.00E+00, attack: 0.886, loss: 1.884371, ce: 1.884371, reg: 523.822937, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000004, ce: 0.000004, reg: 549.304626, reg_best: 549.304626
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000025, ce: 0.000025, reg: 549.782532, reg_best: 549.304626
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000005, ce: 0.000005, reg: 551.420349, reg_best: 549.304626
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000008, ce: 0.000008, reg: 554.173706, reg_best: 549.304626
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 555.643188, reg_best: 549.304626
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.994, loss: 0.478524, ce: 0.090775, reg: 387.748322, reg_best: 387.748322
step:   7, cost: 1.00E-03, attack: 0.997, loss: 0.323078, ce: 0.046232, reg: 276.802063, reg_best: 276.802063
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.243506, ce: 0.003506, reg: 240.000641, reg_best: 240.000641
step:   9, cost: 1.00E-03, attack: 1.000, loss: 0.212173, ce: 0.007530, reg: 204.643127, reg_best: 204.643127
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.998, loss: 0.392473, ce: 0.032917, reg: 179.777664, reg_best: 179.777664
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.350038, ce: 0.016378, reg: 166.830368, reg_best: 166.830368
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.327587, ce: 0.023200, reg: 152.193741, reg_best: 152.193741
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.324899, ce: 0.029481, reg: 147.708923, reg_best: 147.708923
step:  14, cost: 2.00E-03, attack: 0.996, loss: 0.339646, ce: 0.057557, reg: 141.044693, reg_best: 141.044693
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.999, loss: 0.583102, ce: 0.027821, reg: 138.820312, reg_best: 138.820312
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.568675, ce: 0.041069, reg: 131.901382, reg_best: 131.901382
step:  17, cost: 4.00E-03, attack: 0.996, loss: 0.558602, ce: 0.057361, reg: 125.310089, reg_best: 125.310089
step:  18, cost: 4.00E-03, attack: 0.995, loss: 0.572736, ce: 0.088775, reg: 120.990028, reg_best: 120.990028
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.534638, ce: 0.028620, reg: 126.504555, reg_best: 120.990028
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.995, loss: 0.989186, ce: 0.081220, reg: 113.510765, reg_best: 113.510765
step:  21, cost: 8.00E-03, attack: 0.994, loss: 0.966512, ce: 0.088850, reg: 109.707794, reg_best: 109.707794
step:  22, cost: 8.00E-03, attack: 0.993, loss: 0.948854, ce: 0.110792, reg: 104.757713, reg_best: 104.757713
step:  23, cost: 8.00E-03, attack: 0.994, loss: 0.926263, ce: 0.094648, reg: 103.951920, reg_best: 103.951920
step:  24, cost: 8.00E-03, attack: 0.992, loss: 0.924585, ce: 0.118419, reg: 100.770866, reg_best: 100.770866
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.997, loss: 1.689738, ce: 0.087971, reg: 100.110413, reg_best: 100.110413
step:  26, cost: 1.60E-02, attack: 0.994, loss: 1.652392, ce: 0.116549, reg: 95.990196, reg_best: 95.990196
step:  27, cost: 1.60E-02, attack: 0.992, loss: 1.676796, ce: 0.163660, reg: 94.570984, reg_best: 94.570984
step:  28, cost: 1.60E-02, attack: 0.988, loss: 1.707741, ce: 0.186444, reg: 95.081085, reg_best: 94.570984
step:  29, cost: 1.60E-02, attack: 0.990, loss: 1.702324, ce: 0.161915, reg: 96.275589, reg_best: 94.570984
step:  30, cost: 1.60E-02, attack: 0.987, loss: 1.673715, ce: 0.218990, reg: 90.920334, reg_best: 94.570984
step:  31, cost: 1.60E-02, attack: 0.989, loss: 1.638014, ce: 0.183469, reg: 90.909096, reg_best: 94.570984
step:  32, cost: 1.60E-02, attack: 0.990, loss: 1.643962, ce: 0.189381, reg: 90.911308, reg_best: 94.570984
down cost from 1.60E-02 to 5.66E-03
step:  33, cost: 5.66E-03, attack: 0.997, loss: 0.592967, ce: 0.067317, reg: 92.914856, reg_best: 92.914856
step:  34, cost: 5.66E-03, attack: 0.993, loss: 0.637814, ce: 0.105318, reg: 94.133026, reg_best: 92.914856
step:  35, cost: 5.66E-03, attack: 0.995, loss: 0.631573, ce: 0.082764, reg: 97.016655, reg_best: 92.914856
step:  36, cost: 5.66E-03, attack: 0.995, loss: 0.603573, ce: 0.073521, reg: 93.700912, reg_best: 92.914856
step:  37, cost: 5.66E-03, attack: 0.996, loss: 0.600624, ce: 0.072261, reg: 93.402245, reg_best: 92.914856
up cost from 5.66E-03 to 1.13E-02
step:  38, cost: 1.13E-02, attack: 0.996, loss: 1.122441, ce: 0.081095, reg: 92.042877, reg_best: 92.042877
step:  39, cost: 1.13E-02, attack: 0.992, loss: 1.185213, ce: 0.150775, reg: 91.432243, reg_best: 91.432243
step:  40, cost: 1.13E-02, attack: 0.994, loss: 1.147191, ce: 0.104696, reg: 92.144379, reg_best: 91.432243
step:  41, cost: 1.13E-02, attack: 0.993, loss: 1.132870, ce: 0.115922, reg: 89.886360, reg_best: 89.886360
step:  42, cost: 1.13E-02, attack: 0.990, loss: 1.199747, ce: 0.190844, reg: 89.175270, reg_best: 89.886360
step:  43, cost: 1.13E-02, attack: 0.996, loss: 1.119098, ce: 0.069791, reg: 92.746475, reg_best: 89.886360
step:  44, cost: 1.13E-02, attack: 0.994, loss: 1.127155, ce: 0.109782, reg: 89.923943, reg_best: 89.886360
step:  45, cost: 1.13E-02, attack: 0.999, loss: 1.084437, ce: 0.040382, reg: 92.283676, reg_best: 89.886360
step:  46, cost: 1.13E-02, attack: 0.996, loss: 1.079885, ce: 0.086183, reg: 87.831680, reg_best: 87.831680
step:  47, cost: 1.13E-02, attack: 0.995, loss: 1.116108, ce: 0.076330, reg: 91.904251, reg_best: 87.831680
up cost from 1.13E-02 to 2.26E-02
step:  48, cost: 2.26E-02, attack: 0.983, loss: 2.174870, ce: 0.273874, reg: 84.012932, reg_best: 87.831680
step:  49, cost: 2.26E-02, attack: 0.987, loss: 2.070400, ce: 0.215718, reg: 81.966156, reg_best: 87.831680
step:  50, cost: 2.26E-02, attack: 0.986, loss: 2.139629, ce: 0.218204, reg: 84.915794, reg_best: 87.831680
step:  51, cost: 2.26E-02, attack: 0.985, loss: 2.109573, ce: 0.255437, reg: 81.942024, reg_best: 87.831680
step:  52, cost: 2.26E-02, attack: 0.986, loss: 2.095675, ce: 0.244944, reg: 81.791496, reg_best: 87.831680
down cost from 2.26E-02 to 8.00E-03
step:  53, cost: 8.00E-03, attack: 0.994, loss: 0.808802, ce: 0.103558, reg: 88.155487, reg_best: 87.831680
step:  54, cost: 8.00E-03, attack: 0.996, loss: 0.771736, ce: 0.054807, reg: 89.616135, reg_best: 87.831680
step:  55, cost: 8.00E-03, attack: 0.996, loss: 0.763681, ce: 0.061453, reg: 87.778549, reg_best: 87.778549
step:  56, cost: 8.00E-03, attack: 0.994, loss: 0.794245, ce: 0.098198, reg: 87.005875, reg_best: 87.005875
step:  57, cost: 8.00E-03, attack: 0.998, loss: 0.747688, ce: 0.055264, reg: 86.553078, reg_best: 86.553078
up cost from 8.00E-03 to 1.60E-02
step:  58, cost: 1.60E-02, attack: 0.993, loss: 1.453704, ce: 0.111088, reg: 83.891632, reg_best: 83.891632
step:  59, cost: 1.60E-02, attack: 0.988, loss: 1.534126, ce: 0.208712, reg: 82.838379, reg_best: 83.891632
step:  60, cost: 1.60E-02, attack: 0.992, loss: 1.484203, ce: 0.106413, reg: 86.111832, reg_best: 83.891632
step:  61, cost: 1.60E-02, attack: 0.990, loss: 1.520571, ce: 0.200825, reg: 82.484131, reg_best: 83.891632
step:  62, cost: 1.60E-02, attack: 0.992, loss: 1.483500, ce: 0.137598, reg: 84.118851, reg_best: 83.891632
step:  63, cost: 1.60E-02, attack: 0.988, loss: 1.478169, ce: 0.207198, reg: 79.435692, reg_best: 83.891632
step:  64, cost: 1.60E-02, attack: 0.987, loss: 1.504711, ce: 0.230870, reg: 79.615044, reg_best: 83.891632
step:  65, cost: 1.60E-02, attack: 0.996, loss: 1.438153, ce: 0.096297, reg: 83.866020, reg_best: 83.866020
step:  66, cost: 1.60E-02, attack: 0.991, loss: 1.499328, ce: 0.160525, reg: 83.675186, reg_best: 83.675186
step:  67, cost: 1.60E-02, attack: 0.992, loss: 1.499642, ce: 0.142602, reg: 84.815018, reg_best: 83.675186
step:  68, cost: 1.60E-02, attack: 0.990, loss: 1.524927, ce: 0.164655, reg: 85.017014, reg_best: 83.675186
step:  69, cost: 1.60E-02, attack: 0.994, loss: 1.470688, ce: 0.114839, reg: 84.740524, reg_best: 83.675186
step:  70, cost: 1.60E-02, attack: 0.994, loss: 1.466896, ce: 0.112339, reg: 84.659828, reg_best: 83.675186
step:  71, cost: 1.60E-02, attack: 0.997, loss: 1.438446, ce: 0.083669, reg: 84.679016, reg_best: 83.675186
step:  72, cost: 1.60E-02, attack: 0.988, loss: 1.539391, ce: 0.194631, reg: 84.047447, reg_best: 83.675186
step:  73, cost: 1.60E-02, attack: 0.989, loss: 1.504228, ce: 0.172920, reg: 83.206757, reg_best: 83.675186
step:  74, cost: 1.60E-02, attack: 0.987, loss: 1.558638, ce: 0.209956, reg: 84.292618, reg_best: 83.675186
step:  75, cost: 1.60E-02, attack: 0.989, loss: 1.468256, ce: 0.188210, reg: 80.002869, reg_best: 83.675186
step:  76, cost: 1.60E-02, attack: 0.987, loss: 1.533358, ce: 0.230354, reg: 81.437775, reg_best: 83.675186
down cost from 1.60E-02 to 5.66E-03
step:  77, cost: 5.66E-03, attack: 0.994, loss: 0.573637, ce: 0.100936, reg: 83.562416, reg_best: 83.562416
step:  78, cost: 5.66E-03, attack: 0.995, loss: 0.571886, ce: 0.078388, reg: 87.238945, reg_best: 83.562416
step:  79, cost: 5.66E-03, attack: 0.998, loss: 0.542706, ce: 0.044069, reg: 88.147362, reg_best: 83.562416
step:  80, cost: 5.66E-03, attack: 0.997, loss: 0.546146, ce: 0.043924, reg: 88.781166, reg_best: 83.562416
step:  81, cost: 5.66E-03, attack: 0.998, loss: 0.530561, ce: 0.035371, reg: 87.538033, reg_best: 83.562416
up cost from 5.66E-03 to 1.13E-02
step:  82, cost: 1.13E-02, attack: 0.997, loss: 1.037650, ce: 0.055243, reg: 86.833328, reg_best: 83.562416
step:  83, cost: 1.13E-02, attack: 0.996, loss: 1.039053, ce: 0.084471, reg: 84.373932, reg_best: 83.562416
step:  84, cost: 1.13E-02, attack: 0.995, loss: 1.031906, ce: 0.089258, reg: 83.321075, reg_best: 83.321075
step:  85, cost: 1.13E-02, attack: 0.994, loss: 1.073873, ce: 0.107087, reg: 85.452568, reg_best: 83.321075
step:  86, cost: 1.13E-02, attack: 0.993, loss: 1.069097, ce: 0.132068, reg: 82.822426, reg_best: 82.822426
up cost from 1.13E-02 to 2.26E-02
step:  87, cost: 2.26E-02, attack: 0.987, loss: 2.004182, ce: 0.217239, reg: 78.972473, reg_best: 82.822426
step:  88, cost: 2.26E-02, attack: 0.980, loss: 2.143350, ce: 0.333765, reg: 79.973129, reg_best: 82.822426
step:  89, cost: 2.26E-02, attack: 0.983, loss: 2.077025, ce: 0.290822, reg: 78.939743, reg_best: 82.822426
step:  90, cost: 2.26E-02, attack: 0.992, loss: 2.010332, ce: 0.148841, reg: 82.267075, reg_best: 82.267075
step:  91, cost: 2.26E-02, attack: 0.989, loss: 2.052068, ce: 0.192078, reg: 82.200745, reg_best: 82.267075
step:  92, cost: 2.26E-02, attack: 0.984, loss: 2.030700, ce: 0.279215, reg: 77.405434, reg_best: 82.267075
step:  93, cost: 2.26E-02, attack: 0.992, loss: 1.992174, ce: 0.182653, reg: 79.970268, reg_best: 79.970268
step:  94, cost: 2.26E-02, attack: 0.993, loss: 1.997633, ce: 0.127418, reg: 82.652588, reg_best: 79.970268
step:  95, cost: 2.26E-02, attack: 0.994, loss: 1.982808, ce: 0.127853, reg: 81.978188, reg_best: 79.970268
step:  96, cost: 2.26E-02, attack: 0.987, loss: 2.105854, ce: 0.220229, reg: 83.345169, reg_best: 79.970268
step:  97, cost: 2.26E-02, attack: 0.994, loss: 1.968499, ce: 0.115990, reg: 81.870102, reg_best: 79.970268
step:  98, cost: 2.26E-02, attack: 0.987, loss: 2.032124, ce: 0.203446, reg: 80.816902, reg_best: 79.970268
step:  99, cost: 2.26E-02, attack: 0.988, loss: 1.991954, ce: 0.208507, reg: 78.817970, reg_best: 79.970268
pattern, shape: (32, 32, 3), min: 0.000000, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 14: 83.184021
visualization cost 20.114777 seconds
processing label 15
resetting state
mask_tanh -5.772426470583054 3.911684251612768
pattern_tanh -3.899672381195499 4.199080372599612
step:   0, cost: 0.00E+00, attack: 0.838, loss: 2.834708, ce: 2.834708, reg: 555.586426, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000127, ce: 0.000127, reg: 587.037048, reg_best: 587.037048
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.002418, ce: 0.002418, reg: 592.573975, reg_best: 587.037048
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000063, ce: 0.000063, reg: 601.684265, reg_best: 587.037048
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000011, ce: 0.000011, reg: 603.439453, reg_best: 587.037048
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 610.419800, reg_best: 587.037048
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.995, loss: 0.523012, ce: 0.087126, reg: 435.885803, reg_best: 435.885803
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.362388, ce: 0.012703, reg: 349.685730, reg_best: 349.685730
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.311254, ce: 0.002105, reg: 309.149506, reg_best: 309.149506
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.293871, ce: 0.020668, reg: 273.239044, reg_best: 273.239044
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.997, loss: 0.542387, ce: 0.054343, reg: 244.021912, reg_best: 244.021912
step:  11, cost: 2.00E-03, attack: 0.996, loss: 0.507317, ce: 0.067234, reg: 220.041458, reg_best: 220.041458
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.452102, ce: 0.035452, reg: 208.325348, reg_best: 208.325348
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.428159, ce: 0.016795, reg: 205.681931, reg_best: 205.681931
step:  14, cost: 2.00E-03, attack: 0.997, loss: 0.417520, ce: 0.053792, reg: 181.863739, reg_best: 181.863739
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.996, loss: 0.783853, ce: 0.081853, reg: 175.499939, reg_best: 175.499939
step:  16, cost: 4.00E-03, attack: 0.996, loss: 0.739610, ce: 0.066088, reg: 168.380676, reg_best: 168.380676
step:  17, cost: 4.00E-03, attack: 0.998, loss: 0.718967, ce: 0.034398, reg: 171.142410, reg_best: 168.380676
step:  18, cost: 4.00E-03, attack: 0.997, loss: 0.710623, ce: 0.058172, reg: 163.112656, reg_best: 163.112656
step:  19, cost: 4.00E-03, attack: 0.996, loss: 0.687437, ce: 0.056659, reg: 157.694626, reg_best: 157.694626
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.997, loss: 1.292017, ce: 0.062804, reg: 153.651550, reg_best: 153.651550
step:  21, cost: 8.00E-03, attack: 0.995, loss: 1.294719, ce: 0.097378, reg: 149.667603, reg_best: 149.667603
step:  22, cost: 8.00E-03, attack: 0.996, loss: 1.233801, ce: 0.071636, reg: 145.259872, reg_best: 145.259872
step:  23, cost: 8.00E-03, attack: 0.996, loss: 1.207702, ce: 0.077362, reg: 141.292496, reg_best: 141.292496
step:  24, cost: 8.00E-03, attack: 0.995, loss: 1.229500, ce: 0.094813, reg: 141.835876, reg_best: 141.292496
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.987, loss: 2.334991, ce: 0.235645, reg: 131.209137, reg_best: 141.292496
step:  26, cost: 1.60E-02, attack: 0.992, loss: 2.213227, ce: 0.131656, reg: 130.098160, reg_best: 130.098160
step:  27, cost: 1.60E-02, attack: 0.988, loss: 2.268859, ce: 0.229674, reg: 127.449036, reg_best: 130.098160
step:  28, cost: 1.60E-02, attack: 0.991, loss: 2.210931, ce: 0.161517, reg: 128.088348, reg_best: 128.088348
step:  29, cost: 1.60E-02, attack: 0.990, loss: 2.219564, ce: 0.186615, reg: 127.059280, reg_best: 128.088348
step:  30, cost: 1.60E-02, attack: 0.982, loss: 2.238513, ce: 0.295754, reg: 121.422455, reg_best: 128.088348
step:  31, cost: 1.60E-02, attack: 0.986, loss: 2.182987, ce: 0.238121, reg: 121.554146, reg_best: 128.088348
step:  32, cost: 1.60E-02, attack: 0.987, loss: 2.187523, ce: 0.215389, reg: 123.258369, reg_best: 128.088348
step:  33, cost: 1.60E-02, attack: 0.974, loss: 2.260303, ce: 0.414146, reg: 115.384781, reg_best: 128.088348
down cost from 1.60E-02 to 5.66E-03
step:  34, cost: 5.66E-03, attack: 0.998, loss: 0.779980, ce: 0.036761, reg: 131.361023, reg_best: 128.088348
step:  35, cost: 5.66E-03, attack: 0.993, loss: 0.835594, ce: 0.124689, reg: 125.671379, reg_best: 125.671379
step:  36, cost: 5.66E-03, attack: 0.997, loss: 0.806518, ce: 0.060503, reg: 131.878082, reg_best: 125.671379
step:  37, cost: 5.66E-03, attack: 0.997, loss: 0.773557, ce: 0.057934, reg: 126.505470, reg_best: 125.671379
step:  38, cost: 5.66E-03, attack: 0.997, loss: 0.752710, ce: 0.056799, reg: 123.020859, reg_best: 123.020859
up cost from 5.66E-03 to 1.13E-02
step:  39, cost: 1.13E-02, attack: 0.988, loss: 1.571403, ce: 0.204873, reg: 120.785362, reg_best: 123.020859
step:  40, cost: 1.13E-02, attack: 0.989, loss: 1.551606, ce: 0.189685, reg: 120.377960, reg_best: 123.020859
step:  41, cost: 1.13E-02, attack: 0.994, loss: 1.493639, ce: 0.117987, reg: 121.591583, reg_best: 121.591583
step:  42, cost: 1.13E-02, attack: 0.991, loss: 1.511223, ce: 0.147604, reg: 120.528030, reg_best: 120.528030
step:  43, cost: 1.13E-02, attack: 0.991, loss: 1.485210, ce: 0.129568, reg: 119.822899, reg_best: 119.822899
step:  44, cost: 1.13E-02, attack: 0.997, loss: 1.430352, ce: 0.074562, reg: 119.836006, reg_best: 119.822899
step:  45, cost: 1.13E-02, attack: 0.995, loss: 1.423720, ce: 0.091131, reg: 117.785271, reg_best: 117.785271
up cost from 1.13E-02 to 2.26E-02
step:  46, cost: 2.26E-02, attack: 0.980, loss: 2.835801, ce: 0.331934, reg: 110.656296, reg_best: 117.785271
step:  47, cost: 2.26E-02, attack: 0.988, loss: 2.737274, ce: 0.210689, reg: 111.667061, reg_best: 117.785271
step:  48, cost: 2.26E-02, attack: 0.983, loss: 2.774177, ce: 0.272898, reg: 110.541977, reg_best: 117.785271
step:  49, cost: 2.26E-02, attack: 0.984, loss: 2.808698, ce: 0.283984, reg: 111.577644, reg_best: 117.785271
step:  50, cost: 2.26E-02, attack: 0.990, loss: 2.765109, ce: 0.196091, reg: 113.535606, reg_best: 117.785271
down cost from 2.26E-02 to 8.00E-03
step:  51, cost: 8.00E-03, attack: 0.991, loss: 1.077721, ce: 0.149729, reg: 115.998970, reg_best: 115.998970
step:  52, cost: 8.00E-03, attack: 0.996, loss: 1.022693, ce: 0.074050, reg: 118.580330, reg_best: 115.998970
step:  53, cost: 8.00E-03, attack: 0.993, loss: 1.054059, ce: 0.116818, reg: 117.155098, reg_best: 115.998970
step:  54, cost: 8.00E-03, attack: 0.989, loss: 1.115896, ce: 0.197218, reg: 114.834740, reg_best: 115.998970
step:  55, cost: 8.00E-03, attack: 0.993, loss: 1.058392, ce: 0.122177, reg: 117.026909, reg_best: 115.998970
step:  56, cost: 8.00E-03, attack: 0.996, loss: 1.005875, ce: 0.070315, reg: 116.945084, reg_best: 115.998970
step:  57, cost: 8.00E-03, attack: 0.996, loss: 1.029018, ce: 0.066743, reg: 120.284340, reg_best: 115.998970
step:  58, cost: 8.00E-03, attack: 0.993, loss: 1.062697, ce: 0.108030, reg: 119.333344, reg_best: 115.998970
step:  59, cost: 8.00E-03, attack: 0.996, loss: 1.042688, ce: 0.097549, reg: 118.142387, reg_best: 115.998970
up cost from 8.00E-03 to 1.60E-02
step:  60, cost: 1.60E-02, attack: 0.993, loss: 1.921417, ce: 0.119092, reg: 112.601707, reg_best: 112.601707
step:  61, cost: 1.60E-02, attack: 0.985, loss: 2.045228, ce: 0.249367, reg: 112.241280, reg_best: 112.601707
step:  62, cost: 1.60E-02, attack: 0.986, loss: 2.043230, ce: 0.252025, reg: 111.950279, reg_best: 112.601707
step:  63, cost: 1.60E-02, attack: 0.983, loss: 2.042968, ce: 0.272546, reg: 110.651390, reg_best: 112.601707
step:  64, cost: 1.60E-02, attack: 0.990, loss: 1.911188, ce: 0.179460, reg: 108.232964, reg_best: 112.601707
step:  65, cost: 1.60E-02, attack: 0.981, loss: 2.032832, ce: 0.283096, reg: 109.358513, reg_best: 112.601707
down cost from 1.60E-02 to 5.66E-03
step:  66, cost: 5.66E-03, attack: 0.996, loss: 0.723493, ce: 0.073445, reg: 114.913345, reg_best: 112.601707
step:  67, cost: 5.66E-03, attack: 0.998, loss: 0.723748, ce: 0.052703, reg: 118.625076, reg_best: 112.601707
step:  68, cost: 5.66E-03, attack: 0.997, loss: 0.726407, ce: 0.044946, reg: 120.466408, reg_best: 112.601707
step:  69, cost: 5.66E-03, attack: 0.994, loss: 0.769744, ce: 0.103911, reg: 117.703773, reg_best: 112.601707
step:  70, cost: 5.66E-03, attack: 0.998, loss: 0.722076, ce: 0.032093, reg: 121.972954, reg_best: 112.601707
up cost from 5.66E-03 to 1.13E-02
step:  71, cost: 1.13E-02, attack: 0.997, loss: 1.395526, ce: 0.050440, reg: 118.889992, reg_best: 112.601707
step:  72, cost: 1.13E-02, attack: 0.989, loss: 1.475045, ce: 0.188957, reg: 113.675163, reg_best: 112.601707
step:  73, cost: 1.13E-02, attack: 0.993, loss: 1.424497, ce: 0.115870, reg: 115.648331, reg_best: 112.601707
step:  74, cost: 1.13E-02, attack: 0.996, loss: 1.338874, ce: 0.070956, reg: 112.069115, reg_best: 112.069115
step:  75, cost: 1.13E-02, attack: 0.988, loss: 1.454492, ce: 0.186962, reg: 112.034935, reg_best: 112.069115
step:  76, cost: 1.13E-02, attack: 0.994, loss: 1.418732, ce: 0.107394, reg: 115.907005, reg_best: 112.069115
step:  77, cost: 1.13E-02, attack: 0.993, loss: 1.423200, ce: 0.128630, reg: 114.424904, reg_best: 112.069115
step:  78, cost: 1.13E-02, attack: 0.990, loss: 1.461838, ce: 0.183067, reg: 113.028458, reg_best: 112.069115
step:  79, cost: 1.13E-02, attack: 0.995, loss: 1.383987, ce: 0.074741, reg: 115.722107, reg_best: 112.069115
step:  80, cost: 1.13E-02, attack: 0.996, loss: 1.377622, ce: 0.077981, reg: 114.873093, reg_best: 112.069115
step:  81, cost: 1.13E-02, attack: 0.995, loss: 1.366313, ce: 0.084766, reg: 113.273750, reg_best: 112.069115
step:  82, cost: 1.13E-02, attack: 0.990, loss: 1.395423, ce: 0.176647, reg: 107.725555, reg_best: 112.069115
step:  83, cost: 1.13E-02, attack: 0.987, loss: 1.441913, ce: 0.225004, reg: 107.560555, reg_best: 112.069115
step:  84, cost: 1.13E-02, attack: 0.988, loss: 1.462612, ce: 0.190991, reg: 112.396484, reg_best: 112.069115
step:  85, cost: 1.13E-02, attack: 0.993, loss: 1.413583, ce: 0.121299, reg: 114.233086, reg_best: 112.069115
step:  86, cost: 1.13E-02, attack: 0.996, loss: 1.339793, ce: 0.080906, reg: 111.270966, reg_best: 111.270966
step:  87, cost: 1.13E-02, attack: 0.987, loss: 1.459347, ce: 0.220115, reg: 109.533676, reg_best: 111.270966
step:  88, cost: 1.13E-02, attack: 0.984, loss: 1.520926, ce: 0.248598, reg: 112.459015, reg_best: 111.270966
step:  89, cost: 1.13E-02, attack: 0.988, loss: 1.432972, ce: 0.218985, reg: 107.302345, reg_best: 111.270966
step:  90, cost: 1.13E-02, attack: 0.997, loss: 1.357754, ce: 0.072319, reg: 113.617470, reg_best: 111.270966
step:  91, cost: 1.13E-02, attack: 0.985, loss: 1.430978, ce: 0.221990, reg: 106.860527, reg_best: 111.270966
step:  92, cost: 1.13E-02, attack: 0.988, loss: 1.417926, ce: 0.179215, reg: 109.487602, reg_best: 111.270966
step:  93, cost: 1.13E-02, attack: 0.989, loss: 1.409157, ce: 0.169943, reg: 109.532059, reg_best: 111.270966
step:  94, cost: 1.13E-02, attack: 0.988, loss: 1.452426, ce: 0.183809, reg: 112.130928, reg_best: 111.270966
step:  95, cost: 1.13E-02, attack: 0.996, loss: 1.335199, ce: 0.061085, reg: 112.616875, reg_best: 111.270966
step:  96, cost: 1.13E-02, attack: 0.994, loss: 1.368916, ce: 0.106063, reg: 111.621437, reg_best: 111.270966
step:  97, cost: 1.13E-02, attack: 0.993, loss: 1.355284, ce: 0.120175, reg: 109.169189, reg_best: 109.169189
step:  98, cost: 1.13E-02, attack: 0.990, loss: 1.418104, ce: 0.162474, reg: 110.988350, reg_best: 109.169189
step:  99, cost: 1.13E-02, attack: 0.994, loss: 1.364666, ce: 0.115692, reg: 110.394714, reg_best: 109.169189
pattern, shape: (32, 32, 3), min: 0.000008, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 15: 111.666283
visualization cost 20.166419 seconds
processing label 16
resetting state
mask_tanh -5.239765095532002 3.208495001391398
pattern_tanh -4.9130347384845345 4.337822084597587
step:   0, cost: 0.00E+00, attack: 0.824, loss: 2.942948, ce: 2.942948, reg: 562.312927, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000210, ce: 0.000210, reg: 582.893127, reg_best: 582.893127
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000019, ce: 0.000019, reg: 583.608704, reg_best: 582.893127
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000012, ce: 0.000012, reg: 584.134033, reg_best: 582.893127
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000005, ce: 0.000005, reg: 588.393860, reg_best: 582.893127
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 590.268799, reg_best: 582.893127
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.998, loss: 0.477390, ce: 0.043585, reg: 433.805206, reg_best: 433.805206
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.371331, ce: 0.028396, reg: 342.934570, reg_best: 342.934570
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.284678, ce: 0.002435, reg: 282.242706, reg_best: 282.242706
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.254456, ce: 0.029855, reg: 224.600662, reg_best: 224.600662
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.396540, ce: 0.021530, reg: 187.505066, reg_best: 187.505066
step:  11, cost: 2.00E-03, attack: 0.996, loss: 0.382447, ce: 0.074099, reg: 154.140167, reg_best: 154.140167
step:  12, cost: 2.00E-03, attack: 0.994, loss: 0.365270, ce: 0.075081, reg: 145.094559, reg_best: 145.094559
step:  13, cost: 2.00E-03, attack: 0.998, loss: 0.329648, ce: 0.032809, reg: 148.419464, reg_best: 145.094559
step:  14, cost: 2.00E-03, attack: 0.996, loss: 0.315147, ce: 0.073064, reg: 121.041580, reg_best: 121.041580
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.994, loss: 0.565803, ce: 0.103645, reg: 115.539398, reg_best: 115.539398
step:  16, cost: 4.00E-03, attack: 0.999, loss: 0.480958, ce: 0.017025, reg: 115.983154, reg_best: 115.539398
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.461442, ce: 0.062038, reg: 99.851082, reg_best: 99.851082
step:  18, cost: 4.00E-03, attack: 0.994, loss: 0.484611, ce: 0.105469, reg: 94.785362, reg_best: 94.785362
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.399830, ce: 0.027475, reg: 93.088737, reg_best: 93.088737
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.987, loss: 0.915556, ce: 0.222241, reg: 86.664345, reg_best: 93.088737
step:  21, cost: 8.00E-03, attack: 0.983, loss: 0.925410, ce: 0.266674, reg: 82.341972, reg_best: 93.088737
step:  22, cost: 8.00E-03, attack: 0.993, loss: 0.815729, ce: 0.119233, reg: 87.061996, reg_best: 87.061996
step:  23, cost: 8.00E-03, attack: 0.996, loss: 0.784436, ce: 0.067104, reg: 89.666473, reg_best: 87.061996
step:  24, cost: 8.00E-03, attack: 0.995, loss: 0.769658, ce: 0.090096, reg: 84.943085, reg_best: 84.943085
step:  25, cost: 8.00E-03, attack: 0.995, loss: 0.742439, ce: 0.080531, reg: 82.738586, reg_best: 82.738586
step:  26, cost: 8.00E-03, attack: 0.990, loss: 0.814468, ce: 0.173134, reg: 80.166695, reg_best: 82.738586
step:  27, cost: 8.00E-03, attack: 0.996, loss: 0.740402, ce: 0.074940, reg: 83.182701, reg_best: 82.738586
step:  28, cost: 8.00E-03, attack: 0.997, loss: 0.731546, ce: 0.061025, reg: 83.815125, reg_best: 82.738586
step:  29, cost: 8.00E-03, attack: 0.992, loss: 0.757482, ce: 0.126127, reg: 78.919388, reg_best: 78.919388
step:  30, cost: 8.00E-03, attack: 0.990, loss: 0.805460, ce: 0.165710, reg: 79.968796, reg_best: 78.919388
step:  31, cost: 8.00E-03, attack: 0.994, loss: 0.754292, ce: 0.111941, reg: 80.293816, reg_best: 78.919388
step:  32, cost: 8.00E-03, attack: 0.987, loss: 0.847860, ce: 0.210059, reg: 79.725136, reg_best: 78.919388
step:  33, cost: 8.00E-03, attack: 0.989, loss: 0.783577, ce: 0.168001, reg: 76.946999, reg_best: 78.919388
step:  34, cost: 8.00E-03, attack: 0.993, loss: 0.735497, ce: 0.120213, reg: 76.910492, reg_best: 76.910492
step:  35, cost: 8.00E-03, attack: 0.998, loss: 0.669390, ce: 0.040261, reg: 78.641136, reg_best: 76.910492
step:  36, cost: 8.00E-03, attack: 0.997, loss: 0.706449, ce: 0.049280, reg: 82.136589, reg_best: 76.910492
step:  37, cost: 8.00E-03, attack: 0.992, loss: 0.745818, ce: 0.124748, reg: 77.633736, reg_best: 76.910492
step:  38, cost: 8.00E-03, attack: 0.995, loss: 0.701838, ce: 0.087853, reg: 76.748138, reg_best: 76.748138
up cost from 8.00E-03 to 1.60E-02
step:  39, cost: 1.60E-02, attack: 0.987, loss: 1.421357, ce: 0.214678, reg: 75.417419, reg_best: 76.748138
step:  40, cost: 1.60E-02, attack: 0.994, loss: 1.339107, ce: 0.090243, reg: 78.054008, reg_best: 76.748138
step:  41, cost: 1.60E-02, attack: 0.992, loss: 1.355514, ce: 0.135708, reg: 76.237854, reg_best: 76.237854
step:  42, cost: 1.60E-02, attack: 0.989, loss: 1.372055, ce: 0.180574, reg: 74.467560, reg_best: 76.237854
step:  43, cost: 1.60E-02, attack: 0.990, loss: 1.358547, ce: 0.179711, reg: 73.677223, reg_best: 76.237854
step:  44, cost: 1.60E-02, attack: 0.995, loss: 1.283523, ce: 0.082128, reg: 75.087204, reg_best: 75.087204
step:  45, cost: 1.60E-02, attack: 0.986, loss: 1.382840, ce: 0.219591, reg: 72.703087, reg_best: 75.087204
step:  46, cost: 1.60E-02, attack: 0.984, loss: 1.434681, ce: 0.277784, reg: 72.306099, reg_best: 75.087204
step:  47, cost: 1.60E-02, attack: 0.992, loss: 1.343370, ce: 0.130020, reg: 75.834412, reg_best: 75.087204
step:  48, cost: 1.60E-02, attack: 0.993, loss: 1.352903, ce: 0.117934, reg: 77.185547, reg_best: 75.087204
step:  49, cost: 1.60E-02, attack: 0.991, loss: 1.293878, ce: 0.160487, reg: 70.842911, reg_best: 70.842911
step:  50, cost: 1.60E-02, attack: 0.991, loss: 1.314816, ce: 0.143632, reg: 73.199036, reg_best: 70.842911
step:  51, cost: 1.60E-02, attack: 0.990, loss: 1.300532, ce: 0.162720, reg: 71.113258, reg_best: 70.842911
step:  52, cost: 1.60E-02, attack: 0.991, loss: 1.338542, ce: 0.150439, reg: 74.256477, reg_best: 70.842911
step:  53, cost: 1.60E-02, attack: 0.994, loss: 1.291790, ce: 0.116002, reg: 73.486702, reg_best: 70.842911
step:  54, cost: 1.60E-02, attack: 0.996, loss: 1.263790, ce: 0.068406, reg: 74.711510, reg_best: 70.842911
step:  55, cost: 1.60E-02, attack: 0.988, loss: 1.363734, ce: 0.204336, reg: 72.462372, reg_best: 70.842911
step:  56, cost: 1.60E-02, attack: 0.991, loss: 1.363145, ce: 0.151389, reg: 75.734711, reg_best: 70.842911
step:  57, cost: 1.60E-02, attack: 0.995, loss: 1.271211, ce: 0.091849, reg: 73.710098, reg_best: 70.842911
step:  58, cost: 1.60E-02, attack: 0.994, loss: 1.266208, ce: 0.095714, reg: 73.155853, reg_best: 70.842911
step:  59, cost: 1.60E-02, attack: 0.989, loss: 1.366205, ce: 0.200289, reg: 72.869713, reg_best: 70.842911
step:  60, cost: 1.60E-02, attack: 0.989, loss: 1.360200, ce: 0.173733, reg: 74.154137, reg_best: 70.842911
step:  61, cost: 1.60E-02, attack: 0.989, loss: 1.391652, ce: 0.179120, reg: 75.783211, reg_best: 70.842911
step:  62, cost: 1.60E-02, attack: 0.995, loss: 1.267650, ce: 0.085349, reg: 73.885574, reg_best: 70.842911
step:  63, cost: 1.60E-02, attack: 0.992, loss: 1.310598, ce: 0.148404, reg: 72.637138, reg_best: 70.842911
step:  64, cost: 1.60E-02, attack: 0.990, loss: 1.342617, ce: 0.173942, reg: 73.042236, reg_best: 70.842911
step:  65, cost: 1.60E-02, attack: 0.990, loss: 1.345440, ce: 0.169049, reg: 73.524445, reg_best: 70.842911
step:  66, cost: 1.60E-02, attack: 0.985, loss: 1.392578, ce: 0.237199, reg: 72.211197, reg_best: 70.842911
step:  67, cost: 1.60E-02, attack: 0.990, loss: 1.310201, ce: 0.164720, reg: 71.592514, reg_best: 70.842911
step:  68, cost: 1.60E-02, attack: 0.986, loss: 1.380436, ce: 0.224111, reg: 72.270317, reg_best: 70.842911
down cost from 1.60E-02 to 5.66E-03
step:  69, cost: 5.66E-03, attack: 0.995, loss: 0.510801, ce: 0.096788, reg: 73.187775, reg_best: 70.842911
step:  70, cost: 5.66E-03, attack: 0.996, loss: 0.526526, ce: 0.084935, reg: 78.062996, reg_best: 70.842911
step:  71, cost: 5.66E-03, attack: 0.997, loss: 0.493538, ce: 0.050464, reg: 78.324997, reg_best: 70.842911
step:  72, cost: 5.66E-03, attack: 0.994, loss: 0.529791, ce: 0.105535, reg: 74.998718, reg_best: 70.842911
step:  73, cost: 5.66E-03, attack: 0.997, loss: 0.479294, ce: 0.052243, reg: 75.492699, reg_best: 70.842911
up cost from 5.66E-03 to 1.13E-02
step:  74, cost: 1.13E-02, attack: 0.990, loss: 0.977991, ce: 0.150210, reg: 73.166122, reg_best: 70.842911
early stop
pattern, shape: (32, 32, 3), min: 0.000008, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 16: 71.080544
visualization cost 15.189842 seconds
processing label 18
resetting state
mask_tanh -3.2370606788425613 3.4495264980052958
pattern_tanh -3.569834440069086 3.5676850226408314
step:   0, cost: 0.00E+00, attack: 0.829, loss: 2.882642, ce: 2.882642, reg: 550.747681, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000399, ce: 0.000399, reg: 573.151489, reg_best: 573.151489
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000011, ce: 0.000011, reg: 574.597107, reg_best: 573.151489
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000097, ce: 0.000097, reg: 580.397949, reg_best: 573.151489
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 584.294128, reg_best: 573.151489
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000008, ce: 0.000008, reg: 584.819458, reg_best: 573.151489
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.399352, ce: 0.045928, reg: 353.423492, reg_best: 353.423492
step:   7, cost: 1.00E-03, attack: 0.997, loss: 0.297130, ce: 0.052091, reg: 245.039093, reg_best: 245.039093
step:   8, cost: 1.00E-03, attack: 0.998, loss: 0.225039, ce: 0.027025, reg: 198.013382, reg_best: 198.013382
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.194528, ce: 0.013585, reg: 180.942902, reg_best: 180.942902
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.325823, ce: 0.019629, reg: 153.096725, reg_best: 153.096725
step:  11, cost: 2.00E-03, attack: 0.995, loss: 0.344715, ce: 0.093165, reg: 125.775093, reg_best: 125.775093
step:  12, cost: 2.00E-03, attack: 0.993, loss: 0.341655, ce: 0.116514, reg: 112.451744, reg_best: 112.451744
step:  13, cost: 2.00E-03, attack: 0.998, loss: 0.250465, ce: 0.038107, reg: 106.179024, reg_best: 106.179024
step:  14, cost: 2.00E-03, attack: 0.998, loss: 0.237813, ce: 0.032966, reg: 102.423637, reg_best: 102.423637
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.994, loss: 0.436586, ce: 0.107319, reg: 82.316895, reg_best: 82.316895
step:  16, cost: 4.00E-03, attack: 0.990, loss: 0.472005, ce: 0.137265, reg: 83.684837, reg_best: 82.316895
step:  17, cost: 4.00E-03, attack: 0.998, loss: 0.377380, ce: 0.028670, reg: 87.177597, reg_best: 82.316895
step:  18, cost: 4.00E-03, attack: 0.997, loss: 0.379539, ce: 0.055590, reg: 80.987450, reg_best: 80.987450
step:  19, cost: 4.00E-03, attack: 0.995, loss: 0.379822, ce: 0.082196, reg: 74.406532, reg_best: 74.406532
step:  20, cost: 4.00E-03, attack: 0.996, loss: 0.358097, ce: 0.054844, reg: 75.813156, reg_best: 74.406532
step:  21, cost: 4.00E-03, attack: 0.998, loss: 0.333172, ce: 0.027745, reg: 76.356857, reg_best: 74.406532
up cost from 4.00E-03 to 8.00E-03
step:  22, cost: 8.00E-03, attack: 0.995, loss: 0.618477, ce: 0.080221, reg: 67.282036, reg_best: 67.282036
step:  23, cost: 8.00E-03, attack: 0.989, loss: 0.714226, ce: 0.182425, reg: 66.475098, reg_best: 67.282036
step:  24, cost: 8.00E-03, attack: 0.997, loss: 0.603089, ce: 0.057894, reg: 68.149414, reg_best: 67.282036
step:  25, cost: 8.00E-03, attack: 0.986, loss: 0.715136, ce: 0.227650, reg: 60.881062, reg_best: 67.282036
step:  26, cost: 8.00E-03, attack: 1.000, loss: 0.561027, ce: 0.010264, reg: 68.845352, reg_best: 67.282036
step:  27, cost: 8.00E-03, attack: 0.995, loss: 0.577502, ce: 0.086645, reg: 61.357063, reg_best: 61.357063
step:  28, cost: 8.00E-03, attack: 0.993, loss: 0.620828, ce: 0.126486, reg: 61.792725, reg_best: 61.357063
step:  29, cost: 8.00E-03, attack: 0.993, loss: 0.607127, ce: 0.123447, reg: 60.460041, reg_best: 60.460041
step:  30, cost: 8.00E-03, attack: 0.996, loss: 0.572585, ce: 0.066769, reg: 63.227062, reg_best: 60.460041
up cost from 8.00E-03 to 1.60E-02
step:  31, cost: 1.60E-02, attack: 0.987, loss: 1.115857, ce: 0.207129, reg: 56.795494, reg_best: 60.460041
step:  32, cost: 1.60E-02, attack: 0.989, loss: 1.048916, ce: 0.184243, reg: 54.041988, reg_best: 60.460041
step:  33, cost: 1.60E-02, attack: 0.993, loss: 1.037402, ce: 0.109594, reg: 57.988003, reg_best: 57.988003
step:  34, cost: 1.60E-02, attack: 0.994, loss: 1.043619, ce: 0.100684, reg: 58.933414, reg_best: 57.988003
step:  35, cost: 1.60E-02, attack: 0.984, loss: 1.077405, ce: 0.252267, reg: 51.571121, reg_best: 57.988003
step:  36, cost: 1.60E-02, attack: 0.985, loss: 1.093799, ce: 0.253899, reg: 52.493748, reg_best: 57.988003
step:  37, cost: 1.60E-02, attack: 0.995, loss: 0.952065, ce: 0.080531, reg: 54.470882, reg_best: 54.470882
step:  38, cost: 1.60E-02, attack: 0.991, loss: 1.036761, ce: 0.151055, reg: 55.371128, reg_best: 54.470882
step:  39, cost: 1.60E-02, attack: 0.994, loss: 0.996182, ce: 0.094264, reg: 56.369884, reg_best: 54.470882
step:  40, cost: 1.60E-02, attack: 0.989, loss: 1.019137, ce: 0.190449, reg: 51.792976, reg_best: 54.470882
step:  41, cost: 1.60E-02, attack: 0.990, loss: 0.975745, ce: 0.172716, reg: 50.189304, reg_best: 54.470882
step:  42, cost: 1.60E-02, attack: 0.984, loss: 1.057318, ce: 0.265673, reg: 49.477840, reg_best: 54.470882
step:  43, cost: 1.60E-02, attack: 0.988, loss: 1.020649, ce: 0.181827, reg: 52.426376, reg_best: 54.470882
step:  44, cost: 1.60E-02, attack: 0.984, loss: 1.044591, ce: 0.259298, reg: 49.080826, reg_best: 54.470882
down cost from 1.60E-02 to 5.66E-03
step:  45, cost: 5.66E-03, attack: 0.995, loss: 0.382275, ce: 0.086668, reg: 52.256355, reg_best: 52.256355
step:  46, cost: 5.66E-03, attack: 0.994, loss: 0.414653, ce: 0.100690, reg: 55.501301, reg_best: 52.256355
step:  47, cost: 5.66E-03, attack: 0.998, loss: 0.367942, ce: 0.038699, reg: 58.202457, reg_best: 52.256355
step:  48, cost: 5.66E-03, attack: 0.995, loss: 0.385530, ce: 0.078342, reg: 54.303688, reg_best: 52.256355
step:  49, cost: 5.66E-03, attack: 0.994, loss: 0.431981, ce: 0.111850, reg: 56.591713, reg_best: 52.256355
up cost from 5.66E-03 to 1.13E-02
step:  50, cost: 1.13E-02, attack: 0.997, loss: 0.703963, ce: 0.044100, reg: 58.324207, reg_best: 52.256355
step:  51, cost: 1.13E-02, attack: 0.995, loss: 0.714952, ce: 0.085105, reg: 55.648304, reg_best: 52.256355
step:  52, cost: 1.13E-02, attack: 0.997, loss: 0.663246, ce: 0.039649, reg: 55.118763, reg_best: 52.256355
step:  53, cost: 1.13E-02, attack: 0.994, loss: 0.714087, ce: 0.110631, reg: 53.338402, reg_best: 52.256355
step:  54, cost: 1.13E-02, attack: 0.994, loss: 0.692925, ce: 0.101940, reg: 52.236164, reg_best: 52.236164
up cost from 1.13E-02 to 2.26E-02
step:  55, cost: 2.26E-02, attack: 0.990, loss: 1.300573, ce: 0.179858, reg: 49.529064, reg_best: 52.236164
step:  56, cost: 2.26E-02, attack: 0.986, loss: 1.351766, ce: 0.232147, reg: 49.480621, reg_best: 52.236164
step:  57, cost: 2.26E-02, attack: 0.984, loss: 1.366414, ce: 0.260540, reg: 48.873219, reg_best: 52.236164
step:  58, cost: 2.26E-02, attack: 0.983, loss: 1.336316, ce: 0.272059, reg: 47.033936, reg_best: 52.236164
step:  59, cost: 2.26E-02, attack: 0.990, loss: 1.304112, ce: 0.171067, reg: 50.074005, reg_best: 52.236164
down cost from 2.26E-02 to 8.00E-03
step:  60, cost: 8.00E-03, attack: 0.986, loss: 0.624522, ce: 0.212992, reg: 51.441299, reg_best: 52.236164
step:  61, cost: 8.00E-03, attack: 0.994, loss: 0.546707, ce: 0.104781, reg: 55.240788, reg_best: 52.236164
step:  62, cost: 8.00E-03, attack: 0.995, loss: 0.546160, ce: 0.078886, reg: 58.409294, reg_best: 52.236164
step:  63, cost: 8.00E-03, attack: 0.992, loss: 0.561421, ce: 0.132023, reg: 53.636463, reg_best: 52.236164
step:  64, cost: 8.00E-03, attack: 0.981, loss: 0.680067, ce: 0.300573, reg: 47.436749, reg_best: 52.236164
step:  65, cost: 8.00E-03, attack: 0.995, loss: 0.500743, ce: 0.089006, reg: 51.467171, reg_best: 51.467171
step:  66, cost: 8.00E-03, attack: 0.992, loss: 0.549300, ce: 0.134314, reg: 51.873238, reg_best: 51.467171
step:  67, cost: 8.00E-03, attack: 0.996, loss: 0.514793, ce: 0.065867, reg: 56.115753, reg_best: 51.467171
step:  68, cost: 8.00E-03, attack: 0.993, loss: 0.544759, ce: 0.128554, reg: 52.025547, reg_best: 51.467171
step:  69, cost: 8.00E-03, attack: 0.995, loss: 0.504423, ce: 0.083833, reg: 52.573727, reg_best: 51.467171
up cost from 8.00E-03 to 1.60E-02
step:  70, cost: 1.60E-02, attack: 0.984, loss: 1.044923, ce: 0.258538, reg: 49.149105, reg_best: 51.467171
step:  71, cost: 1.60E-02, attack: 0.980, loss: 1.059825, ce: 0.323884, reg: 45.996292, reg_best: 51.467171
step:  72, cost: 1.60E-02, attack: 0.993, loss: 0.908324, ce: 0.107310, reg: 50.063335, reg_best: 50.063335
step:  73, cost: 1.60E-02, attack: 0.987, loss: 1.028018, ce: 0.214518, reg: 50.843739, reg_best: 50.063335
step:  74, cost: 1.60E-02, attack: 0.990, loss: 0.969009, ce: 0.154002, reg: 50.937931, reg_best: 50.063335
step:  75, cost: 1.60E-02, attack: 0.993, loss: 0.924485, ce: 0.116960, reg: 50.470291, reg_best: 50.063335
step:  76, cost: 1.60E-02, attack: 0.982, loss: 1.086810, ce: 0.309454, reg: 48.575161, reg_best: 50.063335
step:  77, cost: 1.60E-02, attack: 0.988, loss: 0.955000, ce: 0.180786, reg: 48.388340, reg_best: 50.063335
step:  78, cost: 1.60E-02, attack: 0.995, loss: 0.903014, ce: 0.079094, reg: 51.495010, reg_best: 50.063335
step:  79, cost: 1.60E-02, attack: 0.987, loss: 1.021793, ce: 0.215045, reg: 50.421734, reg_best: 50.063335
step:  80, cost: 1.60E-02, attack: 0.995, loss: 0.939719, ce: 0.100378, reg: 52.458809, reg_best: 50.063335
step:  81, cost: 1.60E-02, attack: 0.994, loss: 0.906439, ce: 0.085444, reg: 51.312237, reg_best: 50.063335
step:  82, cost: 1.60E-02, attack: 0.994, loss: 0.917266, ce: 0.094514, reg: 51.422001, reg_best: 50.063335
step:  83, cost: 1.60E-02, attack: 0.995, loss: 0.881896, ce: 0.090204, reg: 49.480736, reg_best: 49.480736
step:  84, cost: 1.60E-02, attack: 0.989, loss: 0.964179, ce: 0.180183, reg: 48.999733, reg_best: 49.480736
step:  85, cost: 1.60E-02, attack: 0.987, loss: 0.987602, ce: 0.205233, reg: 48.898109, reg_best: 49.480736
step:  86, cost: 1.60E-02, attack: 0.994, loss: 0.905466, ce: 0.095764, reg: 50.606396, reg_best: 49.480736
step:  87, cost: 1.60E-02, attack: 0.987, loss: 0.982753, ce: 0.226793, reg: 47.247475, reg_best: 49.480736
step:  88, cost: 1.60E-02, attack: 0.990, loss: 0.969484, ce: 0.170999, reg: 49.905304, reg_best: 49.480736
step:  89, cost: 1.60E-02, attack: 0.992, loss: 0.937360, ce: 0.135634, reg: 50.121075, reg_best: 49.480736
step:  90, cost: 1.60E-02, attack: 0.983, loss: 1.043458, ce: 0.283928, reg: 47.470581, reg_best: 49.480736
step:  91, cost: 1.60E-02, attack: 0.993, loss: 0.941424, ce: 0.128093, reg: 50.833176, reg_best: 49.480736
step:  92, cost: 1.60E-02, attack: 0.991, loss: 0.927168, ce: 0.147305, reg: 48.741428, reg_best: 48.741428
step:  93, cost: 1.60E-02, attack: 0.993, loss: 0.912224, ce: 0.104910, reg: 50.457108, reg_best: 48.741428
step:  94, cost: 1.60E-02, attack: 0.995, loss: 0.880463, ce: 0.084956, reg: 49.719212, reg_best: 48.741428
step:  95, cost: 1.60E-02, attack: 0.996, loss: 0.860486, ce: 0.072437, reg: 49.253075, reg_best: 48.741428
up cost from 1.60E-02 to 3.20E-02
step:  96, cost: 3.20E-02, attack: 0.989, loss: 1.726244, ce: 0.175839, reg: 48.450165, reg_best: 48.741428
step:  97, cost: 3.20E-02, attack: 0.989, loss: 1.693681, ce: 0.182840, reg: 47.213753, reg_best: 48.741428
step:  98, cost: 3.20E-02, attack: 0.982, loss: 1.787474, ce: 0.297182, reg: 46.571609, reg_best: 48.741428
step:  99, cost: 3.20E-02, attack: 0.987, loss: 1.665641, ce: 0.219691, reg: 45.185936, reg_best: 48.741428
pattern, shape: (32, 32, 3), min: 0.000008, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 18: 48.454575
visualization cost 20.167950 seconds
processing label 19
resetting state
mask_tanh -2.707475232452951 3.14120480629842
pattern_tanh -4.862246521710532 4.097472645080991
step:   0, cost: 0.00E+00, attack: 0.822, loss: 2.985309, ce: 2.985309, reg: 541.121765, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.003110, ce: 0.003110, reg: 567.963074, reg_best: 567.963074
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000010, ce: 0.000010, reg: 569.832153, reg_best: 567.963074
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000027, ce: 0.000027, reg: 571.256592, reg_best: 567.963074
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000004, ce: 0.000004, reg: 573.752991, reg_best: 567.963074
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 575.619934, reg_best: 567.963074
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.398720, ce: 0.052597, reg: 346.122833, reg_best: 346.122833
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.257944, ce: 0.025811, reg: 232.132782, reg_best: 232.132782
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.203126, ce: 0.005351, reg: 197.774918, reg_best: 197.774918
step:   9, cost: 1.00E-03, attack: 0.997, loss: 0.237914, ce: 0.049536, reg: 188.378464, reg_best: 188.378464
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 1.000, loss: 0.325820, ce: 0.005304, reg: 160.257767, reg_best: 160.257767
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.297977, ce: 0.019226, reg: 139.375641, reg_best: 139.375641
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.276579, ce: 0.014021, reg: 131.278839, reg_best: 131.278839
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.282620, ce: 0.018406, reg: 132.107162, reg_best: 131.278839
step:  14, cost: 2.00E-03, attack: 1.000, loss: 0.246168, ce: 0.001395, reg: 122.314606, reg_best: 122.314606
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.995, loss: 0.488788, ce: 0.089456, reg: 99.833099, reg_best: 99.833099
step:  16, cost: 4.00E-03, attack: 0.994, loss: 0.475754, ce: 0.103587, reg: 93.041756, reg_best: 93.041756
step:  17, cost: 4.00E-03, attack: 0.995, loss: 0.471080, ce: 0.091740, reg: 94.834946, reg_best: 93.041756
step:  18, cost: 4.00E-03, attack: 0.996, loss: 0.443676, ce: 0.066865, reg: 94.202721, reg_best: 93.041756
step:  19, cost: 4.00E-03, attack: 0.995, loss: 0.464870, ce: 0.091242, reg: 93.406883, reg_best: 93.041756
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.998, loss: 0.762987, ce: 0.045538, reg: 89.681129, reg_best: 89.681129
step:  21, cost: 8.00E-03, attack: 0.994, loss: 0.795692, ce: 0.107240, reg: 86.056541, reg_best: 86.056541
step:  22, cost: 8.00E-03, attack: 0.996, loss: 0.757120, ce: 0.058568, reg: 87.318977, reg_best: 86.056541
step:  23, cost: 8.00E-03, attack: 0.997, loss: 0.725488, ce: 0.047781, reg: 84.713448, reg_best: 84.713448
step:  24, cost: 8.00E-03, attack: 0.992, loss: 0.785606, ce: 0.143477, reg: 80.266014, reg_best: 80.266014
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.990, loss: 1.408983, ce: 0.169985, reg: 77.437393, reg_best: 80.266014
step:  26, cost: 1.60E-02, attack: 0.992, loss: 1.378259, ce: 0.142180, reg: 77.254913, reg_best: 77.254913
step:  27, cost: 1.60E-02, attack: 0.986, loss: 1.398119, ce: 0.234780, reg: 72.715187, reg_best: 77.254913
step:  28, cost: 1.60E-02, attack: 0.994, loss: 1.318368, ce: 0.096703, reg: 76.354057, reg_best: 76.354057
step:  29, cost: 1.60E-02, attack: 0.989, loss: 1.346238, ce: 0.174756, reg: 73.217606, reg_best: 76.354057
step:  30, cost: 1.60E-02, attack: 0.989, loss: 1.304381, ce: 0.186941, reg: 69.840027, reg_best: 76.354057
step:  31, cost: 1.60E-02, attack: 0.992, loss: 1.301326, ce: 0.141318, reg: 72.500504, reg_best: 72.500504
step:  32, cost: 1.60E-02, attack: 0.990, loss: 1.256954, ce: 0.170546, reg: 67.900520, reg_best: 72.500504
step:  33, cost: 1.60E-02, attack: 0.990, loss: 1.314409, ce: 0.169424, reg: 71.561554, reg_best: 72.500504
step:  34, cost: 1.60E-02, attack: 0.996, loss: 1.257534, ce: 0.053313, reg: 75.263863, reg_best: 72.500504
step:  35, cost: 1.60E-02, attack: 0.994, loss: 1.235797, ce: 0.111470, reg: 70.270401, reg_best: 70.270401
step:  36, cost: 1.60E-02, attack: 0.992, loss: 1.252685, ce: 0.120659, reg: 70.751640, reg_best: 70.270401
step:  37, cost: 1.60E-02, attack: 0.991, loss: 1.233762, ce: 0.139637, reg: 68.382828, reg_best: 68.382828
step:  38, cost: 1.60E-02, attack: 0.988, loss: 1.280665, ce: 0.204975, reg: 67.230659, reg_best: 68.382828
step:  39, cost: 1.60E-02, attack: 0.990, loss: 1.263927, ce: 0.167347, reg: 68.536240, reg_best: 68.382828
step:  40, cost: 1.60E-02, attack: 0.995, loss: 1.232652, ce: 0.079556, reg: 72.065704, reg_best: 68.382828
step:  41, cost: 1.60E-02, attack: 0.990, loss: 1.266570, ce: 0.178260, reg: 68.019333, reg_best: 68.382828
step:  42, cost: 1.60E-02, attack: 0.985, loss: 1.330216, ce: 0.247218, reg: 67.687347, reg_best: 68.382828
step:  43, cost: 1.60E-02, attack: 0.986, loss: 1.309559, ce: 0.210803, reg: 68.672272, reg_best: 68.382828
step:  44, cost: 1.60E-02, attack: 0.994, loss: 1.255915, ce: 0.114439, reg: 71.342239, reg_best: 68.382828
step:  45, cost: 1.60E-02, attack: 0.995, loss: 1.221111, ce: 0.090926, reg: 70.636566, reg_best: 68.382828
step:  46, cost: 1.60E-02, attack: 0.990, loss: 1.312467, ce: 0.173756, reg: 71.169449, reg_best: 68.382828
step:  47, cost: 1.60E-02, attack: 0.995, loss: 1.219471, ce: 0.092070, reg: 70.462578, reg_best: 68.382828
step:  48, cost: 1.60E-02, attack: 0.995, loss: 1.223912, ce: 0.085860, reg: 71.128250, reg_best: 68.382828
step:  49, cost: 1.60E-02, attack: 0.992, loss: 1.263365, ce: 0.140466, reg: 70.181221, reg_best: 68.382828
step:  50, cost: 1.60E-02, attack: 0.995, loss: 1.242846, ce: 0.089846, reg: 72.062492, reg_best: 68.382828
step:  51, cost: 1.60E-02, attack: 0.996, loss: 1.189465, ce: 0.060353, reg: 70.569534, reg_best: 68.382828
up cost from 1.60E-02 to 3.20E-02
step:  52, cost: 3.20E-02, attack: 0.987, loss: 2.301261, ce: 0.230041, reg: 64.725624, reg_best: 68.382828
step:  53, cost: 3.20E-02, attack: 0.989, loss: 2.273751, ce: 0.167674, reg: 65.808434, reg_best: 68.382828
step:  54, cost: 3.20E-02, attack: 0.987, loss: 2.410311, ce: 0.209495, reg: 68.775482, reg_best: 68.382828
step:  55, cost: 3.20E-02, attack: 0.991, loss: 2.259630, ce: 0.164213, reg: 65.481758, reg_best: 65.481758
step:  56, cost: 3.20E-02, attack: 0.993, loss: 2.261255, ce: 0.125768, reg: 66.733955, reg_best: 65.481758
step:  57, cost: 3.20E-02, attack: 0.991, loss: 2.290946, ce: 0.176095, reg: 66.089081, reg_best: 65.481758
step:  58, cost: 3.20E-02, attack: 0.982, loss: 2.360563, ce: 0.275081, reg: 65.171310, reg_best: 65.481758
step:  59, cost: 3.20E-02, attack: 0.986, loss: 2.308218, ce: 0.245470, reg: 64.460892, reg_best: 65.481758
step:  60, cost: 3.20E-02, attack: 0.983, loss: 2.290025, ce: 0.281491, reg: 62.766678, reg_best: 65.481758
step:  61, cost: 3.20E-02, attack: 0.982, loss: 2.287800, ce: 0.282735, reg: 62.658295, reg_best: 65.481758
step:  62, cost: 3.20E-02, attack: 0.989, loss: 2.357179, ce: 0.178929, reg: 68.070320, reg_best: 65.481758
down cost from 3.20E-02 to 1.13E-02
step:  63, cost: 1.13E-02, attack: 0.994, loss: 0.855272, ce: 0.105641, reg: 66.258713, reg_best: 65.481758
step:  64, cost: 1.13E-02, attack: 0.992, loss: 0.886757, ce: 0.131479, reg: 66.757812, reg_best: 65.481758
step:  65, cost: 1.13E-02, attack: 0.989, loss: 0.912164, ce: 0.186427, reg: 64.128189, reg_best: 65.481758
step:  66, cost: 1.13E-02, attack: 0.993, loss: 0.843126, ce: 0.134564, reg: 62.628563, reg_best: 62.628563
step:  67, cost: 1.13E-02, attack: 0.995, loss: 0.834455, ce: 0.084909, reg: 66.251083, reg_best: 62.628563
step:  68, cost: 1.13E-02, attack: 0.992, loss: 0.884382, ce: 0.118677, reg: 67.679451, reg_best: 62.628563
step:  69, cost: 1.13E-02, attack: 0.995, loss: 0.866181, ce: 0.080878, reg: 69.411690, reg_best: 62.628563
step:  70, cost: 1.13E-02, attack: 0.993, loss: 0.889639, ce: 0.119868, reg: 68.038841, reg_best: 62.628563
up cost from 1.13E-02 to 2.26E-02
step:  71, cost: 2.26E-02, attack: 0.988, loss: 1.676267, ce: 0.190117, reg: 65.679153, reg_best: 62.628563
step:  72, cost: 2.26E-02, attack: 0.996, loss: 1.614871, ce: 0.091041, reg: 67.344444, reg_best: 62.628563
step:  73, cost: 2.26E-02, attack: 0.991, loss: 1.683181, ce: 0.140668, reg: 68.170113, reg_best: 62.628563
step:  74, cost: 2.26E-02, attack: 0.986, loss: 1.719197, ce: 0.245248, reg: 65.139977, reg_best: 62.628563
step:  75, cost: 2.26E-02, attack: 0.987, loss: 1.649857, ce: 0.214835, reg: 63.419624, reg_best: 62.628563
step:  76, cost: 2.26E-02, attack: 0.977, loss: 1.700294, ce: 0.371095, reg: 58.742844, reg_best: 62.628563
step:  77, cost: 2.26E-02, attack: 0.989, loss: 1.615467, ce: 0.207058, reg: 62.243465, reg_best: 62.628563
step:  78, cost: 2.26E-02, attack: 0.977, loss: 1.725555, ce: 0.365239, reg: 60.109066, reg_best: 62.628563
down cost from 2.26E-02 to 8.00E-03
step:  79, cost: 8.00E-03, attack: 0.994, loss: 0.640437, ce: 0.118511, reg: 65.240799, reg_best: 62.628563
step:  80, cost: 8.00E-03, attack: 0.997, loss: 0.609219, ce: 0.066539, reg: 67.835060, reg_best: 62.628563
step:  81, cost: 8.00E-03, attack: 0.995, loss: 0.631751, ce: 0.084004, reg: 68.468452, reg_best: 62.628563
step:  82, cost: 8.00E-03, attack: 0.993, loss: 0.646639, ce: 0.118615, reg: 66.003006, reg_best: 62.628563
step:  83, cost: 8.00E-03, attack: 0.996, loss: 0.618524, ce: 0.074804, reg: 67.965042, reg_best: 62.628563
up cost from 8.00E-03 to 1.60E-02
step:  84, cost: 1.60E-02, attack: 0.994, loss: 1.150469, ce: 0.104346, reg: 65.382706, reg_best: 62.628563
step:  85, cost: 1.60E-02, attack: 0.995, loss: 1.170454, ce: 0.085301, reg: 67.822060, reg_best: 62.628563
step:  86, cost: 1.60E-02, attack: 0.994, loss: 1.166319, ce: 0.089027, reg: 67.330711, reg_best: 62.628563
step:  87, cost: 1.60E-02, attack: 0.993, loss: 1.165356, ce: 0.111984, reg: 65.835739, reg_best: 62.628563
step:  88, cost: 1.60E-02, attack: 0.993, loss: 1.144967, ce: 0.119319, reg: 64.102989, reg_best: 62.628563
up cost from 1.60E-02 to 3.20E-02
step:  89, cost: 3.20E-02, attack: 0.986, loss: 2.151604, ce: 0.232799, reg: 59.962666, reg_best: 62.628563
step:  90, cost: 3.20E-02, attack: 0.965, loss: 2.353351, ce: 0.567408, reg: 55.810711, reg_best: 62.628563
step:  91, cost: 3.20E-02, attack: 0.983, loss: 2.157459, ce: 0.285116, reg: 58.521889, reg_best: 62.628563
early stop
pattern, shape: (32, 32, 3), min: 0.000008, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 19: 67.162727
visualization cost 18.519117 seconds
processing label 20
resetting state
mask_tanh -3.4626147837542547 3.448425060076776
pattern_tanh -4.038211200469347 3.8905734008669635
step:   0, cost: 0.00E+00, attack: 0.850, loss: 2.489137, ce: 2.489137, reg: 556.025879, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.001617, ce: 0.001617, reg: 581.791321, reg_best: 581.791321
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000793, ce: 0.000793, reg: 588.566101, reg_best: 581.791321
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 590.815125, reg_best: 581.791321
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 591.109680, reg_best: 581.791321
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 592.066650, reg_best: 581.791321
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.998, loss: 0.434151, ce: 0.026978, reg: 407.172791, reg_best: 407.172791
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.318222, ce: 0.019237, reg: 298.985291, reg_best: 298.985291
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.264564, ce: 0.020023, reg: 244.540894, reg_best: 244.540894
step:   9, cost: 1.00E-03, attack: 1.000, loss: 0.215942, ce: 0.003977, reg: 211.964310, reg_best: 211.964310
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 1.000, loss: 0.363501, ce: 0.013882, reg: 174.809448, reg_best: 174.809448
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.357263, ce: 0.028646, reg: 164.308243, reg_best: 164.308243
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.331335, ce: 0.041965, reg: 144.854187, reg_best: 144.854187
step:  13, cost: 2.00E-03, attack: 0.998, loss: 0.305175, ce: 0.033455, reg: 135.860123, reg_best: 135.860123
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.288305, ce: 0.027248, reg: 130.528610, reg_best: 130.528610
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.998, loss: 0.534060, ce: 0.045457, reg: 122.150612, reg_best: 122.150612
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.528731, ce: 0.038502, reg: 122.557129, reg_best: 122.150612
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.504508, ce: 0.054144, reg: 112.590805, reg_best: 112.590805
step:  18, cost: 4.00E-03, attack: 0.993, loss: 0.531129, ce: 0.096814, reg: 108.578758, reg_best: 108.578758
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.454877, ce: 0.020225, reg: 108.662933, reg_best: 108.578758
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.997, loss: 0.917225, ce: 0.054449, reg: 107.846977, reg_best: 107.846977
step:  21, cost: 8.00E-03, attack: 0.997, loss: 0.905157, ce: 0.048560, reg: 107.074646, reg_best: 107.074646
step:  22, cost: 8.00E-03, attack: 0.995, loss: 0.869999, ce: 0.075362, reg: 99.329605, reg_best: 99.329605
step:  23, cost: 8.00E-03, attack: 0.999, loss: 0.829810, ce: 0.030940, reg: 99.858742, reg_best: 99.329605
step:  24, cost: 8.00E-03, attack: 0.996, loss: 0.847305, ce: 0.061171, reg: 98.235809, reg_best: 98.235809
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.994, loss: 1.571578, ce: 0.105434, reg: 91.634003, reg_best: 91.634003
step:  26, cost: 1.60E-02, attack: 0.995, loss: 1.514629, ce: 0.090160, reg: 89.029274, reg_best: 89.029274
step:  27, cost: 1.60E-02, attack: 0.986, loss: 1.609430, ce: 0.211992, reg: 87.339821, reg_best: 89.029274
step:  28, cost: 1.60E-02, attack: 0.992, loss: 1.551891, ce: 0.139525, reg: 88.272850, reg_best: 88.272850
step:  29, cost: 1.60E-02, attack: 0.988, loss: 1.538802, ce: 0.179336, reg: 84.966637, reg_best: 88.272850
step:  30, cost: 1.60E-02, attack: 0.996, loss: 1.457819, ce: 0.085426, reg: 85.774582, reg_best: 85.774582
step:  31, cost: 1.60E-02, attack: 0.992, loss: 1.494099, ce: 0.129696, reg: 85.275169, reg_best: 85.275169
step:  32, cost: 1.60E-02, attack: 0.994, loss: 1.475510, ce: 0.123942, reg: 84.472977, reg_best: 84.472977
step:  33, cost: 1.60E-02, attack: 0.993, loss: 1.432642, ce: 0.137325, reg: 80.957336, reg_best: 80.957336
step:  34, cost: 1.60E-02, attack: 0.988, loss: 1.496933, ce: 0.213535, reg: 80.212357, reg_best: 80.957336
step:  35, cost: 1.60E-02, attack: 0.995, loss: 1.409747, ce: 0.097258, reg: 82.030571, reg_best: 80.957336
step:  36, cost: 1.60E-02, attack: 0.992, loss: 1.437204, ce: 0.148869, reg: 80.520897, reg_best: 80.520897
step:  37, cost: 1.60E-02, attack: 0.996, loss: 1.340155, ce: 0.065418, reg: 79.680832, reg_best: 79.680832
step:  38, cost: 1.60E-02, attack: 0.987, loss: 1.426677, ce: 0.222981, reg: 75.230957, reg_best: 79.680832
step:  39, cost: 1.60E-02, attack: 0.993, loss: 1.396815, ce: 0.134984, reg: 78.864441, reg_best: 78.864441
step:  40, cost: 1.60E-02, attack: 0.991, loss: 1.365979, ce: 0.132562, reg: 77.088577, reg_best: 77.088577
step:  41, cost: 1.60E-02, attack: 0.991, loss: 1.399661, ce: 0.148932, reg: 78.170578, reg_best: 77.088577
step:  42, cost: 1.60E-02, attack: 0.988, loss: 1.371152, ce: 0.173760, reg: 74.837044, reg_best: 77.088577
step:  43, cost: 1.60E-02, attack: 0.995, loss: 1.313478, ce: 0.095255, reg: 76.138901, reg_best: 76.138901
step:  44, cost: 1.60E-02, attack: 0.984, loss: 1.404391, ce: 0.244439, reg: 72.496994, reg_best: 76.138901
step:  45, cost: 1.60E-02, attack: 0.993, loss: 1.304631, ce: 0.113514, reg: 74.444809, reg_best: 74.444809
step:  46, cost: 1.60E-02, attack: 0.996, loss: 1.298602, ce: 0.078352, reg: 76.265648, reg_best: 74.444809
step:  47, cost: 1.60E-02, attack: 0.977, loss: 1.517562, ce: 0.384036, reg: 70.845375, reg_best: 74.444809
step:  48, cost: 1.60E-02, attack: 0.992, loss: 1.327295, ce: 0.126322, reg: 75.060814, reg_best: 74.444809
step:  49, cost: 1.60E-02, attack: 0.995, loss: 1.267137, ce: 0.082735, reg: 74.025124, reg_best: 74.025124
step:  50, cost: 1.60E-02, attack: 0.997, loss: 1.233901, ce: 0.053550, reg: 73.776031, reg_best: 73.776031
step:  51, cost: 1.60E-02, attack: 0.994, loss: 1.297412, ce: 0.090295, reg: 75.444763, reg_best: 73.776031
step:  52, cost: 1.60E-02, attack: 0.993, loss: 1.289780, ce: 0.106367, reg: 73.963303, reg_best: 73.776031
up cost from 1.60E-02 to 3.20E-02
step:  53, cost: 3.20E-02, attack: 0.985, loss: 2.542644, ce: 0.232672, reg: 72.186623, reg_best: 73.776031
step:  54, cost: 3.20E-02, attack: 0.985, loss: 2.477517, ce: 0.249447, reg: 69.627174, reg_best: 73.776031
step:  55, cost: 3.20E-02, attack: 0.984, loss: 2.483946, ce: 0.266208, reg: 69.304306, reg_best: 73.776031
step:  56, cost: 3.20E-02, attack: 0.991, loss: 2.394039, ce: 0.150767, reg: 70.102242, reg_best: 70.102242
step:  57, cost: 3.20E-02, attack: 0.987, loss: 2.466993, ce: 0.229270, reg: 69.928856, reg_best: 70.102242
step:  58, cost: 3.20E-02, attack: 0.988, loss: 2.403035, ce: 0.203484, reg: 68.735992, reg_best: 70.102242
step:  59, cost: 3.20E-02, attack: 0.980, loss: 2.431447, ce: 0.305810, reg: 66.426132, reg_best: 70.102242
step:  60, cost: 3.20E-02, attack: 0.983, loss: 2.454878, ce: 0.256967, reg: 68.684708, reg_best: 70.102242
step:  61, cost: 3.20E-02, attack: 0.991, loss: 2.412623, ce: 0.167055, reg: 70.174011, reg_best: 70.102242
step:  62, cost: 3.20E-02, attack: 0.994, loss: 2.364783, ce: 0.120539, reg: 70.133057, reg_best: 70.102242
step:  63, cost: 3.20E-02, attack: 0.991, loss: 2.357374, ce: 0.168030, reg: 68.416992, reg_best: 68.416992
step:  64, cost: 3.20E-02, attack: 0.984, loss: 2.470542, ce: 0.269875, reg: 68.770851, reg_best: 68.416992
step:  65, cost: 3.20E-02, attack: 0.984, loss: 2.445003, ce: 0.267744, reg: 68.039352, reg_best: 68.416992
step:  66, cost: 3.20E-02, attack: 0.987, loss: 2.414406, ce: 0.210863, reg: 68.860695, reg_best: 68.416992
step:  67, cost: 3.20E-02, attack: 0.993, loss: 2.362524, ce: 0.153679, reg: 69.026398, reg_best: 68.416992
step:  68, cost: 3.20E-02, attack: 0.990, loss: 2.359318, ce: 0.179418, reg: 68.121887, reg_best: 68.416992
step:  69, cost: 3.20E-02, attack: 0.988, loss: 2.454737, ce: 0.204132, reg: 70.331398, reg_best: 68.416992
step:  70, cost: 3.20E-02, attack: 0.989, loss: 2.417897, ce: 0.192389, reg: 69.547119, reg_best: 68.416992
step:  71, cost: 3.20E-02, attack: 0.986, loss: 2.414896, ce: 0.252933, reg: 67.561356, reg_best: 68.416992
step:  72, cost: 3.20E-02, attack: 0.986, loss: 2.416049, ce: 0.214739, reg: 68.790916, reg_best: 68.416992
down cost from 3.20E-02 to 1.13E-02
step:  73, cost: 1.13E-02, attack: 0.992, loss: 0.958979, ce: 0.156754, reg: 70.907387, reg_best: 68.416992
step:  74, cost: 1.13E-02, attack: 0.994, loss: 0.921609, ce: 0.100079, reg: 72.613632, reg_best: 68.416992
step:  75, cost: 1.13E-02, attack: 0.993, loss: 0.941384, ce: 0.123983, reg: 72.246315, reg_best: 68.416992
step:  76, cost: 1.13E-02, attack: 0.993, loss: 0.961898, ce: 0.122474, reg: 74.195320, reg_best: 68.416992
step:  77, cost: 1.13E-02, attack: 0.996, loss: 0.878638, ce: 0.059841, reg: 72.372169, reg_best: 68.416992
up cost from 1.13E-02 to 2.26E-02
step:  78, cost: 2.26E-02, attack: 0.992, loss: 1.718905, ce: 0.148677, reg: 69.394943, reg_best: 68.416992
step:  79, cost: 2.26E-02, attack: 0.988, loss: 1.781482, ce: 0.209602, reg: 69.467972, reg_best: 68.416992
step:  80, cost: 2.26E-02, attack: 0.993, loss: 1.673299, ce: 0.125540, reg: 68.401924, reg_best: 68.401924
step:  81, cost: 2.26E-02, attack: 0.988, loss: 1.740104, ce: 0.189347, reg: 68.534447, reg_best: 68.401924
step:  82, cost: 2.26E-02, attack: 0.985, loss: 1.816449, ce: 0.258867, reg: 68.836075, reg_best: 68.401924
step:  83, cost: 2.26E-02, attack: 0.987, loss: 1.788405, ce: 0.205902, reg: 69.937408, reg_best: 68.401924
step:  84, cost: 2.26E-02, attack: 0.995, loss: 1.687877, ce: 0.105770, reg: 69.919891, reg_best: 68.401924
step:  85, cost: 2.26E-02, attack: 0.987, loss: 1.768877, ce: 0.203673, reg: 69.172890, reg_best: 68.401924
step:  86, cost: 2.26E-02, attack: 0.993, loss: 1.722244, ce: 0.121044, reg: 70.763702, reg_best: 68.401924
step:  87, cost: 2.26E-02, attack: 0.994, loss: 1.677251, ce: 0.102686, reg: 69.586609, reg_best: 68.401924
step:  88, cost: 2.26E-02, attack: 0.986, loss: 1.763216, ce: 0.219644, reg: 68.204773, reg_best: 68.401924
step:  89, cost: 2.26E-02, attack: 0.986, loss: 1.774740, ce: 0.220268, reg: 68.698639, reg_best: 68.401924
step:  90, cost: 2.26E-02, attack: 0.988, loss: 1.735518, ce: 0.195185, reg: 68.073730, reg_best: 68.401924
step:  91, cost: 2.26E-02, attack: 0.992, loss: 1.717650, ce: 0.153870, reg: 69.109970, reg_best: 68.401924
step:  92, cost: 2.26E-02, attack: 0.991, loss: 1.699573, ce: 0.167269, reg: 67.718887, reg_best: 67.718887
step:  93, cost: 2.26E-02, attack: 0.993, loss: 1.712860, ce: 0.148417, reg: 69.139275, reg_best: 67.718887
step:  94, cost: 2.26E-02, attack: 0.992, loss: 1.707857, ce: 0.151405, reg: 68.786140, reg_best: 67.718887
step:  95, cost: 2.26E-02, attack: 0.989, loss: 1.767528, ce: 0.184256, reg: 69.971420, reg_best: 67.718887
step:  96, cost: 2.26E-02, attack: 0.996, loss: 1.684135, ce: 0.079333, reg: 70.922920, reg_best: 67.718887
step:  97, cost: 2.26E-02, attack: 0.989, loss: 1.742818, ce: 0.178122, reg: 69.150429, reg_best: 67.718887
step:  98, cost: 2.26E-02, attack: 0.991, loss: 1.713204, ce: 0.148098, reg: 69.168594, reg_best: 67.718887
step:  99, cost: 2.26E-02, attack: 0.987, loss: 1.809267, ce: 0.199601, reg: 71.137840, reg_best: 67.718887
pattern, shape: (32, 32, 3), min: 0.000000, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 20: 69.412552
visualization cost 20.220504 seconds
processing label 21
resetting state
mask_tanh -3.3474470867126245 4.299114465883746
pattern_tanh -4.78197707862291 3.4194764011451344
step:   0, cost: 0.00E+00, attack: 0.880, loss: 1.973756, ce: 1.973756, reg: 532.851685, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000784, ce: 0.000784, reg: 543.578308, reg_best: 543.578308
step:   2, cost: 0.00E+00, attack: 0.999, loss: 0.016175, ce: 0.016175, reg: 550.448181, reg_best: 543.578308
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 551.975952, reg_best: 543.578308
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000007, ce: 0.000007, reg: 552.014465, reg_best: 543.578308
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 557.942810, reg_best: 543.578308
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 1.000, loss: 0.381933, ce: 0.008716, reg: 373.217407, reg_best: 373.217407
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.264416, ce: 0.007782, reg: 256.634003, reg_best: 256.634003
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.212534, ce: 0.024678, reg: 187.856216, reg_best: 187.856216
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.175672, ce: 0.011444, reg: 164.228210, reg_best: 164.228210
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.998, loss: 0.311737, ce: 0.041568, reg: 135.084381, reg_best: 135.084381
step:  11, cost: 2.00E-03, attack: 1.000, loss: 0.262354, ce: 0.009026, reg: 126.664291, reg_best: 126.664291
step:  12, cost: 2.00E-03, attack: 0.994, loss: 0.309398, ce: 0.076281, reg: 116.558357, reg_best: 116.558357
step:  13, cost: 2.00E-03, attack: 1.000, loss: 0.240440, ce: 0.006267, reg: 117.072540, reg_best: 116.558357
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.226295, ce: 0.015692, reg: 105.301666, reg_best: 105.301666
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 1.000, loss: 0.381211, ce: 0.014712, reg: 91.624641, reg_best: 91.624641
step:  16, cost: 4.00E-03, attack: 0.999, loss: 0.354364, ce: 0.011874, reg: 85.622604, reg_best: 85.622604
step:  17, cost: 4.00E-03, attack: 0.996, loss: 0.401728, ce: 0.057065, reg: 86.165779, reg_best: 85.622604
step:  18, cost: 4.00E-03, attack: 0.998, loss: 0.361051, ce: 0.029358, reg: 82.923050, reg_best: 82.923050
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.375880, ce: 0.030523, reg: 86.339409, reg_best: 82.923050
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.991, loss: 0.764044, ce: 0.140764, reg: 77.909988, reg_best: 77.909988
step:  21, cost: 8.00E-03, attack: 0.999, loss: 0.644971, ce: 0.027655, reg: 77.164444, reg_best: 77.164444
step:  22, cost: 8.00E-03, attack: 0.996, loss: 0.674569, ce: 0.072432, reg: 75.267097, reg_best: 75.267097
step:  23, cost: 8.00E-03, attack: 0.994, loss: 0.655872, ce: 0.083652, reg: 71.527519, reg_best: 71.527519
step:  24, cost: 8.00E-03, attack: 0.996, loss: 0.657975, ce: 0.069924, reg: 73.506363, reg_best: 71.527519
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.993, loss: 1.252956, ce: 0.124999, reg: 70.497322, reg_best: 70.497322
step:  26, cost: 1.60E-02, attack: 0.994, loss: 1.227364, ce: 0.092171, reg: 70.935051, reg_best: 70.497322
step:  27, cost: 1.60E-02, attack: 0.992, loss: 1.172561, ce: 0.131039, reg: 65.095139, reg_best: 65.095139
step:  28, cost: 1.60E-02, attack: 0.990, loss: 1.208804, ce: 0.148883, reg: 66.245049, reg_best: 65.095139
step:  29, cost: 1.60E-02, attack: 0.993, loss: 1.192104, ce: 0.114842, reg: 67.328896, reg_best: 65.095139
step:  30, cost: 1.60E-02, attack: 0.995, loss: 1.156467, ce: 0.106076, reg: 65.649452, reg_best: 65.095139
step:  31, cost: 1.60E-02, attack: 0.994, loss: 1.166972, ce: 0.099131, reg: 66.740059, reg_best: 65.095139
step:  32, cost: 1.60E-02, attack: 0.993, loss: 1.175030, ce: 0.118894, reg: 66.008522, reg_best: 65.095139
step:  33, cost: 1.60E-02, attack: 0.996, loss: 1.155584, ce: 0.079123, reg: 67.278854, reg_best: 65.095139
up cost from 1.60E-02 to 3.20E-02
step:  34, cost: 3.20E-02, attack: 0.991, loss: 2.218557, ce: 0.148290, reg: 64.695854, reg_best: 64.695854
step:  35, cost: 3.20E-02, attack: 0.986, loss: 2.226724, ce: 0.226219, reg: 62.515781, reg_best: 64.695854
step:  36, cost: 3.20E-02, attack: 0.983, loss: 2.259267, ce: 0.292035, reg: 61.475990, reg_best: 64.695854
step:  37, cost: 3.20E-02, attack: 0.989, loss: 2.206213, ce: 0.186263, reg: 63.123421, reg_best: 64.695854
step:  38, cost: 3.20E-02, attack: 0.989, loss: 2.096099, ce: 0.176289, reg: 59.994061, reg_best: 64.695854
step:  39, cost: 3.20E-02, attack: 0.987, loss: 2.177358, ce: 0.242683, reg: 60.467758, reg_best: 64.695854
down cost from 3.20E-02 to 1.13E-02
step:  40, cost: 1.13E-02, attack: 0.998, loss: 0.777021, ce: 0.050546, reg: 64.211861, reg_best: 64.211861
step:  41, cost: 1.13E-02, attack: 0.990, loss: 0.883279, ce: 0.156235, reg: 64.262230, reg_best: 64.211861
step:  42, cost: 1.13E-02, attack: 0.993, loss: 0.821527, ce: 0.096956, reg: 64.043549, reg_best: 64.043549
step:  43, cost: 1.13E-02, attack: 0.996, loss: 0.825573, ce: 0.067189, reg: 67.032310, reg_best: 64.043549
step:  44, cost: 1.13E-02, attack: 0.995, loss: 0.824110, ce: 0.089522, reg: 64.928986, reg_best: 64.043549
step:  45, cost: 1.13E-02, attack: 0.991, loss: 0.866786, ce: 0.134756, reg: 64.702934, reg_best: 64.043549
step:  46, cost: 1.13E-02, attack: 0.994, loss: 0.844148, ce: 0.093669, reg: 66.333542, reg_best: 64.043549
up cost from 1.13E-02 to 2.26E-02
step:  47, cost: 2.26E-02, attack: 0.988, loss: 1.587706, ce: 0.202326, reg: 61.225739, reg_best: 64.043549
step:  48, cost: 2.26E-02, attack: 0.982, loss: 1.623120, ce: 0.270304, reg: 59.786579, reg_best: 64.043549
step:  49, cost: 2.26E-02, attack: 0.991, loss: 1.518273, ce: 0.162458, reg: 59.919121, reg_best: 59.919121
step:  50, cost: 2.26E-02, attack: 0.990, loss: 1.543146, ce: 0.177852, reg: 60.338024, reg_best: 59.919121
step:  51, cost: 2.26E-02, attack: 0.982, loss: 1.660183, ce: 0.274158, reg: 61.254219, reg_best: 59.919121
step:  52, cost: 2.26E-02, attack: 0.989, loss: 1.595788, ce: 0.169915, reg: 63.023502, reg_best: 59.919121
step:  53, cost: 2.26E-02, attack: 0.990, loss: 1.566228, ce: 0.181227, reg: 61.208961, reg_best: 59.919121
step:  54, cost: 2.26E-02, attack: 0.995, loss: 1.544766, ce: 0.073818, reg: 65.007294, reg_best: 59.919121
step:  55, cost: 2.26E-02, attack: 0.989, loss: 1.574603, ce: 0.189248, reg: 61.224621, reg_best: 59.919121
step:  56, cost: 2.26E-02, attack: 0.988, loss: 1.593314, ce: 0.206405, reg: 61.293297, reg_best: 59.919121
step:  57, cost: 2.26E-02, attack: 0.988, loss: 1.554724, ce: 0.207618, reg: 59.534256, reg_best: 59.919121
step:  58, cost: 2.26E-02, attack: 0.991, loss: 1.504022, ce: 0.153355, reg: 59.691612, reg_best: 59.691612
step:  59, cost: 2.26E-02, attack: 0.995, loss: 1.492851, ce: 0.091408, reg: 61.935612, reg_best: 59.691612
step:  60, cost: 2.26E-02, attack: 0.981, loss: 1.688874, ce: 0.327352, reg: 60.171333, reg_best: 59.691612
step:  61, cost: 2.26E-02, attack: 0.992, loss: 1.516346, ce: 0.139701, reg: 60.839687, reg_best: 59.691612
step:  62, cost: 2.26E-02, attack: 0.994, loss: 1.494555, ce: 0.109910, reg: 61.193233, reg_best: 59.691612
step:  63, cost: 2.26E-02, attack: 0.989, loss: 1.576245, ce: 0.176026, reg: 61.881496, reg_best: 59.691612
step:  64, cost: 2.26E-02, attack: 0.990, loss: 1.530590, ce: 0.176693, reg: 59.820175, reg_best: 59.691612
step:  65, cost: 2.26E-02, attack: 0.980, loss: 1.644404, ce: 0.290764, reg: 59.823025, reg_best: 59.691612
step:  66, cost: 2.26E-02, attack: 0.995, loss: 1.444575, ce: 0.101637, reg: 59.350044, reg_best: 59.350044
step:  67, cost: 2.26E-02, attack: 0.989, loss: 1.496475, ce: 0.188374, reg: 57.810455, reg_best: 59.350044
step:  68, cost: 2.26E-02, attack: 0.988, loss: 1.527636, ce: 0.197495, reg: 58.784470, reg_best: 59.350044
step:  69, cost: 2.26E-02, attack: 0.991, loss: 1.503463, ce: 0.150436, reg: 59.795910, reg_best: 59.350044
step:  70, cost: 2.26E-02, attack: 0.990, loss: 1.522400, ce: 0.176708, reg: 59.471767, reg_best: 59.350044
step:  71, cost: 2.26E-02, attack: 0.990, loss: 1.524358, ce: 0.186316, reg: 59.133671, reg_best: 59.350044
step:  72, cost: 2.26E-02, attack: 0.990, loss: 1.527154, ce: 0.162261, reg: 60.320320, reg_best: 59.350044
step:  73, cost: 2.26E-02, attack: 0.993, loss: 1.499036, ce: 0.120261, reg: 60.933853, reg_best: 59.350044
step:  74, cost: 2.26E-02, attack: 0.993, loss: 1.487365, ce: 0.119939, reg: 60.432251, reg_best: 59.350044
step:  75, cost: 2.26E-02, attack: 0.987, loss: 1.546872, ce: 0.211376, reg: 59.021111, reg_best: 59.350044
step:  76, cost: 2.26E-02, attack: 0.988, loss: 1.570741, ce: 0.207611, reg: 60.242386, reg_best: 59.350044
step:  77, cost: 2.26E-02, attack: 0.976, loss: 1.679300, ce: 0.398209, reg: 56.620987, reg_best: 59.350044
step:  78, cost: 2.26E-02, attack: 0.993, loss: 1.473553, ce: 0.131774, reg: 59.298794, reg_best: 59.298794
step:  79, cost: 2.26E-02, attack: 0.986, loss: 1.549979, ce: 0.236348, reg: 58.054867, reg_best: 59.298794
step:  80, cost: 2.26E-02, attack: 0.984, loss: 1.593776, ce: 0.251639, reg: 59.314629, reg_best: 59.298794
step:  81, cost: 2.26E-02, attack: 0.991, loss: 1.511798, ce: 0.162521, reg: 59.630211, reg_best: 59.298794
step:  82, cost: 2.26E-02, attack: 0.991, loss: 1.527675, ce: 0.165983, reg: 60.178867, reg_best: 59.298794
step:  83, cost: 2.26E-02, attack: 0.989, loss: 1.541169, ce: 0.174690, reg: 60.390404, reg_best: 59.298794
step:  84, cost: 2.26E-02, attack: 0.988, loss: 1.589972, ce: 0.204088, reg: 61.247982, reg_best: 59.298794
step:  85, cost: 2.26E-02, attack: 0.990, loss: 1.536212, ce: 0.190658, reg: 59.465626, reg_best: 59.298794
step:  86, cost: 2.26E-02, attack: 0.987, loss: 1.591587, ce: 0.215925, reg: 60.796230, reg_best: 59.298794
step:  87, cost: 2.26E-02, attack: 0.991, loss: 1.522291, ce: 0.144204, reg: 60.903419, reg_best: 59.298794
step:  88, cost: 2.26E-02, attack: 0.994, loss: 1.500069, ce: 0.100021, reg: 61.873955, reg_best: 59.298794
step:  89, cost: 2.26E-02, attack: 0.982, loss: 1.638110, ce: 0.279262, reg: 60.053158, reg_best: 59.298794
step:  90, cost: 2.26E-02, attack: 0.994, loss: 1.490242, ce: 0.109278, reg: 61.029922, reg_best: 59.298794
step:  91, cost: 2.26E-02, attack: 0.986, loss: 1.565159, ce: 0.244570, reg: 58.362331, reg_best: 59.298794
step:  92, cost: 2.26E-02, attack: 0.993, loss: 1.506191, ce: 0.118905, reg: 61.309967, reg_best: 59.298794
step:  93, cost: 2.26E-02, attack: 0.988, loss: 1.556607, ce: 0.198718, reg: 60.010822, reg_best: 59.298794
step:  94, cost: 2.26E-02, attack: 0.990, loss: 1.556798, ce: 0.180276, reg: 60.834297, reg_best: 59.298794
step:  95, cost: 2.26E-02, attack: 0.993, loss: 1.476668, ce: 0.134528, reg: 59.314747, reg_best: 59.298794
step:  96, cost: 2.26E-02, attack: 0.986, loss: 1.544384, ce: 0.232575, reg: 57.974277, reg_best: 59.298794
step:  97, cost: 2.26E-02, attack: 0.976, loss: 1.676604, ce: 0.375279, reg: 57.510944, reg_best: 59.298794
step:  98, cost: 2.26E-02, attack: 0.984, loss: 1.567722, ce: 0.254462, reg: 58.038445, reg_best: 59.298794
step:  99, cost: 2.26E-02, attack: 0.993, loss: 1.500334, ce: 0.115730, reg: 61.191418, reg_best: 59.298794
pattern, shape: (32, 32, 3), min: 0.000015, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 21: 58.488174
visualization cost 22.076390 seconds
processing label 22
resetting state
mask_tanh -4.468992489381314 3.4568958261318556
pattern_tanh -4.213732486512579 4.390411081880831
step:   0, cost: 0.00E+00, attack: 0.811, loss: 3.161422, ce: 3.161422, reg: 518.427124, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000384, ce: 0.000384, reg: 545.619324, reg_best: 545.619324
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000030, ce: 0.000030, reg: 549.329590, reg_best: 545.619324
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 549.943909, reg_best: 545.619324
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000003, ce: 0.000003, reg: 551.062012, reg_best: 545.619324
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 553.221252, reg_best: 545.619324
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.446022, ce: 0.046654, reg: 399.367340, reg_best: 399.367340
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.300987, ce: 0.018550, reg: 282.437134, reg_best: 282.437134
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.253157, ce: 0.012274, reg: 240.882538, reg_best: 240.882538
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.211402, ce: 0.017451, reg: 193.950943, reg_best: 193.950943
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.997, loss: 0.370486, ce: 0.048886, reg: 160.799896, reg_best: 160.799896
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.331304, ce: 0.038309, reg: 146.497467, reg_best: 146.497467
step:  12, cost: 2.00E-03, attack: 1.000, loss: 0.274666, ce: 0.008993, reg: 132.836502, reg_best: 132.836502
step:  13, cost: 2.00E-03, attack: 0.994, loss: 0.353181, ce: 0.092652, reg: 130.264679, reg_best: 130.264679
step:  14, cost: 2.00E-03, attack: 1.000, loss: 0.253648, ce: 0.006197, reg: 123.725746, reg_best: 123.725746
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.998, loss: 0.502437, ce: 0.037471, reg: 116.251808, reg_best: 116.251808
step:  16, cost: 4.00E-03, attack: 0.999, loss: 0.471354, ce: 0.016464, reg: 113.722321, reg_best: 113.722321
step:  17, cost: 4.00E-03, attack: 0.996, loss: 0.505281, ce: 0.070572, reg: 108.677185, reg_best: 108.677185
step:  18, cost: 4.00E-03, attack: 0.995, loss: 0.505625, ce: 0.075178, reg: 107.611748, reg_best: 107.611748
step:  19, cost: 4.00E-03, attack: 0.995, loss: 0.497559, ce: 0.087192, reg: 102.591805, reg_best: 102.591805
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.993, loss: 0.937983, ce: 0.103359, reg: 104.328056, reg_best: 102.591805
step:  21, cost: 8.00E-03, attack: 0.993, loss: 0.909734, ce: 0.117801, reg: 98.991539, reg_best: 98.991539
step:  22, cost: 8.00E-03, attack: 0.997, loss: 0.838596, ce: 0.049211, reg: 98.673096, reg_best: 98.673096
step:  23, cost: 8.00E-03, attack: 0.993, loss: 0.857662, ce: 0.107799, reg: 93.732971, reg_best: 93.732971
step:  24, cost: 8.00E-03, attack: 0.993, loss: 0.822847, ce: 0.111340, reg: 88.938316, reg_best: 88.938316
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.986, loss: 1.638600, ce: 0.249688, reg: 86.806999, reg_best: 88.938316
step:  26, cost: 1.60E-02, attack: 0.989, loss: 1.540219, ce: 0.187095, reg: 84.570274, reg_best: 88.938316
step:  27, cost: 1.60E-02, attack: 0.989, loss: 1.571755, ce: 0.187494, reg: 86.516281, reg_best: 88.938316
step:  28, cost: 1.60E-02, attack: 0.993, loss: 1.541906, ce: 0.108579, reg: 89.550323, reg_best: 88.938316
step:  29, cost: 1.60E-02, attack: 0.996, loss: 1.519882, ce: 0.082916, reg: 89.810356, reg_best: 88.938316
step:  30, cost: 1.60E-02, attack: 0.995, loss: 1.468607, ce: 0.114335, reg: 84.642014, reg_best: 84.642014
step:  31, cost: 1.60E-02, attack: 0.987, loss: 1.515174, ce: 0.228476, reg: 80.418663, reg_best: 84.642014
step:  32, cost: 1.60E-02, attack: 0.991, loss: 1.462665, ce: 0.149712, reg: 82.059578, reg_best: 82.059578
step:  33, cost: 1.60E-02, attack: 0.992, loss: 1.481768, ce: 0.143540, reg: 83.639290, reg_best: 82.059578
step:  34, cost: 1.60E-02, attack: 0.995, loss: 1.426515, ce: 0.088701, reg: 83.613358, reg_best: 82.059578
step:  35, cost: 1.60E-02, attack: 0.988, loss: 1.479271, ce: 0.197868, reg: 80.087669, reg_best: 82.059578
step:  36, cost: 1.60E-02, attack: 0.986, loss: 1.483896, ce: 0.236957, reg: 77.933723, reg_best: 82.059578
step:  37, cost: 1.60E-02, attack: 0.993, loss: 1.480908, ce: 0.138883, reg: 83.876534, reg_best: 82.059578
step:  38, cost: 1.60E-02, attack: 0.995, loss: 1.410894, ce: 0.091994, reg: 82.431229, reg_best: 82.059578
step:  39, cost: 1.60E-02, attack: 0.988, loss: 1.461600, ce: 0.196571, reg: 79.064278, reg_best: 82.059578
step:  40, cost: 1.60E-02, attack: 0.989, loss: 1.447085, ce: 0.169322, reg: 79.860207, reg_best: 82.059578
step:  41, cost: 1.60E-02, attack: 0.995, loss: 1.376209, ce: 0.079629, reg: 81.046280, reg_best: 81.046280
step:  42, cost: 1.60E-02, attack: 0.989, loss: 1.472882, ce: 0.180536, reg: 80.771645, reg_best: 81.046280
step:  43, cost: 1.60E-02, attack: 0.988, loss: 1.477110, ce: 0.199981, reg: 79.820580, reg_best: 81.046280
step:  44, cost: 1.60E-02, attack: 0.992, loss: 1.428998, ce: 0.137393, reg: 80.725334, reg_best: 80.725334
step:  45, cost: 1.60E-02, attack: 0.993, loss: 1.409629, ce: 0.121076, reg: 80.534569, reg_best: 80.534569
step:  46, cost: 1.60E-02, attack: 0.994, loss: 1.432842, ce: 0.106647, reg: 82.887154, reg_best: 80.534569
step:  47, cost: 1.60E-02, attack: 0.991, loss: 1.432634, ce: 0.153038, reg: 79.974770, reg_best: 79.974770
step:  48, cost: 1.60E-02, attack: 0.992, loss: 1.382516, ce: 0.148480, reg: 77.127258, reg_best: 77.127258
up cost from 1.60E-02 to 3.20E-02
step:  49, cost: 3.20E-02, attack: 0.985, loss: 2.695791, ce: 0.263324, reg: 76.014610, reg_best: 77.127258
step:  50, cost: 3.20E-02, attack: 0.971, loss: 2.832974, ce: 0.480023, reg: 73.529694, reg_best: 77.127258
step:  51, cost: 3.20E-02, attack: 0.978, loss: 2.730306, ce: 0.377108, reg: 73.537430, reg_best: 77.127258
step:  52, cost: 3.20E-02, attack: 0.986, loss: 2.738659, ce: 0.251766, reg: 77.715401, reg_best: 77.127258
step:  53, cost: 3.20E-02, attack: 0.988, loss: 2.658417, ce: 0.208206, reg: 76.569069, reg_best: 77.127258
down cost from 3.20E-02 to 1.13E-02
step:  54, cost: 1.13E-02, attack: 0.992, loss: 1.064164, ce: 0.142003, reg: 81.494720, reg_best: 77.127258
step:  55, cost: 1.13E-02, attack: 0.992, loss: 1.039482, ce: 0.124018, reg: 80.916420, reg_best: 77.127258
step:  56, cost: 1.13E-02, attack: 0.995, loss: 1.010375, ce: 0.089612, reg: 81.384758, reg_best: 77.127258
step:  57, cost: 1.13E-02, attack: 0.993, loss: 1.053761, ce: 0.126542, reg: 81.955345, reg_best: 77.127258
step:  58, cost: 1.13E-02, attack: 0.997, loss: 0.987416, ce: 0.066532, reg: 81.395416, reg_best: 77.127258
up cost from 1.13E-02 to 2.26E-02
step:  59, cost: 2.26E-02, attack: 0.990, loss: 1.951239, ce: 0.156563, reg: 79.314194, reg_best: 77.127258
step:  60, cost: 2.26E-02, attack: 0.992, loss: 1.872757, ce: 0.154956, reg: 75.916786, reg_best: 75.916786
step:  61, cost: 2.26E-02, attack: 0.989, loss: 1.956646, ce: 0.197359, reg: 77.750221, reg_best: 75.916786
step:  62, cost: 2.26E-02, attack: 0.987, loss: 1.952368, ce: 0.186185, reg: 78.054985, reg_best: 75.916786
step:  63, cost: 2.26E-02, attack: 0.992, loss: 1.922881, ce: 0.126683, reg: 79.381454, reg_best: 75.916786
step:  64, cost: 2.26E-02, attack: 0.992, loss: 1.907413, ce: 0.146848, reg: 77.806709, reg_best: 75.916786
step:  65, cost: 2.26E-02, attack: 0.990, loss: 1.954270, ce: 0.181325, reg: 78.353844, reg_best: 75.916786
step:  66, cost: 2.26E-02, attack: 0.990, loss: 1.933483, ce: 0.156686, reg: 78.505447, reg_best: 75.916786
step:  67, cost: 2.26E-02, attack: 0.989, loss: 1.923547, ce: 0.190771, reg: 76.578568, reg_best: 75.916786
step:  68, cost: 2.26E-02, attack: 0.993, loss: 1.866273, ce: 0.145214, reg: 76.060791, reg_best: 75.916786
step:  69, cost: 2.26E-02, attack: 0.988, loss: 1.963940, ce: 0.208246, reg: 77.591423, reg_best: 75.916786
step:  70, cost: 2.26E-02, attack: 0.990, loss: 1.939260, ce: 0.168632, reg: 78.251427, reg_best: 75.916786
step:  71, cost: 2.26E-02, attack: 0.993, loss: 1.873120, ce: 0.118116, reg: 77.560959, reg_best: 75.916786
step:  72, cost: 2.26E-02, attack: 0.986, loss: 1.977890, ce: 0.230617, reg: 77.219269, reg_best: 75.916786
step:  73, cost: 2.26E-02, attack: 0.995, loss: 1.867172, ce: 0.104369, reg: 77.905663, reg_best: 75.916786
step:  74, cost: 2.26E-02, attack: 0.988, loss: 1.937750, ce: 0.205458, reg: 76.557182, reg_best: 75.916786
step:  75, cost: 2.26E-02, attack: 0.990, loss: 1.920868, ce: 0.167350, reg: 77.495285, reg_best: 75.916786
step:  76, cost: 2.26E-02, attack: 0.988, loss: 1.934786, ce: 0.217778, reg: 75.881767, reg_best: 75.916786
step:  77, cost: 2.26E-02, attack: 0.990, loss: 1.888293, ce: 0.184831, reg: 75.283119, reg_best: 75.916786
step:  78, cost: 2.26E-02, attack: 0.992, loss: 1.856462, ce: 0.142439, reg: 75.749802, reg_best: 75.749802
step:  79, cost: 2.26E-02, attack: 0.995, loss: 1.889872, ce: 0.105586, reg: 78.865494, reg_best: 75.749802
step:  80, cost: 2.26E-02, attack: 0.990, loss: 1.930757, ce: 0.165073, reg: 78.032959, reg_best: 75.749802
step:  81, cost: 2.26E-02, attack: 0.987, loss: 1.908596, ce: 0.226821, reg: 74.324623, reg_best: 75.749802
step:  82, cost: 2.26E-02, attack: 0.987, loss: 1.920456, ce: 0.229774, reg: 74.718277, reg_best: 75.749802
step:  83, cost: 2.26E-02, attack: 0.995, loss: 1.833588, ce: 0.105601, reg: 76.366913, reg_best: 75.749802
step:  84, cost: 2.26E-02, attack: 0.991, loss: 1.887074, ce: 0.149838, reg: 76.775703, reg_best: 75.749802
step:  85, cost: 2.26E-02, attack: 0.991, loss: 1.872349, ce: 0.159203, reg: 75.711090, reg_best: 75.711090
step:  86, cost: 2.26E-02, attack: 0.989, loss: 1.939526, ce: 0.149569, reg: 79.105637, reg_best: 75.711090
step:  87, cost: 2.26E-02, attack: 0.995, loss: 1.838037, ce: 0.089671, reg: 77.267593, reg_best: 75.711090
step:  88, cost: 2.26E-02, attack: 0.988, loss: 1.916453, ce: 0.217716, reg: 75.074287, reg_best: 75.711090
step:  89, cost: 2.26E-02, attack: 0.983, loss: 1.973380, ce: 0.274434, reg: 75.083542, reg_best: 75.711090
step:  90, cost: 2.26E-02, attack: 0.992, loss: 1.851741, ce: 0.147000, reg: 75.339600, reg_best: 75.339600
step:  91, cost: 2.26E-02, attack: 0.985, loss: 1.921788, ce: 0.250090, reg: 73.879311, reg_best: 75.339600
step:  92, cost: 2.26E-02, attack: 0.990, loss: 1.877704, ce: 0.196361, reg: 74.316299, reg_best: 75.339600
step:  93, cost: 2.26E-02, attack: 0.986, loss: 1.986766, ce: 0.241111, reg: 77.147766, reg_best: 75.339600
step:  94, cost: 2.26E-02, attack: 0.991, loss: 1.940358, ce: 0.170483, reg: 78.218163, reg_best: 75.339600
step:  95, cost: 2.26E-02, attack: 0.990, loss: 1.926240, ce: 0.176344, reg: 77.335213, reg_best: 75.339600
step:  96, cost: 2.26E-02, attack: 0.990, loss: 1.869050, ce: 0.174952, reg: 74.869247, reg_best: 75.339600
step:  97, cost: 2.26E-02, attack: 0.990, loss: 1.912406, ce: 0.181486, reg: 76.496582, reg_best: 75.339600
step:  98, cost: 2.26E-02, attack: 0.995, loss: 1.815186, ce: 0.074047, reg: 76.948174, reg_best: 75.339600
step:  99, cost: 2.26E-02, attack: 0.993, loss: 1.853858, ce: 0.126841, reg: 76.324120, reg_best: 75.339600
pattern, shape: (32, 32, 3), min: 0.000000, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 22: 72.472153
visualization cost 20.070739 seconds
processing label 23
resetting state
mask_tanh -3.6249121992253244 3.3770936551004205
pattern_tanh -6.72898242031565 3.7093783760919314
step:   0, cost: 0.00E+00, attack: 0.885, loss: 1.916589, ce: 1.916589, reg: 565.879822, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000836, ce: 0.000836, reg: 578.092957, reg_best: 578.092957
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 578.163147, reg_best: 578.092957
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000373, ce: 0.000373, reg: 582.544006, reg_best: 578.092957
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000060, ce: 0.000060, reg: 593.522827, reg_best: 578.092957
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 594.521545, reg_best: 578.092957
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.991, loss: 0.458399, ce: 0.144155, reg: 314.243225, reg_best: 314.243225
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.226460, ce: 0.012871, reg: 213.588989, reg_best: 213.588989
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.196620, ce: 0.007921, reg: 188.698761, reg_best: 188.698761
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.174364, ce: 0.016263, reg: 158.101044, reg_best: 158.101044
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.998, loss: 0.292728, ce: 0.027457, reg: 132.635147, reg_best: 132.635147
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.255574, ce: 0.031435, reg: 112.069366, reg_best: 112.069366
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.231661, ce: 0.014022, reg: 108.819618, reg_best: 108.819618
step:  13, cost: 2.00E-03, attack: 0.997, loss: 0.252014, ce: 0.053234, reg: 99.389961, reg_best: 99.389961
step:  14, cost: 2.00E-03, attack: 0.997, loss: 0.230448, ce: 0.047189, reg: 91.629333, reg_best: 91.629333
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.996, loss: 0.418544, ce: 0.071062, reg: 86.870575, reg_best: 86.870575
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.369813, ce: 0.038007, reg: 82.951485, reg_best: 82.951485
step:  17, cost: 4.00E-03, attack: 0.992, loss: 0.424919, ce: 0.132771, reg: 73.009102, reg_best: 73.009102
step:  18, cost: 4.00E-03, attack: 0.999, loss: 0.345392, ce: 0.026209, reg: 79.795830, reg_best: 73.009102
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.347237, ce: 0.038436, reg: 77.200363, reg_best: 73.009102
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.997, loss: 0.609976, ce: 0.048248, reg: 70.215881, reg_best: 70.215881
step:  21, cost: 8.00E-03, attack: 0.995, loss: 0.647266, ce: 0.086507, reg: 70.094917, reg_best: 70.094917
step:  22, cost: 8.00E-03, attack: 0.989, loss: 0.700211, ce: 0.181167, reg: 64.880577, reg_best: 70.094917
step:  23, cost: 8.00E-03, attack: 0.992, loss: 0.650722, ce: 0.122815, reg: 65.988396, reg_best: 65.988396
step:  24, cost: 8.00E-03, attack: 0.998, loss: 0.569207, ce: 0.031628, reg: 67.197357, reg_best: 65.988396
step:  25, cost: 8.00E-03, attack: 0.998, loss: 0.575723, ce: 0.035936, reg: 67.473396, reg_best: 65.988396
step:  26, cost: 8.00E-03, attack: 0.998, loss: 0.570812, ce: 0.041096, reg: 66.214447, reg_best: 65.988396
step:  27, cost: 8.00E-03, attack: 0.996, loss: 0.598478, ce: 0.067222, reg: 66.407043, reg_best: 65.988396
up cost from 8.00E-03 to 1.60E-02
step:  28, cost: 1.60E-02, attack: 0.993, loss: 1.124211, ce: 0.108781, reg: 63.464359, reg_best: 63.464359
step:  29, cost: 1.60E-02, attack: 0.992, loss: 1.086196, ce: 0.120072, reg: 60.382698, reg_best: 60.382698
step:  30, cost: 1.60E-02, attack: 0.993, loss: 1.139678, ce: 0.120957, reg: 63.648415, reg_best: 60.382698
step:  31, cost: 1.60E-02, attack: 0.998, loss: 1.052051, ce: 0.040836, reg: 63.200916, reg_best: 60.382698
step:  32, cost: 1.60E-02, attack: 0.992, loss: 1.040298, ce: 0.138580, reg: 56.357342, reg_best: 56.357342
up cost from 1.60E-02 to 3.20E-02
step:  33, cost: 3.20E-02, attack: 0.992, loss: 1.991357, ce: 0.140775, reg: 57.830688, reg_best: 56.357342
step:  34, cost: 3.20E-02, attack: 0.987, loss: 1.977268, ce: 0.205121, reg: 55.379608, reg_best: 56.357342
step:  35, cost: 3.20E-02, attack: 0.986, loss: 2.049694, ce: 0.235248, reg: 56.701447, reg_best: 56.357342
step:  36, cost: 3.20E-02, attack: 0.989, loss: 1.928521, ce: 0.167396, reg: 55.035133, reg_best: 56.357342
step:  37, cost: 3.20E-02, attack: 0.990, loss: 1.974996, ce: 0.165846, reg: 56.535919, reg_best: 56.357342
step:  38, cost: 3.20E-02, attack: 0.993, loss: 1.925755, ce: 0.146231, reg: 55.610123, reg_best: 55.610123
step:  39, cost: 3.20E-02, attack: 0.986, loss: 1.930725, ce: 0.229353, reg: 53.167877, reg_best: 55.610123
step:  40, cost: 3.20E-02, attack: 0.982, loss: 1.932670, ce: 0.299214, reg: 51.045464, reg_best: 55.610123
step:  41, cost: 3.20E-02, attack: 0.982, loss: 1.976336, ce: 0.297017, reg: 52.478680, reg_best: 55.610123
step:  42, cost: 3.20E-02, attack: 0.984, loss: 1.940322, ce: 0.261016, reg: 52.478291, reg_best: 55.610123
step:  43, cost: 3.20E-02, attack: 0.987, loss: 1.883870, ce: 0.226558, reg: 51.780651, reg_best: 55.610123
down cost from 3.20E-02 to 1.13E-02
step:  44, cost: 1.13E-02, attack: 0.992, loss: 0.757242, ce: 0.139854, reg: 54.569843, reg_best: 54.569843
step:  45, cost: 1.13E-02, attack: 0.988, loss: 0.825918, ce: 0.190948, reg: 56.124012, reg_best: 54.569843
step:  46, cost: 1.13E-02, attack: 0.993, loss: 0.733598, ce: 0.114283, reg: 54.740208, reg_best: 54.569843
step:  47, cost: 1.13E-02, attack: 0.990, loss: 0.789662, ce: 0.166755, reg: 55.057732, reg_best: 54.569843
step:  48, cost: 1.13E-02, attack: 0.994, loss: 0.746239, ce: 0.103044, reg: 56.850929, reg_best: 54.569843
step:  49, cost: 1.13E-02, attack: 0.993, loss: 0.749023, ce: 0.118381, reg: 55.741398, reg_best: 54.569843
step:  50, cost: 1.13E-02, attack: 0.994, loss: 0.763662, ce: 0.124267, reg: 56.515087, reg_best: 54.569843
step:  51, cost: 1.13E-02, attack: 0.995, loss: 0.720886, ce: 0.082203, reg: 56.452141, reg_best: 54.569843
step:  52, cost: 1.13E-02, attack: 0.996, loss: 0.710024, ce: 0.067574, reg: 56.785061, reg_best: 54.569843
up cost from 1.13E-02 to 2.26E-02
step:  53, cost: 2.26E-02, attack: 0.990, loss: 1.375729, ce: 0.170683, reg: 53.256023, reg_best: 54.569843
step:  54, cost: 2.26E-02, attack: 0.983, loss: 1.474548, ce: 0.281084, reg: 52.744122, reg_best: 54.569843
step:  55, cost: 2.26E-02, attack: 0.994, loss: 1.321855, ce: 0.111353, reg: 53.497173, reg_best: 53.497173
step:  56, cost: 2.26E-02, attack: 0.987, loss: 1.385942, ce: 0.182326, reg: 53.185898, reg_best: 53.497173
step:  57, cost: 2.26E-02, attack: 0.985, loss: 1.419670, ce: 0.251648, reg: 51.619774, reg_best: 53.497173
step:  58, cost: 2.26E-02, attack: 0.983, loss: 1.470854, ce: 0.286784, reg: 52.328968, reg_best: 53.497173
step:  59, cost: 2.26E-02, attack: 0.986, loss: 1.411626, ce: 0.225433, reg: 52.422836, reg_best: 53.497173
step:  60, cost: 2.26E-02, attack: 0.992, loss: 1.348767, ce: 0.128348, reg: 53.935398, reg_best: 53.497173
step:  61, cost: 2.26E-02, attack: 0.988, loss: 1.410495, ce: 0.225928, reg: 52.350994, reg_best: 53.497173
step:  62, cost: 2.26E-02, attack: 0.991, loss: 1.366099, ce: 0.163209, reg: 53.160690, reg_best: 53.160690
step:  63, cost: 2.26E-02, attack: 0.989, loss: 1.413890, ce: 0.172897, reg: 54.844658, reg_best: 53.160690
step:  64, cost: 2.26E-02, attack: 0.992, loss: 1.373290, ce: 0.163370, reg: 53.471390, reg_best: 53.160690
step:  65, cost: 2.26E-02, attack: 0.989, loss: 1.405784, ce: 0.182107, reg: 54.079388, reg_best: 53.160690
step:  66, cost: 2.26E-02, attack: 0.992, loss: 1.332085, ce: 0.146063, reg: 52.415230, reg_best: 52.415230
step:  67, cost: 2.26E-02, attack: 0.988, loss: 1.397237, ce: 0.200401, reg: 52.893211, reg_best: 52.415230
step:  68, cost: 2.26E-02, attack: 0.987, loss: 1.434942, ce: 0.216482, reg: 53.840183, reg_best: 52.415230
step:  69, cost: 2.26E-02, attack: 0.985, loss: 1.417611, ce: 0.255577, reg: 51.355156, reg_best: 52.415230
step:  70, cost: 2.26E-02, attack: 0.990, loss: 1.382779, ce: 0.181629, reg: 53.083847, reg_best: 52.415230
step:  71, cost: 2.26E-02, attack: 0.991, loss: 1.326222, ce: 0.150978, reg: 51.938938, reg_best: 51.938938
step:  72, cost: 2.26E-02, attack: 0.978, loss: 1.539248, ce: 0.360565, reg: 52.090893, reg_best: 51.938938
step:  73, cost: 2.26E-02, attack: 0.989, loss: 1.379417, ce: 0.202464, reg: 52.014450, reg_best: 51.938938
step:  74, cost: 2.26E-02, attack: 0.990, loss: 1.347124, ce: 0.173851, reg: 51.851814, reg_best: 51.938938
step:  75, cost: 2.26E-02, attack: 0.984, loss: 1.484875, ce: 0.271188, reg: 53.637920, reg_best: 51.938938
step:  76, cost: 2.26E-02, attack: 0.990, loss: 1.379947, ce: 0.175534, reg: 53.228054, reg_best: 51.938938
down cost from 2.26E-02 to 8.00E-03
step:  77, cost: 8.00E-03, attack: 0.989, loss: 0.596529, ce: 0.177184, reg: 52.418060, reg_best: 51.938938
step:  78, cost: 8.00E-03, attack: 0.991, loss: 0.619095, ce: 0.175771, reg: 55.415604, reg_best: 51.938938
step:  79, cost: 8.00E-03, attack: 0.997, loss: 0.503791, ce: 0.042036, reg: 57.719341, reg_best: 51.938938
step:  80, cost: 8.00E-03, attack: 0.993, loss: 0.578030, ce: 0.120648, reg: 57.172707, reg_best: 51.938938
step:  81, cost: 8.00E-03, attack: 0.994, loss: 0.570550, ce: 0.096338, reg: 59.275223, reg_best: 51.938938
step:  82, cost: 8.00E-03, attack: 0.997, loss: 0.528177, ce: 0.063665, reg: 58.064034, reg_best: 51.938938
up cost from 8.00E-03 to 1.60E-02
step:  83, cost: 1.60E-02, attack: 0.992, loss: 1.057196, ce: 0.144672, reg: 57.032745, reg_best: 51.938938
step:  84, cost: 1.60E-02, attack: 0.993, loss: 1.012064, ce: 0.109791, reg: 56.392025, reg_best: 51.938938
step:  85, cost: 1.60E-02, attack: 0.993, loss: 0.996003, ce: 0.111027, reg: 55.311016, reg_best: 51.938938
step:  86, cost: 1.60E-02, attack: 0.989, loss: 1.056941, ce: 0.184252, reg: 54.543076, reg_best: 51.938938
step:  87, cost: 1.60E-02, attack: 0.992, loss: 1.003010, ce: 0.120306, reg: 55.168976, reg_best: 51.938938
step:  88, cost: 1.60E-02, attack: 0.991, loss: 1.050189, ce: 0.156361, reg: 55.864285, reg_best: 51.938938
step:  89, cost: 1.60E-02, attack: 0.991, loss: 1.018955, ce: 0.146205, reg: 54.546921, reg_best: 51.938938
step:  90, cost: 1.60E-02, attack: 0.990, loss: 1.031922, ce: 0.157961, reg: 54.622585, reg_best: 51.938938
step:  91, cost: 1.60E-02, attack: 0.992, loss: 1.007483, ce: 0.114556, reg: 55.807949, reg_best: 51.938938
step:  92, cost: 1.60E-02, attack: 0.994, loss: 1.026637, ce: 0.088521, reg: 58.632206, reg_best: 51.938938
step:  93, cost: 1.60E-02, attack: 0.993, loss: 1.007228, ce: 0.101094, reg: 56.633385, reg_best: 51.938938
step:  94, cost: 1.60E-02, attack: 0.988, loss: 1.048689, ce: 0.195084, reg: 53.365360, reg_best: 51.938938
step:  95, cost: 1.60E-02, attack: 0.988, loss: 1.061730, ce: 0.220032, reg: 52.606129, reg_best: 51.938938
step:  96, cost: 1.60E-02, attack: 0.991, loss: 1.004658, ce: 0.144862, reg: 53.737305, reg_best: 51.938938
early stop
pattern, shape: (32, 32, 3), min: 0.000008, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 23: 50.367973
visualization cost 19.587679 seconds
processing label 24
resetting state
mask_tanh -3.645261525871997 3.8599132530415483
pattern_tanh -4.808899121381209 3.893653536265712
step:   0, cost: 0.00E+00, attack: 0.840, loss: 2.671301, ce: 2.671301, reg: 540.013977, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000345, ce: 0.000345, reg: 562.983093, reg_best: 562.983093
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000055, ce: 0.000055, reg: 564.766052, reg_best: 562.983093
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000019, ce: 0.000019, reg: 566.542236, reg_best: 562.983093
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000003, ce: 0.000003, reg: 568.197083, reg_best: 562.983093
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000015, ce: 0.000015, reg: 579.456116, reg_best: 562.983093
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.998, loss: 0.459918, ce: 0.041752, reg: 418.166168, reg_best: 418.166168
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.348661, ce: 0.017345, reg: 331.315552, reg_best: 331.315552
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.270438, ce: 0.007769, reg: 262.669098, reg_best: 262.669098
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.239511, ce: 0.011575, reg: 227.935318, reg_best: 227.935318
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.418111, ce: 0.032367, reg: 193.148727, reg_best: 193.148727
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.350221, ce: 0.008741, reg: 170.739960, reg_best: 170.739960
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.311737, ce: 0.017706, reg: 147.015289, reg_best: 147.015289
step:  13, cost: 2.00E-03, attack: 0.996, loss: 0.317274, ce: 0.051571, reg: 132.851562, reg_best: 132.851562
step:  14, cost: 2.00E-03, attack: 1.000, loss: 0.253405, ce: 0.001753, reg: 125.826149, reg_best: 125.826149
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.996, loss: 0.498835, ce: 0.071979, reg: 106.713867, reg_best: 106.713867
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.450105, ce: 0.027854, reg: 105.562538, reg_best: 105.562538
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.403781, ce: 0.016276, reg: 96.876282, reg_best: 96.876282
step:  18, cost: 4.00E-03, attack: 0.999, loss: 0.428654, ce: 0.031605, reg: 99.262337, reg_best: 96.876282
step:  19, cost: 4.00E-03, attack: 1.000, loss: 0.391318, ce: 0.015885, reg: 93.858025, reg_best: 93.858025
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 1.000, loss: 0.712035, ce: 0.016521, reg: 86.939178, reg_best: 86.939178
step:  21, cost: 8.00E-03, attack: 0.998, loss: 0.715842, ce: 0.036209, reg: 84.954109, reg_best: 84.954109
step:  22, cost: 8.00E-03, attack: 0.996, loss: 0.741071, ce: 0.054232, reg: 85.862442, reg_best: 84.954109
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.710332, ce: 0.074318, reg: 79.501755, reg_best: 79.501755
step:  24, cost: 8.00E-03, attack: 0.997, loss: 0.678946, ce: 0.052898, reg: 78.256065, reg_best: 78.256065
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.998, loss: 1.266272, ce: 0.031853, reg: 77.151146, reg_best: 77.151146
step:  26, cost: 1.60E-02, attack: 0.995, loss: 1.304307, ce: 0.087359, reg: 76.059303, reg_best: 76.059303
step:  27, cost: 1.60E-02, attack: 0.997, loss: 1.263448, ce: 0.058353, reg: 75.318382, reg_best: 75.318382
step:  28, cost: 1.60E-02, attack: 0.994, loss: 1.247252, ce: 0.113004, reg: 70.890495, reg_best: 70.890495
step:  29, cost: 1.60E-02, attack: 0.996, loss: 1.219337, ce: 0.077989, reg: 71.334244, reg_best: 70.890495
up cost from 1.60E-02 to 3.20E-02
step:  30, cost: 3.20E-02, attack: 0.987, loss: 2.339417, ce: 0.235822, reg: 65.737320, reg_best: 70.890495
step:  31, cost: 3.20E-02, attack: 0.992, loss: 2.282541, ce: 0.158996, reg: 66.360764, reg_best: 66.360764
step:  32, cost: 3.20E-02, attack: 0.981, loss: 2.326032, ce: 0.316801, reg: 62.788452, reg_best: 66.360764
step:  33, cost: 3.20E-02, attack: 0.972, loss: 2.390936, ce: 0.471108, reg: 59.994629, reg_best: 66.360764
step:  34, cost: 3.20E-02, attack: 0.991, loss: 2.218091, ce: 0.157168, reg: 64.403801, reg_best: 64.403801
step:  35, cost: 3.20E-02, attack: 0.984, loss: 2.172570, ce: 0.253718, reg: 59.933105, reg_best: 64.403801
step:  36, cost: 3.20E-02, attack: 0.976, loss: 2.309177, ce: 0.405863, reg: 59.478554, reg_best: 64.403801
step:  37, cost: 3.20E-02, attack: 0.987, loss: 2.252948, ce: 0.213637, reg: 63.728466, reg_best: 64.403801
step:  38, cost: 3.20E-02, attack: 0.983, loss: 2.284444, ce: 0.274640, reg: 62.806366, reg_best: 64.403801
step:  39, cost: 3.20E-02, attack: 0.993, loss: 2.162965, ce: 0.136057, reg: 63.340885, reg_best: 63.340885
step:  40, cost: 3.20E-02, attack: 0.987, loss: 2.190012, ce: 0.225515, reg: 61.390533, reg_best: 63.340885
step:  41, cost: 3.20E-02, attack: 0.993, loss: 2.127686, ce: 0.125292, reg: 62.574818, reg_best: 62.574818
step:  42, cost: 3.20E-02, attack: 0.988, loss: 2.112387, ce: 0.192028, reg: 60.011242, reg_best: 62.574818
step:  43, cost: 3.20E-02, attack: 0.981, loss: 2.150317, ce: 0.292711, reg: 58.050163, reg_best: 62.574818
step:  44, cost: 3.20E-02, attack: 0.976, loss: 2.275621, ce: 0.368462, reg: 59.598713, reg_best: 62.574818
step:  45, cost: 3.20E-02, attack: 0.982, loss: 2.205583, ce: 0.300641, reg: 59.529438, reg_best: 62.574818
step:  46, cost: 3.20E-02, attack: 0.987, loss: 2.168582, ce: 0.231140, reg: 60.545071, reg_best: 62.574818
down cost from 3.20E-02 to 1.13E-02
step:  47, cost: 1.13E-02, attack: 0.997, loss: 0.754108, ce: 0.054128, reg: 61.870075, reg_best: 61.870075
step:  48, cost: 1.13E-02, attack: 0.998, loss: 0.780903, ce: 0.036742, reg: 65.763779, reg_best: 61.870075
step:  49, cost: 1.13E-02, attack: 0.997, loss: 0.805888, ce: 0.066278, reg: 65.372871, reg_best: 61.870075
step:  50, cost: 1.13E-02, attack: 0.997, loss: 0.791535, ce: 0.062158, reg: 64.468445, reg_best: 61.870075
step:  51, cost: 1.13E-02, attack: 0.995, loss: 0.839378, ce: 0.086886, reg: 66.511559, reg_best: 61.870075
up cost from 1.13E-02 to 2.26E-02
step:  52, cost: 2.26E-02, attack: 0.983, loss: 1.660768, ce: 0.282412, reg: 60.915314, reg_best: 61.870075
step:  53, cost: 2.26E-02, attack: 0.994, loss: 1.548176, ce: 0.107863, reg: 63.653427, reg_best: 61.870075
step:  54, cost: 2.26E-02, attack: 0.992, loss: 1.520409, ce: 0.136670, reg: 61.153206, reg_best: 61.153206
step:  55, cost: 2.26E-02, attack: 0.990, loss: 1.485909, ce: 0.160954, reg: 58.555286, reg_best: 61.153206
step:  56, cost: 2.26E-02, attack: 0.991, loss: 1.571991, ce: 0.172277, reg: 61.859222, reg_best: 61.153206
step:  57, cost: 2.26E-02, attack: 0.991, loss: 1.520900, ce: 0.152675, reg: 60.467594, reg_best: 60.467594
step:  58, cost: 2.26E-02, attack: 0.987, loss: 1.555817, ce: 0.201218, reg: 59.865379, reg_best: 60.467594
step:  59, cost: 2.26E-02, attack: 0.993, loss: 1.532987, ce: 0.121340, reg: 62.386597, reg_best: 60.467594
step:  60, cost: 2.26E-02, attack: 0.991, loss: 1.550062, ce: 0.155509, reg: 61.639294, reg_best: 60.467594
step:  61, cost: 2.26E-02, attack: 0.997, loss: 1.532236, ce: 0.072567, reg: 64.508858, reg_best: 60.467594
step:  62, cost: 2.26E-02, attack: 0.989, loss: 1.539524, ce: 0.177439, reg: 60.196224, reg_best: 60.467594
step:  63, cost: 2.26E-02, attack: 0.982, loss: 1.608471, ce: 0.286645, reg: 58.417027, reg_best: 60.467594
step:  64, cost: 2.26E-02, attack: 0.993, loss: 1.528119, ce: 0.128697, reg: 61.846287, reg_best: 60.467594
step:  65, cost: 2.26E-02, attack: 0.984, loss: 1.620178, ce: 0.261510, reg: 60.045246, reg_best: 60.467594
step:  66, cost: 2.26E-02, attack: 0.990, loss: 1.564620, ce: 0.169205, reg: 61.669193, reg_best: 60.467594
step:  67, cost: 2.26E-02, attack: 0.990, loss: 1.528891, ce: 0.134451, reg: 61.626125, reg_best: 60.467594
step:  68, cost: 2.26E-02, attack: 0.983, loss: 1.661330, ce: 0.256728, reg: 62.075214, reg_best: 60.467594
step:  69, cost: 2.26E-02, attack: 0.993, loss: 1.478941, ce: 0.114428, reg: 60.303482, reg_best: 60.303482
step:  70, cost: 2.26E-02, attack: 0.985, loss: 1.578572, ce: 0.223737, reg: 59.875809, reg_best: 60.303482
step:  71, cost: 2.26E-02, attack: 0.994, loss: 1.502872, ce: 0.111828, reg: 61.476055, reg_best: 60.303482
step:  72, cost: 2.26E-02, attack: 0.995, loss: 1.515555, ce: 0.108849, reg: 62.168228, reg_best: 60.303482
step:  73, cost: 2.26E-02, attack: 0.990, loss: 1.565597, ce: 0.178609, reg: 61.316174, reg_best: 60.303482
step:  74, cost: 2.26E-02, attack: 0.992, loss: 1.546357, ce: 0.138654, reg: 62.212303, reg_best: 60.303482
step:  75, cost: 2.26E-02, attack: 0.990, loss: 1.574152, ce: 0.182082, reg: 61.521378, reg_best: 60.303482
step:  76, cost: 2.26E-02, attack: 0.982, loss: 1.677109, ce: 0.298162, reg: 60.941402, reg_best: 60.303482
step:  77, cost: 2.26E-02, attack: 0.992, loss: 1.501597, ce: 0.141696, reg: 60.099712, reg_best: 60.099712
step:  78, cost: 2.26E-02, attack: 0.995, loss: 1.497803, ce: 0.089487, reg: 62.239330, reg_best: 60.099712
step:  79, cost: 2.26E-02, attack: 0.991, loss: 1.516129, ce: 0.146737, reg: 60.519131, reg_best: 60.099712
step:  80, cost: 2.26E-02, attack: 0.990, loss: 1.530785, ce: 0.168531, reg: 60.203705, reg_best: 60.099712
step:  81, cost: 2.26E-02, attack: 0.989, loss: 1.527410, ce: 0.174669, reg: 59.783257, reg_best: 60.099712
step:  82, cost: 2.26E-02, attack: 0.993, loss: 1.485737, ce: 0.118883, reg: 60.406975, reg_best: 60.099712
step:  83, cost: 2.26E-02, attack: 0.993, loss: 1.476695, ce: 0.116566, reg: 60.109764, reg_best: 60.099712
step:  84, cost: 2.26E-02, attack: 0.990, loss: 1.597911, ce: 0.194449, reg: 62.024826, reg_best: 60.099712
step:  85, cost: 2.26E-02, attack: 0.994, loss: 1.488656, ce: 0.097844, reg: 61.465801, reg_best: 60.099712
step:  86, cost: 2.26E-02, attack: 0.989, loss: 1.542616, ce: 0.169316, reg: 60.691128, reg_best: 60.099712
step:  87, cost: 2.26E-02, attack: 0.989, loss: 1.581957, ce: 0.176319, reg: 62.121014, reg_best: 60.099712
step:  88, cost: 2.26E-02, attack: 0.996, loss: 1.498107, ce: 0.081885, reg: 62.588749, reg_best: 60.099712
step:  89, cost: 2.26E-02, attack: 0.987, loss: 1.565188, ce: 0.223422, reg: 59.298203, reg_best: 60.099712
step:  90, cost: 2.26E-02, attack: 0.994, loss: 1.513160, ce: 0.103006, reg: 62.320568, reg_best: 60.099712
step:  91, cost: 2.26E-02, attack: 0.994, loss: 1.486757, ce: 0.107583, reg: 60.951450, reg_best: 60.099712
step:  92, cost: 2.26E-02, attack: 0.988, loss: 1.561531, ce: 0.198597, reg: 60.233738, reg_best: 60.099712
step:  93, cost: 2.26E-02, attack: 0.996, loss: 1.490287, ce: 0.098018, reg: 61.530159, reg_best: 60.099712
step:  94, cost: 2.26E-02, attack: 0.995, loss: 1.433464, ce: 0.077564, reg: 59.922890, reg_best: 59.922890
step:  95, cost: 2.26E-02, attack: 0.988, loss: 1.549743, ce: 0.207715, reg: 59.309818, reg_best: 59.922890
step:  96, cost: 2.26E-02, attack: 0.980, loss: 1.637649, ce: 0.324182, reg: 58.047596, reg_best: 59.922890
step:  97, cost: 2.26E-02, attack: 0.992, loss: 1.490795, ce: 0.123620, reg: 60.421169, reg_best: 59.922890
step:  98, cost: 2.26E-02, attack: 0.994, loss: 1.487590, ce: 0.101829, reg: 61.242550, reg_best: 59.922890
step:  99, cost: 2.26E-02, attack: 0.996, loss: 1.458376, ce: 0.080224, reg: 60.912266, reg_best: 59.922890
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 24: 56.710899
visualization cost 20.254763 seconds
processing label 25
resetting state
mask_tanh -4.203470667154293 3.9886279232880666
pattern_tanh -4.624075399863319 4.2046807711986105
step:   0, cost: 0.00E+00, attack: 0.897, loss: 1.870246, ce: 1.870246, reg: 550.663147, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000164, ce: 0.000164, reg: 569.343079, reg_best: 569.343079
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.003433, ce: 0.003433, reg: 574.289185, reg_best: 569.343079
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000054, ce: 0.000054, reg: 578.909058, reg_best: 569.343079
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 582.707642, reg_best: 569.343079
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 583.901489, reg_best: 569.343079
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.502642, ce: 0.066812, reg: 435.829773, reg_best: 435.829773
step:   7, cost: 1.00E-03, attack: 0.996, loss: 0.370065, ce: 0.059974, reg: 310.091553, reg_best: 310.091553
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.260741, ce: 0.014898, reg: 245.843323, reg_best: 245.843323
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.237796, ce: 0.032438, reg: 205.357834, reg_best: 205.357834
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.377123, ce: 0.016713, reg: 180.205231, reg_best: 180.205231
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.356559, ce: 0.038928, reg: 158.622482, reg_best: 158.622482
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.295965, ce: 0.022897, reg: 136.533569, reg_best: 136.533569
step:  13, cost: 2.00E-03, attack: 1.000, loss: 0.277917, ce: 0.007524, reg: 135.196655, reg_best: 135.196655
step:  14, cost: 2.00E-03, attack: 0.996, loss: 0.304859, ce: 0.068586, reg: 118.136864, reg_best: 118.136864
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.997, loss: 0.490383, ce: 0.040466, reg: 112.479393, reg_best: 112.479393
step:  16, cost: 4.00E-03, attack: 0.994, loss: 0.526305, ce: 0.105498, reg: 105.201721, reg_best: 105.201721
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.438728, ce: 0.042552, reg: 99.043900, reg_best: 99.043900
step:  18, cost: 4.00E-03, attack: 0.995, loss: 0.448212, ce: 0.083543, reg: 91.167099, reg_best: 91.167099
step:  19, cost: 4.00E-03, attack: 0.994, loss: 0.422105, ce: 0.076471, reg: 86.408630, reg_best: 86.408630
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.995, loss: 0.794483, ce: 0.078276, reg: 89.525879, reg_best: 86.408630
step:  21, cost: 8.00E-03, attack: 0.996, loss: 0.759909, ce: 0.073298, reg: 85.826378, reg_best: 85.826378
step:  22, cost: 8.00E-03, attack: 0.989, loss: 0.788095, ce: 0.167721, reg: 77.546799, reg_best: 85.826378
step:  23, cost: 8.00E-03, attack: 0.992, loss: 0.777456, ce: 0.137833, reg: 79.952934, reg_best: 79.952934
step:  24, cost: 8.00E-03, attack: 0.995, loss: 0.740017, ce: 0.087793, reg: 81.526161, reg_best: 79.952934
step:  25, cost: 8.00E-03, attack: 0.994, loss: 0.740187, ce: 0.104115, reg: 79.509018, reg_best: 79.509018
step:  26, cost: 8.00E-03, attack: 0.996, loss: 0.692566, ce: 0.063174, reg: 78.674042, reg_best: 78.674042
step:  27, cost: 8.00E-03, attack: 0.995, loss: 0.697876, ce: 0.079817, reg: 77.257355, reg_best: 77.257355
up cost from 8.00E-03 to 1.60E-02
step:  28, cost: 1.60E-02, attack: 0.986, loss: 1.386670, ce: 0.244803, reg: 71.366684, reg_best: 77.257355
step:  29, cost: 1.60E-02, attack: 0.995, loss: 1.264752, ce: 0.087053, reg: 73.606194, reg_best: 73.606194
step:  30, cost: 1.60E-02, attack: 0.990, loss: 1.302466, ce: 0.161614, reg: 71.303284, reg_best: 73.606194
step:  31, cost: 1.60E-02, attack: 0.986, loss: 1.357844, ce: 0.235002, reg: 70.177620, reg_best: 73.606194
step:  32, cost: 1.60E-02, attack: 0.994, loss: 1.244815, ce: 0.104019, reg: 71.299736, reg_best: 71.299736
step:  33, cost: 1.60E-02, attack: 0.994, loss: 1.314653, ce: 0.131378, reg: 73.954681, reg_best: 71.299736
step:  34, cost: 1.60E-02, attack: 0.986, loss: 1.335603, ce: 0.226873, reg: 69.295601, reg_best: 71.299736
step:  35, cost: 1.60E-02, attack: 0.987, loss: 1.316893, ce: 0.225485, reg: 68.213036, reg_best: 71.299736
step:  36, cost: 1.60E-02, attack: 0.994, loss: 1.216622, ce: 0.101680, reg: 69.683830, reg_best: 69.683830
step:  37, cost: 1.60E-02, attack: 0.993, loss: 1.202175, ce: 0.135430, reg: 66.698029, reg_best: 66.698029
step:  38, cost: 1.60E-02, attack: 0.991, loss: 1.251156, ce: 0.141038, reg: 69.382370, reg_best: 66.698029
step:  39, cost: 1.60E-02, attack: 0.987, loss: 1.307969, ce: 0.208870, reg: 68.693687, reg_best: 66.698029
step:  40, cost: 1.60E-02, attack: 0.994, loss: 1.194921, ce: 0.105629, reg: 68.080734, reg_best: 66.698029
step:  41, cost: 1.60E-02, attack: 0.994, loss: 1.240017, ce: 0.104235, reg: 70.986412, reg_best: 66.698029
step:  42, cost: 1.60E-02, attack: 0.993, loss: 1.239959, ce: 0.111446, reg: 70.532051, reg_best: 66.698029
step:  43, cost: 1.60E-02, attack: 0.991, loss: 1.227032, ce: 0.146745, reg: 67.517921, reg_best: 66.698029
step:  44, cost: 1.60E-02, attack: 0.995, loss: 1.208713, ce: 0.095424, reg: 69.580574, reg_best: 66.698029
up cost from 1.60E-02 to 3.20E-02
step:  45, cost: 3.20E-02, attack: 0.990, loss: 2.253947, ce: 0.175311, reg: 64.957375, reg_best: 66.698029
step:  46, cost: 3.20E-02, attack: 0.988, loss: 2.283516, ce: 0.178657, reg: 65.776863, reg_best: 66.698029
step:  47, cost: 3.20E-02, attack: 0.990, loss: 2.245942, ce: 0.160356, reg: 65.174568, reg_best: 66.698029
step:  48, cost: 3.20E-02, attack: 0.976, loss: 2.371188, ce: 0.390857, reg: 61.885353, reg_best: 66.698029
step:  49, cost: 3.20E-02, attack: 0.977, loss: 2.346914, ce: 0.362726, reg: 62.005882, reg_best: 66.698029
down cost from 3.20E-02 to 1.13E-02
step:  50, cost: 1.13E-02, attack: 0.992, loss: 0.867504, ce: 0.137025, reg: 64.571251, reg_best: 64.571251
step:  51, cost: 1.13E-02, attack: 0.994, loss: 0.883568, ce: 0.121076, reg: 67.395355, reg_best: 64.571251
step:  52, cost: 1.13E-02, attack: 0.995, loss: 0.850755, ce: 0.097991, reg: 66.535545, reg_best: 64.571251
step:  53, cost: 1.13E-02, attack: 0.988, loss: 0.940398, ce: 0.181950, reg: 67.037994, reg_best: 64.571251
step:  54, cost: 1.13E-02, attack: 0.994, loss: 0.886138, ce: 0.111746, reg: 68.447220, reg_best: 64.571251
step:  55, cost: 1.13E-02, attack: 0.992, loss: 0.904063, ce: 0.113569, reg: 69.870491, reg_best: 64.571251
step:  56, cost: 1.13E-02, attack: 0.996, loss: 0.866742, ce: 0.072168, reg: 70.231026, reg_best: 64.571251
step:  57, cost: 1.13E-02, attack: 0.991, loss: 0.903745, ce: 0.149980, reg: 66.623970, reg_best: 64.571251
step:  58, cost: 1.13E-02, attack: 0.993, loss: 0.878482, ce: 0.119380, reg: 67.095772, reg_best: 64.571251
up cost from 1.13E-02 to 2.26E-02
step:  59, cost: 2.26E-02, attack: 0.988, loss: 1.655810, ce: 0.204442, reg: 64.141998, reg_best: 64.571251
step:  60, cost: 2.26E-02, attack: 0.977, loss: 1.734969, ce: 0.381008, reg: 59.837193, reg_best: 64.571251
step:  61, cost: 2.26E-02, attack: 0.986, loss: 1.645722, ce: 0.228538, reg: 62.631290, reg_best: 64.571251
step:  62, cost: 2.26E-02, attack: 0.981, loss: 1.706211, ce: 0.319608, reg: 61.300140, reg_best: 64.571251
step:  63, cost: 2.26E-02, attack: 0.984, loss: 1.669456, ce: 0.259720, reg: 62.302155, reg_best: 64.571251
down cost from 2.26E-02 to 8.00E-03
step:  64, cost: 8.00E-03, attack: 0.984, loss: 0.766461, ce: 0.269933, reg: 62.065926, reg_best: 64.571251
step:  65, cost: 8.00E-03, attack: 0.995, loss: 0.629594, ce: 0.079642, reg: 68.744026, reg_best: 64.571251
step:  66, cost: 8.00E-03, attack: 0.994, loss: 0.672207, ce: 0.103493, reg: 71.089310, reg_best: 64.571251
step:  67, cost: 8.00E-03, attack: 0.994, loss: 0.646653, ce: 0.095528, reg: 68.890564, reg_best: 64.571251
step:  68, cost: 8.00E-03, attack: 0.994, loss: 0.646723, ce: 0.104274, reg: 67.806190, reg_best: 64.571251
step:  69, cost: 8.00E-03, attack: 0.992, loss: 0.649446, ce: 0.110469, reg: 67.372078, reg_best: 64.571251
up cost from 8.00E-03 to 1.60E-02
step:  70, cost: 1.60E-02, attack: 0.996, loss: 1.138544, ce: 0.068094, reg: 66.903114, reg_best: 64.571251
step:  71, cost: 1.60E-02, attack: 0.990, loss: 1.187413, ce: 0.154075, reg: 64.583588, reg_best: 64.571251
step:  72, cost: 1.60E-02, attack: 0.993, loss: 1.145880, ce: 0.107798, reg: 64.880089, reg_best: 64.571251
step:  73, cost: 1.60E-02, attack: 0.988, loss: 1.215274, ce: 0.195563, reg: 63.731915, reg_best: 64.571251
step:  74, cost: 1.60E-02, attack: 0.990, loss: 1.193514, ce: 0.169901, reg: 63.975815, reg_best: 64.571251
step:  75, cost: 1.60E-02, attack: 0.993, loss: 1.132300, ce: 0.122551, reg: 63.081364, reg_best: 63.081364
step:  76, cost: 1.60E-02, attack: 0.992, loss: 1.151513, ce: 0.133531, reg: 63.623863, reg_best: 63.081364
step:  77, cost: 1.60E-02, attack: 0.996, loss: 1.125198, ce: 0.077608, reg: 65.474388, reg_best: 63.081364
step:  78, cost: 1.60E-02, attack: 0.992, loss: 1.129762, ce: 0.147554, reg: 61.388050, reg_best: 61.388050
step:  79, cost: 1.60E-02, attack: 0.992, loss: 1.127405, ce: 0.147805, reg: 61.224991, reg_best: 61.224991
up cost from 1.60E-02 to 3.20E-02
step:  80, cost: 3.20E-02, attack: 0.986, loss: 2.157718, ce: 0.224937, reg: 60.399406, reg_best: 61.224991
step:  81, cost: 3.20E-02, attack: 0.971, loss: 2.314876, ce: 0.480619, reg: 57.320553, reg_best: 61.224991
step:  82, cost: 3.20E-02, attack: 0.981, loss: 2.143715, ce: 0.323753, reg: 56.873810, reg_best: 61.224991
step:  83, cost: 3.20E-02, attack: 0.975, loss: 2.193160, ce: 0.434855, reg: 54.947021, reg_best: 61.224991
step:  84, cost: 3.20E-02, attack: 0.975, loss: 2.194019, ce: 0.408298, reg: 55.803776, reg_best: 61.224991
down cost from 3.20E-02 to 1.13E-02
step:  85, cost: 1.13E-02, attack: 0.989, loss: 0.880234, ce: 0.193584, reg: 60.691814, reg_best: 61.224991
step:  86, cost: 1.13E-02, attack: 0.994, loss: 0.822088, ce: 0.104094, reg: 63.462280, reg_best: 61.224991
step:  87, cost: 1.13E-02, attack: 0.993, loss: 0.848468, ce: 0.115936, reg: 64.747223, reg_best: 61.224991
step:  88, cost: 1.13E-02, attack: 0.991, loss: 0.870225, ce: 0.149854, reg: 63.665047, reg_best: 61.224991
step:  89, cost: 1.13E-02, attack: 0.995, loss: 0.812203, ce: 0.097338, reg: 63.185734, reg_best: 61.224991
step:  90, cost: 1.13E-02, attack: 0.995, loss: 0.824875, ce: 0.097019, reg: 64.333969, reg_best: 61.224991
up cost from 1.13E-02 to 2.26E-02
step:  91, cost: 2.26E-02, attack: 0.991, loss: 1.564885, ce: 0.152193, reg: 62.432770, reg_best: 61.224991
step:  92, cost: 2.26E-02, attack: 0.986, loss: 1.592758, ce: 0.222505, reg: 60.557209, reg_best: 61.224991
step:  93, cost: 2.26E-02, attack: 0.985, loss: 1.596005, ce: 0.269040, reg: 58.644096, reg_best: 61.224991
step:  94, cost: 2.26E-02, attack: 0.985, loss: 1.588212, ce: 0.232406, reg: 59.918732, reg_best: 61.224991
step:  95, cost: 2.26E-02, attack: 0.989, loss: 1.571982, ce: 0.194825, reg: 60.862312, reg_best: 61.224991
step:  96, cost: 2.26E-02, attack: 0.988, loss: 1.548479, ce: 0.202381, reg: 59.489697, reg_best: 61.224991
down cost from 2.26E-02 to 8.00E-03
step:  97, cost: 8.00E-03, attack: 0.994, loss: 0.611496, ce: 0.109514, reg: 62.747723, reg_best: 61.224991
step:  98, cost: 8.00E-03, attack: 0.995, loss: 0.607522, ce: 0.090526, reg: 64.624527, reg_best: 61.224991
step:  99, cost: 8.00E-03, attack: 0.995, loss: 0.597169, ce: 0.083289, reg: 64.234978, reg_best: 61.224991
pattern, shape: (32, 32, 3), min: 0.000015, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 25: 61.349171
visualization cost 20.126445 seconds
processing label 26
resetting state
mask_tanh -4.035902029360186 4.8444772980820625
pattern_tanh -4.746855463064718 3.6034903231756146
step:   0, cost: 0.00E+00, attack: 0.877, loss: 2.021561, ce: 2.021561, reg: 546.721497, reg_best: inf
step:   1, cost: 0.00E+00, attack: 0.999, loss: 0.016433, ce: 0.016433, reg: 557.422668, reg_best: 557.422668
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.006656, ce: 0.006656, reg: 561.569763, reg_best: 557.422668
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000204, ce: 0.000204, reg: 568.576660, reg_best: 557.422668
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000004, ce: 0.000004, reg: 571.227783, reg_best: 557.422668
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 572.389099, reg_best: 557.422668
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.993, loss: 0.510157, ce: 0.115116, reg: 395.040802, reg_best: 395.040802
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.281614, ce: 0.000185, reg: 281.428955, reg_best: 281.428955
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.245897, ce: 0.024425, reg: 221.471619, reg_best: 221.471619
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.227365, ce: 0.033464, reg: 193.900803, reg_best: 193.900803
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.370061, ce: 0.028884, reg: 170.588699, reg_best: 170.588699
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.328669, ce: 0.025277, reg: 151.695938, reg_best: 151.695938
step:  12, cost: 2.00E-03, attack: 1.000, loss: 0.289016, ce: 0.000890, reg: 144.063095, reg_best: 144.063095
step:  13, cost: 2.00E-03, attack: 0.998, loss: 0.289568, ce: 0.042687, reg: 123.405777, reg_best: 123.405777
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.242487, ce: 0.009690, reg: 116.398293, reg_best: 116.398293
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.997, loss: 0.441084, ce: 0.043897, reg: 99.296783, reg_best: 99.296783
step:  16, cost: 4.00E-03, attack: 0.996, loss: 0.461740, ce: 0.076266, reg: 96.368362, reg_best: 96.368362
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.406984, ce: 0.054343, reg: 88.160400, reg_best: 88.160400
step:  18, cost: 4.00E-03, attack: 0.998, loss: 0.378591, ce: 0.031200, reg: 86.847755, reg_best: 86.847755
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.351255, ce: 0.032843, reg: 79.602936, reg_best: 79.602936
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.996, loss: 0.664838, ce: 0.055150, reg: 76.210976, reg_best: 76.210976
step:  21, cost: 8.00E-03, attack: 0.998, loss: 0.609853, ce: 0.055718, reg: 69.266869, reg_best: 69.266869
step:  22, cost: 8.00E-03, attack: 0.997, loss: 0.606041, ce: 0.044535, reg: 70.188240, reg_best: 69.266869
step:  23, cost: 8.00E-03, attack: 0.994, loss: 0.627832, ce: 0.101072, reg: 65.844971, reg_best: 65.844971
step:  24, cost: 8.00E-03, attack: 0.992, loss: 0.646073, ce: 0.142899, reg: 62.896755, reg_best: 62.896755
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.994, loss: 1.089023, ce: 0.119449, reg: 60.598351, reg_best: 60.598351
step:  26, cost: 1.60E-02, attack: 0.991, loss: 1.074787, ce: 0.152560, reg: 57.611156, reg_best: 57.611156
step:  27, cost: 1.60E-02, attack: 0.989, loss: 1.108791, ce: 0.183228, reg: 57.847656, reg_best: 57.611156
step:  28, cost: 1.60E-02, attack: 0.984, loss: 1.159696, ce: 0.253106, reg: 56.661816, reg_best: 57.611156
step:  29, cost: 1.60E-02, attack: 0.989, loss: 1.057383, ce: 0.175423, reg: 55.122463, reg_best: 57.611156
step:  30, cost: 1.60E-02, attack: 0.989, loss: 1.082338, ce: 0.170301, reg: 57.002316, reg_best: 57.611156
step:  31, cost: 1.60E-02, attack: 0.985, loss: 1.148418, ce: 0.252983, reg: 55.964695, reg_best: 57.611156
down cost from 1.60E-02 to 5.66E-03
step:  32, cost: 5.66E-03, attack: 0.992, loss: 0.488846, ce: 0.139973, reg: 61.672543, reg_best: 57.611156
step:  33, cost: 5.66E-03, attack: 0.997, loss: 0.396603, ce: 0.052346, reg: 60.856606, reg_best: 57.611156
step:  34, cost: 5.66E-03, attack: 0.995, loss: 0.424611, ce: 0.071373, reg: 62.444267, reg_best: 57.611156
step:  35, cost: 5.66E-03, attack: 0.997, loss: 0.392531, ce: 0.050643, reg: 60.437813, reg_best: 57.611156
step:  36, cost: 5.66E-03, attack: 0.998, loss: 0.366432, ce: 0.029669, reg: 59.531872, reg_best: 57.611156
up cost from 5.66E-03 to 1.13E-02
step:  37, cost: 1.13E-02, attack: 0.997, loss: 0.716081, ce: 0.044508, reg: 59.359173, reg_best: 57.611156
step:  38, cost: 1.13E-02, attack: 0.996, loss: 0.751485, ce: 0.071527, reg: 60.100372, reg_best: 57.611156
step:  39, cost: 1.13E-02, attack: 0.997, loss: 0.714991, ce: 0.046650, reg: 59.080730, reg_best: 57.611156
step:  40, cost: 1.13E-02, attack: 0.995, loss: 0.732375, ce: 0.098156, reg: 56.057579, reg_best: 56.057579
step:  41, cost: 1.13E-02, attack: 0.996, loss: 0.724934, ce: 0.065778, reg: 58.261768, reg_best: 56.057579
up cost from 1.13E-02 to 2.26E-02
step:  42, cost: 2.26E-02, attack: 0.996, loss: 1.392501, ce: 0.077001, reg: 58.137440, reg_best: 56.057579
step:  43, cost: 2.26E-02, attack: 0.990, loss: 1.458160, ce: 0.140749, reg: 58.221901, reg_best: 56.057579
step:  44, cost: 2.26E-02, attack: 0.994, loss: 1.391508, ce: 0.122669, reg: 56.075302, reg_best: 56.057579
step:  45, cost: 2.26E-02, attack: 0.993, loss: 1.381605, ce: 0.128407, reg: 55.384048, reg_best: 55.384048
step:  46, cost: 2.26E-02, attack: 0.984, loss: 1.492768, ce: 0.251107, reg: 54.874161, reg_best: 55.384048
step:  47, cost: 2.26E-02, attack: 0.993, loss: 1.404012, ce: 0.136661, reg: 56.009544, reg_best: 55.384048
step:  48, cost: 2.26E-02, attack: 0.987, loss: 1.464448, ce: 0.205294, reg: 55.647255, reg_best: 55.384048
step:  49, cost: 2.26E-02, attack: 0.997, loss: 1.357578, ce: 0.064217, reg: 57.159019, reg_best: 55.384048
step:  50, cost: 2.26E-02, attack: 0.987, loss: 1.457741, ce: 0.208745, reg: 55.198345, reg_best: 55.384048
step:  51, cost: 2.26E-02, attack: 0.995, loss: 1.341515, ce: 0.085658, reg: 55.501598, reg_best: 55.384048
step:  52, cost: 2.26E-02, attack: 0.987, loss: 1.467666, ce: 0.224528, reg: 54.945023, reg_best: 55.384048
step:  53, cost: 2.26E-02, attack: 0.989, loss: 1.434244, ce: 0.176912, reg: 55.566746, reg_best: 55.384048
step:  54, cost: 2.26E-02, attack: 0.993, loss: 1.329185, ce: 0.103232, reg: 54.179981, reg_best: 54.179981
step:  55, cost: 2.26E-02, attack: 0.976, loss: 1.537791, ce: 0.375434, reg: 51.369389, reg_best: 54.179981
step:  56, cost: 2.26E-02, attack: 0.985, loss: 1.429218, ce: 0.237772, reg: 52.654945, reg_best: 54.179981
step:  57, cost: 2.26E-02, attack: 0.990, loss: 1.433386, ce: 0.147451, reg: 56.830799, reg_best: 54.179981
step:  58, cost: 2.26E-02, attack: 0.990, loss: 1.391555, ce: 0.150889, reg: 54.830208, reg_best: 54.179981
step:  59, cost: 2.26E-02, attack: 0.993, loss: 1.321294, ce: 0.119614, reg: 53.107250, reg_best: 53.107250
step:  60, cost: 2.26E-02, attack: 0.980, loss: 1.494414, ce: 0.330537, reg: 51.436565, reg_best: 53.107250
step:  61, cost: 2.26E-02, attack: 0.988, loss: 1.412072, ce: 0.181001, reg: 54.406155, reg_best: 53.107250
step:  62, cost: 2.26E-02, attack: 0.991, loss: 1.414799, ce: 0.151377, reg: 55.835903, reg_best: 53.107250
step:  63, cost: 2.26E-02, attack: 0.995, loss: 1.294808, ce: 0.096619, reg: 52.952953, reg_best: 52.952953
step:  64, cost: 2.26E-02, attack: 0.995, loss: 1.357802, ce: 0.092367, reg: 55.929581, reg_best: 52.952953
step:  65, cost: 2.26E-02, attack: 0.994, loss: 1.353749, ce: 0.099397, reg: 55.435055, reg_best: 52.952953
step:  66, cost: 2.26E-02, attack: 0.995, loss: 1.368177, ce: 0.108185, reg: 55.684288, reg_best: 52.952953
up cost from 2.26E-02 to 4.53E-02
step:  67, cost: 4.53E-02, attack: 0.984, loss: 2.572841, ce: 0.259005, reg: 51.129021, reg_best: 52.952953
step:  68, cost: 4.53E-02, attack: 0.984, loss: 2.613980, ce: 0.263687, reg: 51.934643, reg_best: 52.952953
step:  69, cost: 4.53E-02, attack: 0.980, loss: 2.648335, ce: 0.306187, reg: 51.754635, reg_best: 52.952953
step:  70, cost: 4.53E-02, attack: 0.981, loss: 2.688143, ce: 0.302783, reg: 52.709503, reg_best: 52.952953
step:  71, cost: 4.53E-02, attack: 0.992, loss: 2.527492, ce: 0.148148, reg: 52.576569, reg_best: 52.576569
step:  72, cost: 4.53E-02, attack: 0.981, loss: 2.544265, ce: 0.319191, reg: 49.167637, reg_best: 52.576569
step:  73, cost: 4.53E-02, attack: 0.980, loss: 2.598140, ce: 0.335304, reg: 50.002075, reg_best: 52.576569
step:  74, cost: 4.53E-02, attack: 0.988, loss: 2.573324, ce: 0.198575, reg: 52.475033, reg_best: 52.576569
step:  75, cost: 4.53E-02, attack: 0.977, loss: 2.646379, ce: 0.361235, reg: 50.495014, reg_best: 52.576569
step:  76, cost: 4.53E-02, attack: 0.982, loss: 2.567779, ce: 0.312807, reg: 49.828304, reg_best: 52.576569
down cost from 4.53E-02 to 1.60E-02
step:  77, cost: 1.60E-02, attack: 0.986, loss: 1.082905, ce: 0.235668, reg: 52.965725, reg_best: 52.576569
step:  78, cost: 1.60E-02, attack: 0.993, loss: 0.996819, ce: 0.115897, reg: 55.057621, reg_best: 52.576569
step:  79, cost: 1.60E-02, attack: 0.994, loss: 0.989381, ce: 0.118389, reg: 54.436966, reg_best: 52.576569
step:  80, cost: 1.60E-02, attack: 0.996, loss: 0.980766, ce: 0.066890, reg: 57.117222, reg_best: 52.576569
step:  81, cost: 1.60E-02, attack: 0.996, loss: 0.939885, ce: 0.070892, reg: 54.312069, reg_best: 52.576569
step:  82, cost: 1.60E-02, attack: 0.991, loss: 1.011268, ce: 0.149481, reg: 53.861710, reg_best: 52.576569
up cost from 1.60E-02 to 3.20E-02
step:  83, cost: 3.20E-02, attack: 0.988, loss: 1.905312, ce: 0.179235, reg: 53.939911, reg_best: 52.576569
step:  84, cost: 3.20E-02, attack: 0.989, loss: 1.853142, ce: 0.182013, reg: 52.222786, reg_best: 52.576569
step:  85, cost: 3.20E-02, attack: 0.991, loss: 1.864096, ce: 0.155395, reg: 53.396896, reg_best: 52.576569
step:  86, cost: 3.20E-02, attack: 0.986, loss: 1.912163, ce: 0.225243, reg: 52.716225, reg_best: 52.576569
step:  87, cost: 3.20E-02, attack: 0.991, loss: 1.874616, ce: 0.164981, reg: 53.426079, reg_best: 52.576569
step:  88, cost: 3.20E-02, attack: 0.992, loss: 1.857792, ce: 0.150482, reg: 53.353424, reg_best: 52.576569
step:  89, cost: 3.20E-02, attack: 0.991, loss: 1.799146, ce: 0.161197, reg: 51.185921, reg_best: 51.185921
step:  90, cost: 3.20E-02, attack: 0.983, loss: 1.885368, ce: 0.268732, reg: 50.527920, reg_best: 51.185921
step:  91, cost: 3.20E-02, attack: 0.984, loss: 1.952000, ce: 0.271718, reg: 52.508812, reg_best: 51.185921
step:  92, cost: 3.20E-02, attack: 0.997, loss: 1.731210, ce: 0.075276, reg: 51.747959, reg_best: 51.185921
step:  93, cost: 3.20E-02, attack: 0.977, loss: 1.930267, ce: 0.376282, reg: 48.562023, reg_best: 51.185921
step:  94, cost: 3.20E-02, attack: 0.988, loss: 1.876083, ce: 0.203207, reg: 52.277374, reg_best: 51.185921
step:  95, cost: 3.20E-02, attack: 0.984, loss: 1.948209, ce: 0.250387, reg: 53.056938, reg_best: 51.185921
step:  96, cost: 3.20E-02, attack: 0.985, loss: 1.877771, ce: 0.249449, reg: 50.885052, reg_best: 51.185921
step:  97, cost: 3.20E-02, attack: 0.990, loss: 1.866218, ce: 0.162956, reg: 53.226948, reg_best: 51.185921
down cost from 3.20E-02 to 1.13E-02
step:  98, cost: 1.13E-02, attack: 0.999, loss: 0.675886, ce: 0.034372, reg: 56.702324, reg_best: 51.185921
step:  99, cost: 1.13E-02, attack: 0.996, loss: 0.707640, ce: 0.065996, reg: 56.713886, reg_best: 51.185921
pattern, shape: (32, 32, 3), min: 0.000008, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 26: 51.916237
visualization cost 20.201195 seconds
processing label 27
resetting state
mask_tanh -4.337930135094203 3.2169716156134522
pattern_tanh -4.632612204352712 4.3308701626248345
step:   0, cost: 0.00E+00, attack: 0.875, loss: 2.078597, ce: 2.078597, reg: 548.584534, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.002546, ce: 0.002546, reg: 564.883911, reg_best: 564.883911
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000077, ce: 0.000077, reg: 568.408752, reg_best: 564.883911
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 569.704590, reg_best: 564.883911
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 570.100220, reg_best: 564.883911
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000005, ce: 0.000005, reg: 571.488464, reg_best: 564.883911
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.999, loss: 0.435359, ce: 0.021105, reg: 414.253571, reg_best: 414.253571
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.318136, ce: 0.029874, reg: 288.262512, reg_best: 288.262512
step:   8, cost: 1.00E-03, attack: 0.997, loss: 0.259949, ce: 0.046198, reg: 213.751526, reg_best: 213.751526
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.198088, ce: 0.020431, reg: 177.657455, reg_best: 177.657455
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.346672, ce: 0.020413, reg: 163.129684, reg_best: 163.129684
step:  11, cost: 2.00E-03, attack: 0.996, loss: 0.343553, ce: 0.058372, reg: 142.590317, reg_best: 142.590317
step:  12, cost: 2.00E-03, attack: 0.997, loss: 0.306500, ce: 0.037938, reg: 134.280777, reg_best: 134.280777
step:  13, cost: 2.00E-03, attack: 1.000, loss: 0.268783, ce: 0.004663, reg: 132.059631, reg_best: 132.059631
step:  14, cost: 2.00E-03, attack: 0.997, loss: 0.259928, ce: 0.044793, reg: 107.567345, reg_best: 107.567345
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.998, loss: 0.450853, ce: 0.038499, reg: 103.081573, reg_best: 103.081573
step:  16, cost: 4.00E-03, attack: 0.997, loss: 0.440676, ce: 0.049822, reg: 97.713524, reg_best: 97.713524
step:  17, cost: 4.00E-03, attack: 0.998, loss: 0.415842, ce: 0.020965, reg: 98.719414, reg_best: 97.713524
step:  18, cost: 4.00E-03, attack: 0.998, loss: 0.414748, ce: 0.035280, reg: 94.866875, reg_best: 94.866875
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.389540, ce: 0.015841, reg: 93.424744, reg_best: 93.424744
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.999, loss: 0.745039, ce: 0.024783, reg: 90.032021, reg_best: 90.032021
step:  21, cost: 8.00E-03, attack: 0.996, loss: 0.770237, ce: 0.067609, reg: 87.828423, reg_best: 87.828423
step:  22, cost: 8.00E-03, attack: 0.995, loss: 0.773505, ce: 0.088978, reg: 85.565811, reg_best: 85.565811
step:  23, cost: 8.00E-03, attack: 0.996, loss: 0.755474, ce: 0.084148, reg: 83.915794, reg_best: 83.915794
step:  24, cost: 8.00E-03, attack: 0.997, loss: 0.759589, ce: 0.051649, reg: 88.492439, reg_best: 83.915794
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.993, loss: 1.407714, ce: 0.116654, reg: 80.691307, reg_best: 80.691307
step:  26, cost: 1.60E-02, attack: 0.991, loss: 1.391257, ce: 0.149477, reg: 77.611252, reg_best: 77.611252
step:  27, cost: 1.60E-02, attack: 0.990, loss: 1.398703, ce: 0.171645, reg: 76.691101, reg_best: 77.611252
step:  28, cost: 1.60E-02, attack: 0.993, loss: 1.352289, ce: 0.123032, reg: 76.836334, reg_best: 76.836334
step:  29, cost: 1.60E-02, attack: 0.996, loss: 1.326577, ce: 0.089122, reg: 77.340881, reg_best: 76.836334
step:  30, cost: 1.60E-02, attack: 0.987, loss: 1.413478, ce: 0.221883, reg: 74.474693, reg_best: 76.836334
step:  31, cost: 1.60E-02, attack: 0.992, loss: 1.327535, ce: 0.136737, reg: 74.424889, reg_best: 74.424889
step:  32, cost: 1.60E-02, attack: 0.990, loss: 1.312451, ce: 0.168807, reg: 71.477783, reg_best: 74.424889
step:  33, cost: 1.60E-02, attack: 0.990, loss: 1.366817, ce: 0.158468, reg: 75.521812, reg_best: 74.424889
step:  34, cost: 1.60E-02, attack: 0.994, loss: 1.307231, ce: 0.096501, reg: 75.670593, reg_best: 74.424889
step:  35, cost: 1.60E-02, attack: 0.993, loss: 1.353761, ce: 0.110731, reg: 77.689369, reg_best: 74.424889
step:  36, cost: 1.60E-02, attack: 0.992, loss: 1.307790, ce: 0.147513, reg: 72.517296, reg_best: 72.517296
step:  37, cost: 1.60E-02, attack: 0.999, loss: 1.246174, ce: 0.036793, reg: 75.586319, reg_best: 72.517296
step:  38, cost: 1.60E-02, attack: 0.993, loss: 1.288675, ce: 0.129201, reg: 72.467140, reg_best: 72.467140
up cost from 1.60E-02 to 3.20E-02
step:  39, cost: 3.20E-02, attack: 0.981, loss: 2.465897, ce: 0.342420, reg: 66.358627, reg_best: 72.467140
step:  40, cost: 3.20E-02, attack: 0.989, loss: 2.396587, ce: 0.198634, reg: 68.686020, reg_best: 72.467140
step:  41, cost: 3.20E-02, attack: 0.988, loss: 2.395913, ce: 0.207535, reg: 68.382835, reg_best: 72.467140
step:  42, cost: 3.20E-02, attack: 0.982, loss: 2.463617, ce: 0.279855, reg: 68.242561, reg_best: 72.467140
step:  43, cost: 3.20E-02, attack: 0.989, loss: 2.441082, ce: 0.185113, reg: 70.499016, reg_best: 72.467140
down cost from 3.20E-02 to 1.13E-02
step:  44, cost: 1.13E-02, attack: 0.997, loss: 0.897518, ce: 0.051561, reg: 74.772758, reg_best: 72.467140
step:  45, cost: 1.13E-02, attack: 0.996, loss: 0.900451, ce: 0.082452, reg: 72.301666, reg_best: 72.301666
step:  46, cost: 1.13E-02, attack: 0.995, loss: 0.918984, ce: 0.085963, reg: 73.629326, reg_best: 72.301666
step:  47, cost: 1.13E-02, attack: 0.994, loss: 0.889124, ce: 0.085385, reg: 71.041191, reg_best: 71.041191
step:  48, cost: 1.13E-02, attack: 0.993, loss: 0.916690, ce: 0.089958, reg: 73.073471, reg_best: 71.041191
up cost from 1.13E-02 to 2.26E-02
step:  49, cost: 2.26E-02, attack: 0.993, loss: 1.784729, ce: 0.122625, reg: 73.455307, reg_best: 71.041191
step:  50, cost: 2.26E-02, attack: 0.988, loss: 1.710485, ce: 0.206265, reg: 66.477776, reg_best: 71.041191
step:  51, cost: 2.26E-02, attack: 0.987, loss: 1.812773, ce: 0.234583, reg: 69.746819, reg_best: 71.041191
step:  52, cost: 2.26E-02, attack: 0.990, loss: 1.714071, ce: 0.162683, reg: 68.562325, reg_best: 71.041191
step:  53, cost: 2.26E-02, attack: 0.979, loss: 1.843052, ce: 0.361677, reg: 65.468147, reg_best: 71.041191
step:  54, cost: 2.26E-02, attack: 0.986, loss: 1.804558, ce: 0.233226, reg: 69.394569, reg_best: 71.041191
down cost from 2.26E-02 to 8.00E-03
step:  55, cost: 8.00E-03, attack: 0.996, loss: 0.687586, ce: 0.079035, reg: 76.068848, reg_best: 71.041191
step:  56, cost: 8.00E-03, attack: 0.999, loss: 0.622255, ce: 0.021183, reg: 75.133980, reg_best: 71.041191
step:  57, cost: 8.00E-03, attack: 0.998, loss: 0.629576, ce: 0.036038, reg: 74.192238, reg_best: 71.041191
step:  58, cost: 8.00E-03, attack: 0.995, loss: 0.675353, ce: 0.085674, reg: 73.709824, reg_best: 71.041191
step:  59, cost: 8.00E-03, attack: 0.992, loss: 0.711588, ce: 0.139071, reg: 71.564651, reg_best: 71.041191
up cost from 8.00E-03 to 1.60E-02
step:  60, cost: 1.60E-02, attack: 0.991, loss: 1.253103, ce: 0.141922, reg: 69.448784, reg_best: 69.448784
step:  61, cost: 1.60E-02, attack: 0.990, loss: 1.285300, ce: 0.186478, reg: 68.676346, reg_best: 69.448784
step:  62, cost: 1.60E-02, attack: 0.990, loss: 1.291852, ce: 0.155304, reg: 71.034233, reg_best: 69.448784
step:  63, cost: 1.60E-02, attack: 0.995, loss: 1.227180, ce: 0.075895, reg: 71.955315, reg_best: 69.448784
step:  64, cost: 1.60E-02, attack: 0.995, loss: 1.247308, ce: 0.076697, reg: 73.163231, reg_best: 69.448784
step:  65, cost: 1.60E-02, attack: 0.988, loss: 1.308400, ce: 0.199767, reg: 69.289597, reg_best: 69.448784
step:  66, cost: 1.60E-02, attack: 0.996, loss: 1.221367, ce: 0.076844, reg: 71.546661, reg_best: 69.448784
step:  67, cost: 1.60E-02, attack: 0.993, loss: 1.240180, ce: 0.124333, reg: 69.740440, reg_best: 69.448784
step:  68, cost: 1.60E-02, attack: 0.995, loss: 1.233823, ce: 0.085889, reg: 71.745903, reg_best: 69.448784
step:  69, cost: 1.60E-02, attack: 0.993, loss: 1.248764, ce: 0.125190, reg: 70.223389, reg_best: 69.448784
step:  70, cost: 1.60E-02, attack: 0.988, loss: 1.306516, ce: 0.209689, reg: 68.551697, reg_best: 69.448784
step:  71, cost: 1.60E-02, attack: 0.997, loss: 1.182897, ce: 0.064704, reg: 69.887077, reg_best: 69.448784
step:  72, cost: 1.60E-02, attack: 0.994, loss: 1.274281, ce: 0.122415, reg: 71.991623, reg_best: 69.448784
step:  73, cost: 1.60E-02, attack: 0.996, loss: 1.227244, ce: 0.071701, reg: 72.221436, reg_best: 69.448784
step:  74, cost: 1.60E-02, attack: 0.992, loss: 1.292585, ce: 0.142439, reg: 71.884102, reg_best: 69.448784
step:  75, cost: 1.60E-02, attack: 0.999, loss: 1.215332, ce: 0.038282, reg: 73.565628, reg_best: 69.448784
up cost from 1.60E-02 to 3.20E-02
step:  76, cost: 3.20E-02, attack: 0.989, loss: 2.358137, ce: 0.181248, reg: 68.027740, reg_best: 69.448784
step:  77, cost: 3.20E-02, attack: 0.988, loss: 2.342128, ce: 0.191845, reg: 67.196358, reg_best: 69.448784
step:  78, cost: 3.20E-02, attack: 0.981, loss: 2.416815, ce: 0.308824, reg: 65.874687, reg_best: 69.448784
step:  79, cost: 3.20E-02, attack: 0.985, loss: 2.440519, ce: 0.259284, reg: 68.166779, reg_best: 69.448784
step:  80, cost: 3.20E-02, attack: 0.988, loss: 2.341445, ce: 0.202525, reg: 66.841240, reg_best: 69.448784
down cost from 3.20E-02 to 1.13E-02
step:  81, cost: 1.13E-02, attack: 0.992, loss: 0.902889, ce: 0.131060, reg: 68.220665, reg_best: 68.220665
step:  82, cost: 1.13E-02, attack: 0.989, loss: 0.969179, ce: 0.174050, reg: 70.280121, reg_best: 68.220665
step:  83, cost: 1.13E-02, attack: 0.998, loss: 0.843419, ce: 0.036067, reg: 71.360504, reg_best: 68.220665
step:  84, cost: 1.13E-02, attack: 0.991, loss: 0.953052, ce: 0.156404, reg: 70.414398, reg_best: 68.220665
step:  85, cost: 1.13E-02, attack: 0.995, loss: 0.883034, ce: 0.073990, reg: 71.510101, reg_best: 68.220665
step:  86, cost: 1.13E-02, attack: 0.994, loss: 0.884541, ce: 0.093374, reg: 69.929916, reg_best: 68.220665
step:  87, cost: 1.13E-02, attack: 0.993, loss: 0.903165, ce: 0.109836, reg: 70.120987, reg_best: 68.220665
up cost from 1.13E-02 to 2.26E-02
step:  88, cost: 2.26E-02, attack: 0.992, loss: 1.722380, ce: 0.135624, reg: 70.125381, reg_best: 68.220665
step:  89, cost: 2.26E-02, attack: 0.991, loss: 1.682869, ce: 0.159999, reg: 67.301987, reg_best: 67.301987
step:  90, cost: 2.26E-02, attack: 0.994, loss: 1.717844, ce: 0.128679, reg: 70.231804, reg_best: 67.301987
step:  91, cost: 2.26E-02, attack: 0.989, loss: 1.749729, ce: 0.187531, reg: 69.040039, reg_best: 67.301987
step:  92, cost: 2.26E-02, attack: 0.984, loss: 1.726357, ce: 0.267916, reg: 64.442741, reg_best: 67.301987
step:  93, cost: 2.26E-02, attack: 0.993, loss: 1.693717, ce: 0.123090, reg: 69.412598, reg_best: 67.301987
step:  94, cost: 2.26E-02, attack: 0.994, loss: 1.640312, ce: 0.103438, reg: 67.920876, reg_best: 67.301987
step:  95, cost: 2.26E-02, attack: 0.996, loss: 1.632812, ce: 0.071289, reg: 69.010201, reg_best: 67.301987
step:  96, cost: 2.26E-02, attack: 0.991, loss: 1.689292, ce: 0.146594, reg: 68.178268, reg_best: 67.301987
step:  97, cost: 2.26E-02, attack: 0.991, loss: 1.669280, ce: 0.158549, reg: 66.765526, reg_best: 66.765526
up cost from 2.26E-02 to 4.53E-02
step:  98, cost: 4.53E-02, attack: 0.988, loss: 3.275851, ce: 0.214750, reg: 67.641426, reg_best: 66.765526
step:  99, cost: 4.53E-02, attack: 0.979, loss: 3.302257, ce: 0.333382, reg: 65.603477, reg_best: 66.765526
pattern, shape: (32, 32, 3), min: 0.000008, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 27: 67.219124
visualization cost 20.278185 seconds
processing label 28
resetting state
mask_tanh -3.3368295104048227 3.118693848561017
pattern_tanh -4.479551059034542 4.672866217404171
step:   0, cost: 0.00E+00, attack: 0.872, loss: 2.199105, ce: 2.199105, reg: 544.604309, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000016, ce: 0.000016, reg: 562.472717, reg_best: 562.472717
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000005, ce: 0.000005, reg: 562.621887, reg_best: 562.472717
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 562.885925, reg_best: 562.472717
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 563.354736, reg_best: 562.472717
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 565.977356, reg_best: 562.472717
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.999, loss: 0.414160, ce: 0.024116, reg: 390.044220, reg_best: 390.044220
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.290233, ce: 0.032816, reg: 257.417175, reg_best: 257.417175
step:   8, cost: 1.00E-03, attack: 0.998, loss: 0.220061, ce: 0.029882, reg: 190.178711, reg_best: 190.178711
step:   9, cost: 1.00E-03, attack: 0.996, loss: 0.235606, ce: 0.070410, reg: 165.196320, reg_best: 165.196320
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 1.000, loss: 0.306088, ce: 0.008058, reg: 149.015060, reg_best: 149.015060
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.312478, ce: 0.033587, reg: 139.445618, reg_best: 139.445618
step:  12, cost: 2.00E-03, attack: 1.000, loss: 0.271922, ce: 0.005850, reg: 133.036072, reg_best: 133.036072
step:  13, cost: 2.00E-03, attack: 0.993, loss: 0.339590, ce: 0.112361, reg: 113.614166, reg_best: 113.614166
step:  14, cost: 2.00E-03, attack: 0.997, loss: 0.271496, ce: 0.046014, reg: 112.740593, reg_best: 112.740593
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.998, loss: 0.457547, ce: 0.036362, reg: 105.296104, reg_best: 105.296104
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.438485, ce: 0.039076, reg: 99.852036, reg_best: 99.852036
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.395745, ce: 0.018923, reg: 94.204842, reg_best: 94.204842
step:  18, cost: 4.00E-03, attack: 0.995, loss: 0.427818, ce: 0.075114, reg: 88.175835, reg_best: 88.175835
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.403554, ce: 0.049399, reg: 88.538658, reg_best: 88.175835
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.997, loss: 0.741443, ce: 0.046996, reg: 86.805862, reg_best: 86.805862
step:  21, cost: 8.00E-03, attack: 0.995, loss: 0.769997, ce: 0.092929, reg: 84.633453, reg_best: 84.633453
step:  22, cost: 8.00E-03, attack: 0.995, loss: 0.756372, ce: 0.098932, reg: 82.179924, reg_best: 82.179924
step:  23, cost: 8.00E-03, attack: 0.993, loss: 0.775020, ce: 0.121289, reg: 81.716415, reg_best: 81.716415
step:  24, cost: 8.00E-03, attack: 0.992, loss: 0.761341, ce: 0.138773, reg: 77.820992, reg_best: 77.820992
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.980, loss: 1.490985, ce: 0.322313, reg: 73.042046, reg_best: 77.820992
step:  26, cost: 1.60E-02, attack: 0.991, loss: 1.348158, ce: 0.169187, reg: 73.685722, reg_best: 73.685722
step:  27, cost: 1.60E-02, attack: 0.993, loss: 1.282820, ce: 0.117411, reg: 72.838112, reg_best: 72.838112
step:  28, cost: 1.60E-02, attack: 0.985, loss: 1.405234, ce: 0.230361, reg: 73.429558, reg_best: 72.838112
step:  29, cost: 1.60E-02, attack: 0.991, loss: 1.300246, ce: 0.153754, reg: 71.655731, reg_best: 71.655731
step:  30, cost: 1.60E-02, attack: 0.994, loss: 1.246494, ce: 0.111261, reg: 70.948273, reg_best: 70.948273
step:  31, cost: 1.60E-02, attack: 0.987, loss: 1.282607, ce: 0.233188, reg: 65.588684, reg_best: 70.948273
step:  32, cost: 1.60E-02, attack: 0.988, loss: 1.288899, ce: 0.200342, reg: 68.034775, reg_best: 70.948273
step:  33, cost: 1.60E-02, attack: 0.993, loss: 1.259753, ce: 0.121869, reg: 71.117737, reg_best: 70.948273
step:  34, cost: 1.60E-02, attack: 0.992, loss: 1.247313, ce: 0.124032, reg: 70.205070, reg_best: 70.205070
step:  35, cost: 1.60E-02, attack: 0.992, loss: 1.258382, ce: 0.143534, reg: 69.678032, reg_best: 69.678032
step:  36, cost: 1.60E-02, attack: 0.990, loss: 1.263025, ce: 0.157492, reg: 69.095802, reg_best: 69.678032
step:  37, cost: 1.60E-02, attack: 0.992, loss: 1.275138, ce: 0.130778, reg: 71.522507, reg_best: 69.678032
step:  38, cost: 1.60E-02, attack: 0.991, loss: 1.269462, ce: 0.158220, reg: 69.452629, reg_best: 69.452629
step:  39, cost: 1.60E-02, attack: 0.994, loss: 1.239538, ce: 0.093099, reg: 71.652481, reg_best: 69.452629
step:  40, cost: 1.60E-02, attack: 0.993, loss: 1.258545, ce: 0.139480, reg: 69.941566, reg_best: 69.452629
step:  41, cost: 1.60E-02, attack: 0.993, loss: 1.266129, ce: 0.123618, reg: 71.406906, reg_best: 69.452629
up cost from 1.60E-02 to 3.20E-02
step:  42, cost: 3.20E-02, attack: 0.990, loss: 2.315764, ce: 0.160375, reg: 67.355927, reg_best: 69.452629
step:  43, cost: 3.20E-02, attack: 0.986, loss: 2.316032, ce: 0.243276, reg: 64.778061, reg_best: 69.452629
step:  44, cost: 3.20E-02, attack: 0.984, loss: 2.328637, ce: 0.245360, reg: 65.102402, reg_best: 69.452629
step:  45, cost: 3.20E-02, attack: 0.990, loss: 2.336228, ce: 0.177925, reg: 67.446983, reg_best: 69.452629
step:  46, cost: 3.20E-02, attack: 0.984, loss: 2.330239, ce: 0.271136, reg: 64.346977, reg_best: 69.452629
down cost from 3.20E-02 to 1.13E-02
step:  47, cost: 1.13E-02, attack: 0.995, loss: 0.833901, ce: 0.091929, reg: 65.581703, reg_best: 65.581703
step:  48, cost: 1.13E-02, attack: 0.995, loss: 0.900238, ce: 0.085154, reg: 72.043938, reg_best: 65.581703
step:  49, cost: 1.13E-02, attack: 0.996, loss: 0.866490, ce: 0.063355, reg: 70.987755, reg_best: 65.581703
step:  50, cost: 1.13E-02, attack: 0.992, loss: 0.875626, ce: 0.127571, reg: 66.119339, reg_best: 65.581703
step:  51, cost: 1.13E-02, attack: 0.996, loss: 0.821397, ce: 0.064741, reg: 66.879585, reg_best: 65.581703
up cost from 1.13E-02 to 2.26E-02
step:  52, cost: 2.26E-02, attack: 0.992, loss: 1.660036, ce: 0.166134, reg: 66.021751, reg_best: 65.581703
step:  53, cost: 2.26E-02, attack: 0.987, loss: 1.678726, ce: 0.210902, reg: 64.869247, reg_best: 65.581703
step:  54, cost: 2.26E-02, attack: 0.987, loss: 1.658791, ce: 0.205792, reg: 64.214050, reg_best: 65.581703
step:  55, cost: 2.26E-02, attack: 0.994, loss: 1.649140, ce: 0.118324, reg: 67.663292, reg_best: 65.581703
step:  56, cost: 2.26E-02, attack: 0.993, loss: 1.652032, ce: 0.105274, reg: 68.357697, reg_best: 65.581703
step:  57, cost: 2.26E-02, attack: 0.990, loss: 1.683683, ce: 0.160652, reg: 67.309113, reg_best: 65.581703
step:  58, cost: 2.26E-02, attack: 0.990, loss: 1.643361, ce: 0.172426, reg: 65.006752, reg_best: 65.581703
step:  59, cost: 2.26E-02, attack: 0.995, loss: 1.624611, ce: 0.090198, reg: 67.812111, reg_best: 65.581703
step:  60, cost: 2.26E-02, attack: 0.991, loss: 1.641296, ce: 0.158374, reg: 65.536514, reg_best: 65.536514
step:  61, cost: 2.26E-02, attack: 0.991, loss: 1.679480, ce: 0.158484, reg: 67.219185, reg_best: 65.536514
step:  62, cost: 2.26E-02, attack: 0.990, loss: 1.601638, ce: 0.181462, reg: 62.763485, reg_best: 65.536514
step:  63, cost: 2.26E-02, attack: 0.992, loss: 1.653035, ce: 0.135722, reg: 67.056366, reg_best: 65.536514
step:  64, cost: 2.26E-02, attack: 0.994, loss: 1.577785, ce: 0.109784, reg: 64.877052, reg_best: 64.877052
step:  65, cost: 2.26E-02, attack: 0.993, loss: 1.665586, ce: 0.137538, reg: 67.530823, reg_best: 64.877052
step:  66, cost: 2.26E-02, attack: 0.991, loss: 1.631056, ce: 0.141655, reg: 65.822838, reg_best: 64.877052
step:  67, cost: 2.26E-02, attack: 0.992, loss: 1.611188, ce: 0.113134, reg: 66.205269, reg_best: 64.877052
up cost from 2.26E-02 to 4.53E-02
step:  68, cost: 4.53E-02, attack: 0.982, loss: 3.152461, ce: 0.304482, reg: 62.922390, reg_best: 64.877052
step:  69, cost: 4.53E-02, attack: 0.986, loss: 3.049376, ce: 0.229085, reg: 62.320225, reg_best: 64.877052
step:  70, cost: 4.53E-02, attack: 0.979, loss: 3.025897, ce: 0.337666, reg: 59.402061, reg_best: 64.877052
step:  71, cost: 4.53E-02, attack: 0.982, loss: 3.178881, ce: 0.324342, reg: 63.076988, reg_best: 64.877052
step:  72, cost: 4.53E-02, attack: 0.987, loss: 3.020128, ce: 0.233355, reg: 61.579544, reg_best: 64.877052
down cost from 4.53E-02 to 1.60E-02
step:  73, cost: 1.60E-02, attack: 0.990, loss: 1.184690, ce: 0.177040, reg: 62.978096, reg_best: 64.877052
step:  74, cost: 1.60E-02, attack: 0.991, loss: 1.232134, ce: 0.165310, reg: 66.676506, reg_best: 64.877052
step:  75, cost: 1.60E-02, attack: 0.996, loss: 1.161753, ce: 0.077622, reg: 67.758171, reg_best: 64.877052
step:  76, cost: 1.60E-02, attack: 0.992, loss: 1.210984, ce: 0.144589, reg: 66.649719, reg_best: 64.877052
step:  77, cost: 1.60E-02, attack: 0.992, loss: 1.177405, ce: 0.115222, reg: 66.386452, reg_best: 64.877052
step:  78, cost: 1.60E-02, attack: 0.988, loss: 1.234467, ce: 0.184080, reg: 65.649162, reg_best: 64.877052
step:  79, cost: 1.60E-02, attack: 0.993, loss: 1.220825, ce: 0.136395, reg: 67.776886, reg_best: 64.877052
step:  80, cost: 1.60E-02, attack: 0.998, loss: 1.115410, ce: 0.035731, reg: 67.479897, reg_best: 64.877052
step:  81, cost: 1.60E-02, attack: 0.988, loss: 1.217564, ce: 0.203527, reg: 63.387318, reg_best: 64.877052
step:  82, cost: 1.60E-02, attack: 0.992, loss: 1.150360, ce: 0.128351, reg: 63.875538, reg_best: 63.875538
step:  83, cost: 1.60E-02, attack: 0.990, loss: 1.184242, ce: 0.179773, reg: 62.779346, reg_best: 63.875538
step:  84, cost: 1.60E-02, attack: 0.991, loss: 1.192845, ce: 0.169643, reg: 63.950127, reg_best: 63.875538
step:  85, cost: 1.60E-02, attack: 0.995, loss: 1.145403, ce: 0.082265, reg: 66.446114, reg_best: 63.875538
step:  86, cost: 1.60E-02, attack: 0.989, loss: 1.196644, ce: 0.188501, reg: 63.008923, reg_best: 63.875538
step:  87, cost: 1.60E-02, attack: 0.994, loss: 1.149927, ce: 0.099010, reg: 65.682327, reg_best: 63.875538
step:  88, cost: 1.60E-02, attack: 0.993, loss: 1.146692, ce: 0.092886, reg: 65.862823, reg_best: 63.875538
step:  89, cost: 1.60E-02, attack: 0.995, loss: 1.136393, ce: 0.088904, reg: 65.468033, reg_best: 63.875538
step:  90, cost: 1.60E-02, attack: 0.987, loss: 1.258752, ce: 0.216284, reg: 65.154289, reg_best: 63.875538
step:  91, cost: 1.60E-02, attack: 0.985, loss: 1.272890, ce: 0.254136, reg: 63.672092, reg_best: 63.875538
step:  92, cost: 1.60E-02, attack: 0.993, loss: 1.187294, ce: 0.081451, reg: 69.115158, reg_best: 63.875538
step:  93, cost: 1.60E-02, attack: 0.995, loss: 1.175812, ce: 0.096239, reg: 67.473351, reg_best: 63.875538
step:  94, cost: 1.60E-02, attack: 0.993, loss: 1.180662, ce: 0.116952, reg: 66.485367, reg_best: 63.875538
step:  95, cost: 1.60E-02, attack: 0.989, loss: 1.228523, ce: 0.192539, reg: 64.748955, reg_best: 63.875538
step:  96, cost: 1.60E-02, attack: 0.996, loss: 1.139613, ce: 0.072143, reg: 66.716873, reg_best: 63.875538
step:  97, cost: 1.60E-02, attack: 0.993, loss: 1.159751, ce: 0.119941, reg: 64.988144, reg_best: 63.875538
step:  98, cost: 1.60E-02, attack: 0.993, loss: 1.163366, ce: 0.106995, reg: 66.023178, reg_best: 63.875538
step:  99, cost: 1.60E-02, attack: 0.995, loss: 1.168215, ce: 0.073737, reg: 68.404854, reg_best: 63.875538
pattern, shape: (32, 32, 3), min: 0.000000, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 28: 58.758976
visualization cost 22.113971 seconds
processing label 29
resetting state
mask_tanh -3.5438573227081167 3.58218238984685
pattern_tanh -5.025345660521124 4.001886984837192
step:   0, cost: 0.00E+00, attack: 0.901, loss: 1.667673, ce: 1.667673, reg: 534.013062, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000071, ce: 0.000071, reg: 546.043152, reg_best: 546.043152
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000007, ce: 0.000007, reg: 546.370972, reg_best: 546.043152
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000011, ce: 0.000011, reg: 547.549683, reg_best: 546.043152
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000012, ce: 0.000012, reg: 548.783447, reg_best: 546.043152
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 559.139526, reg_best: 546.043152
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.436274, ce: 0.055988, reg: 379.770630, reg_best: 379.770630
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.301498, ce: 0.000067, reg: 301.430939, reg_best: 301.430939
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.243282, ce: 0.013368, reg: 229.913803, reg_best: 229.913803
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.222153, ce: 0.014887, reg: 207.266449, reg_best: 207.266449
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.994, loss: 0.426193, ce: 0.100417, reg: 162.887848, reg_best: 162.887848
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.312681, ce: 0.024860, reg: 143.910156, reg_best: 143.910156
step:  12, cost: 2.00E-03, attack: 0.997, loss: 0.315010, ce: 0.054715, reg: 130.147858, reg_best: 130.147858
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.266119, ce: 0.015891, reg: 125.114037, reg_best: 125.114037
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.246516, ce: 0.011368, reg: 117.574272, reg_best: 117.574272
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.995, loss: 0.521186, ce: 0.070430, reg: 112.688980, reg_best: 112.688980
step:  16, cost: 4.00E-03, attack: 0.996, loss: 0.473368, ce: 0.059601, reg: 103.441696, reg_best: 103.441696
step:  17, cost: 4.00E-03, attack: 0.998, loss: 0.461862, ce: 0.039225, reg: 105.659210, reg_best: 103.441696
step:  18, cost: 4.00E-03, attack: 0.995, loss: 0.471347, ce: 0.083428, reg: 96.979607, reg_best: 96.979607
step:  19, cost: 4.00E-03, attack: 0.997, loss: 0.438459, ce: 0.052282, reg: 96.541977, reg_best: 96.541977
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.992, loss: 0.849115, ce: 0.148651, reg: 87.557945, reg_best: 87.557945
step:  21, cost: 8.00E-03, attack: 0.991, loss: 0.846886, ce: 0.153426, reg: 86.682426, reg_best: 86.682426
step:  22, cost: 8.00E-03, attack: 0.987, loss: 0.879100, ce: 0.216093, reg: 82.875923, reg_best: 86.682426
step:  23, cost: 8.00E-03, attack: 0.990, loss: 0.804781, ce: 0.147387, reg: 82.174240, reg_best: 86.682426
step:  24, cost: 8.00E-03, attack: 0.989, loss: 0.853602, ce: 0.190853, reg: 82.843597, reg_best: 86.682426
step:  25, cost: 8.00E-03, attack: 0.994, loss: 0.771594, ce: 0.104279, reg: 83.414459, reg_best: 83.414459
step:  26, cost: 8.00E-03, attack: 0.994, loss: 0.780144, ce: 0.105436, reg: 84.338509, reg_best: 83.414459
step:  27, cost: 8.00E-03, attack: 0.993, loss: 0.767152, ce: 0.120340, reg: 80.851570, reg_best: 80.851570
step:  28, cost: 8.00E-03, attack: 0.994, loss: 0.734472, ce: 0.091861, reg: 80.326385, reg_best: 80.326385
step:  29, cost: 8.00E-03, attack: 0.994, loss: 0.735009, ce: 0.094043, reg: 80.120796, reg_best: 80.120796
up cost from 8.00E-03 to 1.60E-02
step:  30, cost: 1.60E-02, attack: 0.990, loss: 1.358297, ce: 0.164920, reg: 74.586029, reg_best: 80.120796
step:  31, cost: 1.60E-02, attack: 0.989, loss: 1.350326, ce: 0.167636, reg: 73.918106, reg_best: 80.120796
step:  32, cost: 1.60E-02, attack: 0.994, loss: 1.311983, ce: 0.097962, reg: 75.878441, reg_best: 75.878441
step:  33, cost: 1.60E-02, attack: 0.993, loss: 1.305858, ce: 0.131395, reg: 73.403923, reg_best: 73.403923
step:  34, cost: 1.60E-02, attack: 0.991, loss: 1.377733, ce: 0.150054, reg: 76.729958, reg_best: 73.403923
step:  35, cost: 1.60E-02, attack: 0.992, loss: 1.296100, ce: 0.136350, reg: 72.484390, reg_best: 72.484390
step:  36, cost: 1.60E-02, attack: 0.987, loss: 1.368617, ce: 0.232093, reg: 71.032745, reg_best: 72.484390
step:  37, cost: 1.60E-02, attack: 0.987, loss: 1.394937, ce: 0.210804, reg: 74.008316, reg_best: 72.484390
step:  38, cost: 1.60E-02, attack: 0.995, loss: 1.292235, ce: 0.086234, reg: 75.375046, reg_best: 72.484390
step:  39, cost: 1.60E-02, attack: 0.986, loss: 1.433014, ce: 0.230847, reg: 75.135399, reg_best: 72.484390
step:  40, cost: 1.60E-02, attack: 0.983, loss: 1.434005, ce: 0.291487, reg: 71.407410, reg_best: 72.484390
step:  41, cost: 1.60E-02, attack: 0.996, loss: 1.241526, ce: 0.080343, reg: 72.573898, reg_best: 72.484390
step:  42, cost: 1.60E-02, attack: 0.996, loss: 1.290297, ce: 0.102975, reg: 74.207603, reg_best: 72.484390
step:  43, cost: 1.60E-02, attack: 0.995, loss: 1.314334, ce: 0.089256, reg: 76.567329, reg_best: 72.484390
step:  44, cost: 1.60E-02, attack: 0.990, loss: 1.315296, ce: 0.161015, reg: 72.142555, reg_best: 72.484390
step:  45, cost: 1.60E-02, attack: 0.990, loss: 1.284575, ce: 0.154828, reg: 70.619522, reg_best: 72.484390
step:  46, cost: 1.60E-02, attack: 0.987, loss: 1.325588, ce: 0.222276, reg: 68.956993, reg_best: 72.484390
step:  47, cost: 1.60E-02, attack: 0.992, loss: 1.326393, ce: 0.145477, reg: 73.807259, reg_best: 72.484390
step:  48, cost: 1.60E-02, attack: 0.992, loss: 1.273639, ce: 0.136818, reg: 71.051270, reg_best: 71.051270
step:  49, cost: 1.60E-02, attack: 0.988, loss: 1.327355, ce: 0.188248, reg: 71.194221, reg_best: 71.051270
step:  50, cost: 1.60E-02, attack: 0.993, loss: 1.272648, ce: 0.128239, reg: 71.525566, reg_best: 71.051270
step:  51, cost: 1.60E-02, attack: 0.984, loss: 1.385528, ce: 0.238723, reg: 71.675323, reg_best: 71.051270
step:  52, cost: 1.60E-02, attack: 0.990, loss: 1.327700, ce: 0.179489, reg: 71.763191, reg_best: 71.051270
step:  53, cost: 1.60E-02, attack: 0.993, loss: 1.289212, ce: 0.123625, reg: 72.849136, reg_best: 71.051270
step:  54, cost: 1.60E-02, attack: 0.989, loss: 1.317375, ce: 0.184920, reg: 70.778458, reg_best: 71.051270
step:  55, cost: 1.60E-02, attack: 0.990, loss: 1.291101, ce: 0.155392, reg: 70.981804, reg_best: 71.051270
step:  56, cost: 1.60E-02, attack: 0.993, loss: 1.261416, ce: 0.108279, reg: 72.071037, reg_best: 71.051270
step:  57, cost: 1.60E-02, attack: 0.997, loss: 1.203104, ce: 0.082744, reg: 70.034348, reg_best: 70.034348
step:  58, cost: 1.60E-02, attack: 0.991, loss: 1.309364, ce: 0.164174, reg: 71.574371, reg_best: 70.034348
step:  59, cost: 1.60E-02, attack: 0.990, loss: 1.268210, ce: 0.174534, reg: 68.354736, reg_best: 70.034348
step:  60, cost: 1.60E-02, attack: 0.991, loss: 1.261324, ce: 0.160604, reg: 68.795013, reg_best: 68.795013
step:  61, cost: 1.60E-02, attack: 0.990, loss: 1.272239, ce: 0.161507, reg: 69.420799, reg_best: 68.795013
step:  62, cost: 1.60E-02, attack: 0.993, loss: 1.260168, ce: 0.135013, reg: 70.322166, reg_best: 68.795013
step:  63, cost: 1.60E-02, attack: 0.988, loss: 1.297027, ce: 0.199955, reg: 68.567055, reg_best: 68.795013
step:  64, cost: 1.60E-02, attack: 0.987, loss: 1.329952, ce: 0.227538, reg: 68.900833, reg_best: 68.795013
step:  65, cost: 1.60E-02, attack: 0.993, loss: 1.232294, ce: 0.121276, reg: 69.438622, reg_best: 68.795013
step:  66, cost: 1.60E-02, attack: 0.992, loss: 1.240700, ce: 0.151234, reg: 68.091637, reg_best: 68.091637
step:  67, cost: 1.60E-02, attack: 0.986, loss: 1.339652, ce: 0.219352, reg: 70.018715, reg_best: 68.091637
step:  68, cost: 1.60E-02, attack: 0.988, loss: 1.305378, ce: 0.211101, reg: 68.392303, reg_best: 68.091637
step:  69, cost: 1.60E-02, attack: 0.993, loss: 1.291665, ce: 0.126362, reg: 72.831436, reg_best: 68.091637
step:  70, cost: 1.60E-02, attack: 0.989, loss: 1.316738, ce: 0.196505, reg: 70.010361, reg_best: 68.091637
step:  71, cost: 1.60E-02, attack: 0.990, loss: 1.271083, ce: 0.162665, reg: 69.276138, reg_best: 68.091637
step:  72, cost: 1.60E-02, attack: 0.986, loss: 1.328156, ce: 0.238018, reg: 68.133644, reg_best: 68.091637
step:  73, cost: 1.60E-02, attack: 0.990, loss: 1.248628, ce: 0.146037, reg: 68.911957, reg_best: 68.091637
step:  74, cost: 1.60E-02, attack: 0.994, loss: 1.245981, ce: 0.113380, reg: 70.787575, reg_best: 68.091637
step:  75, cost: 1.60E-02, attack: 0.990, loss: 1.289750, ce: 0.167672, reg: 70.129822, reg_best: 68.091637
step:  76, cost: 1.60E-02, attack: 0.988, loss: 1.329935, ce: 0.207709, reg: 70.139091, reg_best: 68.091637
step:  77, cost: 1.60E-02, attack: 0.989, loss: 1.299865, ce: 0.184222, reg: 69.727669, reg_best: 68.091637
step:  78, cost: 1.60E-02, attack: 0.990, loss: 1.274914, ce: 0.173097, reg: 68.863541, reg_best: 68.091637
step:  79, cost: 1.60E-02, attack: 0.992, loss: 1.274249, ce: 0.154978, reg: 69.954414, reg_best: 68.091637
step:  80, cost: 1.60E-02, attack: 0.983, loss: 1.365000, ce: 0.271185, reg: 68.363434, reg_best: 68.091637
step:  81, cost: 1.60E-02, attack: 0.995, loss: 1.222644, ce: 0.072659, reg: 71.874016, reg_best: 68.091637
step:  82, cost: 1.60E-02, attack: 0.991, loss: 1.232985, ce: 0.154165, reg: 67.426231, reg_best: 67.426231
step:  83, cost: 1.60E-02, attack: 0.986, loss: 1.334659, ce: 0.224146, reg: 69.403122, reg_best: 67.426231
step:  84, cost: 1.60E-02, attack: 0.993, loss: 1.254626, ce: 0.114447, reg: 71.261192, reg_best: 67.426231
step:  85, cost: 1.60E-02, attack: 0.991, loss: 1.292013, ce: 0.142966, reg: 71.815407, reg_best: 67.426231
step:  86, cost: 1.60E-02, attack: 0.994, loss: 1.235756, ce: 0.106717, reg: 70.564911, reg_best: 67.426231
step:  87, cost: 1.60E-02, attack: 0.993, loss: 1.254211, ce: 0.110678, reg: 71.470818, reg_best: 67.426231
step:  88, cost: 1.60E-02, attack: 0.993, loss: 1.265721, ce: 0.133132, reg: 70.786850, reg_best: 67.426231
up cost from 1.60E-02 to 3.20E-02
step:  89, cost: 3.20E-02, attack: 0.984, loss: 2.406446, ce: 0.250727, reg: 67.366180, reg_best: 67.426231
step:  90, cost: 3.20E-02, attack: 0.983, loss: 2.421813, ce: 0.278859, reg: 66.967300, reg_best: 67.426231
step:  91, cost: 3.20E-02, attack: 0.987, loss: 2.301764, ce: 0.230962, reg: 64.712578, reg_best: 67.426231
step:  92, cost: 3.20E-02, attack: 0.976, loss: 2.464864, ce: 0.409787, reg: 64.221161, reg_best: 67.426231
step:  93, cost: 3.20E-02, attack: 0.988, loss: 2.416696, ce: 0.216732, reg: 68.748894, reg_best: 67.426231
down cost from 3.20E-02 to 1.13E-02
step:  94, cost: 1.13E-02, attack: 0.995, loss: 0.884184, ce: 0.095168, reg: 69.739769, reg_best: 67.426231
step:  95, cost: 1.13E-02, attack: 0.994, loss: 0.897242, ce: 0.110295, reg: 69.556870, reg_best: 67.426231
step:  96, cost: 1.13E-02, attack: 0.993, loss: 0.899629, ce: 0.107108, reg: 70.028893, reg_best: 67.426231
step:  97, cost: 1.13E-02, attack: 0.992, loss: 0.893167, ce: 0.110459, reg: 69.182213, reg_best: 67.426231
step:  98, cost: 1.13E-02, attack: 0.993, loss: 0.913550, ce: 0.118310, reg: 70.289894, reg_best: 67.426231
up cost from 1.13E-02 to 2.26E-02
step:  99, cost: 2.26E-02, attack: 0.992, loss: 1.710208, ce: 0.146239, reg: 69.118271, reg_best: 67.426231
pattern, shape: (32, 32, 3), min: 0.000015, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 29: 66.458481
visualization cost 20.200605 seconds
processing label 30
resetting state
mask_tanh -3.7521393777238097 3.5379585866344376
pattern_tanh -4.145644393844109 3.735777763769346
step:   0, cost: 0.00E+00, attack: 0.873, loss: 2.072118, ce: 2.072118, reg: 552.275085, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.006502, ce: 0.006502, reg: 569.818665, reg_best: 569.818665
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000137, ce: 0.000137, reg: 573.157654, reg_best: 569.818665
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 575.174377, reg_best: 569.818665
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 575.352966, reg_best: 569.818665
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 575.431458, reg_best: 569.818665
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.994, loss: 0.483069, ce: 0.091609, reg: 391.459229, reg_best: 391.459229
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.334839, ce: 0.018867, reg: 315.971283, reg_best: 315.971283
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.251981, ce: 0.002943, reg: 248.808258, reg_best: 248.808258
step:   9, cost: 1.00E-03, attack: 0.997, loss: 0.242343, ce: 0.046604, reg: 195.739136, reg_best: 195.739136
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.998, loss: 0.362850, ce: 0.028693, reg: 167.078583, reg_best: 167.078583
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.353026, ce: 0.026280, reg: 163.372635, reg_best: 163.372635
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.326825, ce: 0.028627, reg: 149.098969, reg_best: 149.098969
step:  13, cost: 2.00E-03, attack: 0.997, loss: 0.319889, ce: 0.052966, reg: 133.461426, reg_best: 133.461426
step:  14, cost: 2.00E-03, attack: 1.000, loss: 0.263455, ce: 0.009728, reg: 126.863571, reg_best: 126.863571
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.994, loss: 0.580585, ce: 0.101938, reg: 119.661751, reg_best: 119.661751
step:  16, cost: 4.00E-03, attack: 0.990, loss: 0.609773, ce: 0.169260, reg: 110.128098, reg_best: 119.661751
step:  17, cost: 4.00E-03, attack: 0.998, loss: 0.480944, ce: 0.046359, reg: 108.646225, reg_best: 108.646225
step:  18, cost: 4.00E-03, attack: 0.999, loss: 0.434172, ce: 0.018961, reg: 103.802895, reg_best: 103.802895
step:  19, cost: 4.00E-03, attack: 0.995, loss: 0.467512, ce: 0.077100, reg: 97.602783, reg_best: 97.602783
step:  20, cost: 4.00E-03, attack: 0.994, loss: 0.492553, ce: 0.109687, reg: 95.716522, reg_best: 95.716522
step:  21, cost: 4.00E-03, attack: 0.999, loss: 0.414552, ce: 0.019087, reg: 98.875320, reg_best: 95.716522
up cost from 4.00E-03 to 8.00E-03
step:  22, cost: 8.00E-03, attack: 0.990, loss: 0.866775, ce: 0.167001, reg: 87.471809, reg_best: 95.716522
step:  23, cost: 8.00E-03, attack: 0.996, loss: 0.779512, ce: 0.065621, reg: 89.236305, reg_best: 89.236305
step:  24, cost: 8.00E-03, attack: 0.998, loss: 0.723882, ce: 0.047483, reg: 84.549828, reg_best: 84.549828
step:  25, cost: 8.00E-03, attack: 0.995, loss: 0.768728, ce: 0.073535, reg: 86.899078, reg_best: 84.549828
step:  26, cost: 8.00E-03, attack: 0.993, loss: 0.805036, ce: 0.120450, reg: 85.573227, reg_best: 84.549828
step:  27, cost: 8.00E-03, attack: 0.994, loss: 0.768829, ce: 0.096692, reg: 84.017113, reg_best: 84.017113
up cost from 8.00E-03 to 1.60E-02
step:  28, cost: 1.60E-02, attack: 0.983, loss: 1.528555, ce: 0.274479, reg: 78.379776, reg_best: 84.017113
step:  29, cost: 1.60E-02, attack: 0.989, loss: 1.451568, ce: 0.194098, reg: 78.591858, reg_best: 84.017113
step:  30, cost: 1.60E-02, attack: 0.994, loss: 1.371255, ce: 0.112695, reg: 78.659988, reg_best: 78.659988
step:  31, cost: 1.60E-02, attack: 0.992, loss: 1.397660, ce: 0.146205, reg: 78.215927, reg_best: 78.215927
step:  32, cost: 1.60E-02, attack: 0.994, loss: 1.377892, ce: 0.100841, reg: 79.815666, reg_best: 78.215927
step:  33, cost: 1.60E-02, attack: 0.993, loss: 1.384537, ce: 0.112443, reg: 79.505859, reg_best: 78.215927
step:  34, cost: 1.60E-02, attack: 0.992, loss: 1.341739, ce: 0.136140, reg: 75.344696, reg_best: 75.344696
up cost from 1.60E-02 to 3.20E-02
step:  35, cost: 3.20E-02, attack: 0.991, loss: 2.502859, ce: 0.181354, reg: 72.547035, reg_best: 72.547035
step:  36, cost: 3.20E-02, attack: 0.989, loss: 2.490589, ce: 0.220756, reg: 70.932281, reg_best: 72.547035
step:  37, cost: 3.20E-02, attack: 0.989, loss: 2.509456, ce: 0.246687, reg: 70.711533, reg_best: 72.547035
step:  38, cost: 3.20E-02, attack: 0.981, loss: 2.574225, ce: 0.340421, reg: 69.806374, reg_best: 72.547035
step:  39, cost: 3.20E-02, attack: 0.981, loss: 2.557958, ce: 0.322171, reg: 69.868332, reg_best: 72.547035
step:  40, cost: 3.20E-02, attack: 0.986, loss: 2.474702, ce: 0.235404, reg: 69.978050, reg_best: 72.547035
down cost from 3.20E-02 to 1.13E-02
step:  41, cost: 1.13E-02, attack: 0.983, loss: 1.070754, ce: 0.305174, reg: 67.668358, reg_best: 72.547035
step:  42, cost: 1.13E-02, attack: 0.993, loss: 0.949673, ce: 0.140427, reg: 71.527916, reg_best: 71.527916
step:  43, cost: 1.13E-02, attack: 0.992, loss: 0.941197, ce: 0.133094, reg: 71.426895, reg_best: 71.426895
step:  44, cost: 1.13E-02, attack: 0.994, loss: 0.932089, ce: 0.105182, reg: 73.088974, reg_best: 71.426895
step:  45, cost: 1.13E-02, attack: 0.995, loss: 0.918319, ce: 0.085450, reg: 73.615952, reg_best: 71.426895
step:  46, cost: 1.13E-02, attack: 0.990, loss: 0.983436, ce: 0.163437, reg: 72.478340, reg_best: 71.426895
step:  47, cost: 1.13E-02, attack: 0.985, loss: 1.060589, ce: 0.242736, reg: 72.272636, reg_best: 71.426895
step:  48, cost: 1.13E-02, attack: 0.986, loss: 1.034737, ce: 0.223954, reg: 71.663750, reg_best: 71.426895
step:  49, cost: 1.13E-02, attack: 0.990, loss: 0.996058, ce: 0.170897, reg: 72.934601, reg_best: 71.426895
step:  50, cost: 1.13E-02, attack: 0.997, loss: 0.917144, ce: 0.052875, reg: 76.391327, reg_best: 71.426895
step:  51, cost: 1.13E-02, attack: 0.993, loss: 0.952796, ce: 0.135201, reg: 72.265930, reg_best: 71.426895
step:  52, cost: 1.13E-02, attack: 0.991, loss: 0.979798, ce: 0.148312, reg: 73.493713, reg_best: 71.426895
step:  53, cost: 1.13E-02, attack: 0.993, loss: 0.951757, ce: 0.113279, reg: 74.111679, reg_best: 71.426895
step:  54, cost: 1.13E-02, attack: 0.992, loss: 0.960098, ce: 0.124126, reg: 73.890190, reg_best: 71.426895
up cost from 1.13E-02 to 2.26E-02
step:  55, cost: 2.26E-02, attack: 0.982, loss: 1.850050, ce: 0.296480, reg: 68.658737, reg_best: 71.426895
step:  56, cost: 2.26E-02, attack: 0.985, loss: 1.810336, ce: 0.258514, reg: 68.581497, reg_best: 71.426895
step:  57, cost: 2.26E-02, attack: 0.991, loss: 1.720689, ce: 0.156987, reg: 69.106522, reg_best: 69.106522
step:  58, cost: 2.26E-02, attack: 0.992, loss: 1.751680, ce: 0.148873, reg: 70.834740, reg_best: 69.106522
step:  59, cost: 2.26E-02, attack: 0.991, loss: 1.749247, ce: 0.154373, reg: 70.444916, reg_best: 69.106522
step:  60, cost: 2.26E-02, attack: 0.985, loss: 1.799910, ce: 0.261586, reg: 67.984955, reg_best: 69.106522
step:  61, cost: 2.26E-02, attack: 0.992, loss: 1.760405, ce: 0.139981, reg: 71.613289, reg_best: 69.106522
step:  62, cost: 2.26E-02, attack: 0.992, loss: 1.738303, ce: 0.138080, reg: 70.720558, reg_best: 69.106522
step:  63, cost: 2.26E-02, attack: 0.994, loss: 1.683384, ce: 0.111153, reg: 69.483437, reg_best: 69.106522
step:  64, cost: 2.26E-02, attack: 0.987, loss: 1.801393, ce: 0.225087, reg: 69.663551, reg_best: 69.106522
step:  65, cost: 2.26E-02, attack: 0.990, loss: 1.754327, ce: 0.181048, reg: 69.529770, reg_best: 69.106522
step:  66, cost: 2.26E-02, attack: 0.983, loss: 1.834012, ce: 0.276487, reg: 68.833511, reg_best: 69.106522
step:  67, cost: 2.26E-02, attack: 0.981, loss: 1.853669, ce: 0.328341, reg: 67.410606, reg_best: 69.106522
step:  68, cost: 2.26E-02, attack: 0.988, loss: 1.782081, ce: 0.197225, reg: 70.041420, reg_best: 69.106522
down cost from 2.26E-02 to 8.00E-03
step:  69, cost: 8.00E-03, attack: 0.995, loss: 0.661378, ce: 0.082404, reg: 72.371803, reg_best: 69.106522
step:  70, cost: 8.00E-03, attack: 0.996, loss: 0.648092, ce: 0.089987, reg: 69.763115, reg_best: 69.106522
step:  71, cost: 8.00E-03, attack: 0.990, loss: 0.750836, ce: 0.175572, reg: 71.908012, reg_best: 69.106522
step:  72, cost: 8.00E-03, attack: 0.996, loss: 0.675367, ce: 0.087864, reg: 73.439613, reg_best: 69.106522
step:  73, cost: 8.00E-03, attack: 0.997, loss: 0.686783, ce: 0.067439, reg: 77.418076, reg_best: 69.106522
step:  74, cost: 8.00E-03, attack: 0.998, loss: 0.663921, ce: 0.039351, reg: 78.071320, reg_best: 69.106522
step:  75, cost: 8.00E-03, attack: 0.996, loss: 0.667180, ce: 0.074027, reg: 74.144119, reg_best: 69.106522
step:  76, cost: 8.00E-03, attack: 0.987, loss: 0.783291, ce: 0.206608, reg: 72.085266, reg_best: 69.106522
step:  77, cost: 8.00E-03, attack: 0.995, loss: 0.689178, ce: 0.084229, reg: 75.618561, reg_best: 69.106522
step:  78, cost: 8.00E-03, attack: 0.989, loss: 0.726820, ce: 0.175875, reg: 68.868088, reg_best: 69.106522
step:  79, cost: 8.00E-03, attack: 0.991, loss: 0.747536, ce: 0.151245, reg: 74.536346, reg_best: 69.106522
step:  80, cost: 8.00E-03, attack: 0.995, loss: 0.669967, ce: 0.083955, reg: 73.251503, reg_best: 69.106522
step:  81, cost: 8.00E-03, attack: 0.994, loss: 0.679202, ce: 0.093220, reg: 73.247726, reg_best: 69.106522
step:  82, cost: 8.00E-03, attack: 0.993, loss: 0.692783, ce: 0.116829, reg: 71.994286, reg_best: 69.106522
early stop
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 30: 69.796669
visualization cost 16.817638 seconds
processing label 31
resetting state
mask_tanh -3.02909541922957 3.205205276902475
pattern_tanh -4.592034970841782 4.508321221969126
step:   0, cost: 0.00E+00, attack: 0.827, loss: 2.867985, ce: 2.867985, reg: 541.394165, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.001045, ce: 0.001045, reg: 565.727600, reg_best: 565.727600
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000118, ce: 0.000118, reg: 567.677490, reg_best: 565.727600
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000156, ce: 0.000156, reg: 570.876526, reg_best: 565.727600
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000003, ce: 0.000003, reg: 575.262146, reg_best: 565.727600
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 578.211670, reg_best: 565.727600
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.995, loss: 0.418595, ce: 0.085165, reg: 333.429901, reg_best: 333.429901
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.251908, ce: 0.006144, reg: 245.763977, reg_best: 245.763977
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.223133, ce: 0.019236, reg: 203.897278, reg_best: 203.897278
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.186646, ce: 0.010838, reg: 175.807922, reg_best: 175.807922
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.331980, ce: 0.022148, reg: 154.915649, reg_best: 154.915649
step:  11, cost: 2.00E-03, attack: 1.000, loss: 0.274792, ce: 0.012488, reg: 131.152344, reg_best: 131.152344
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.260799, ce: 0.018763, reg: 121.017838, reg_best: 121.017838
step:  13, cost: 2.00E-03, attack: 0.997, loss: 0.280542, ce: 0.051258, reg: 114.642036, reg_best: 114.642036
step:  14, cost: 2.00E-03, attack: 0.997, loss: 0.261948, ce: 0.056196, reg: 102.875648, reg_best: 102.875648
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.990, loss: 0.540784, ce: 0.155220, reg: 96.318275, reg_best: 102.875648
step:  16, cost: 4.00E-03, attack: 0.996, loss: 0.439936, ce: 0.063567, reg: 94.092102, reg_best: 94.092102
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.395081, ce: 0.024445, reg: 92.659050, reg_best: 92.659050
step:  18, cost: 4.00E-03, attack: 0.996, loss: 0.429492, ce: 0.067363, reg: 90.532219, reg_best: 90.532219
step:  19, cost: 4.00E-03, attack: 1.000, loss: 0.375028, ce: 0.003769, reg: 92.814560, reg_best: 90.532219
step:  20, cost: 4.00E-03, attack: 0.997, loss: 0.393819, ce: 0.051154, reg: 85.666107, reg_best: 85.666107
up cost from 4.00E-03 to 8.00E-03
step:  21, cost: 8.00E-03, attack: 0.997, loss: 0.758219, ce: 0.053878, reg: 88.042595, reg_best: 85.666107
step:  22, cost: 8.00E-03, attack: 1.000, loss: 0.685719, ce: 0.018637, reg: 83.385201, reg_best: 83.385201
step:  23, cost: 8.00E-03, attack: 0.997, loss: 0.711244, ce: 0.067023, reg: 80.527588, reg_best: 80.527588
step:  24, cost: 8.00E-03, attack: 0.994, loss: 0.745965, ce: 0.100945, reg: 80.627464, reg_best: 80.527588
step:  25, cost: 8.00E-03, attack: 0.998, loss: 0.679331, ce: 0.028217, reg: 81.389305, reg_best: 80.527588
up cost from 8.00E-03 to 1.60E-02
step:  26, cost: 1.60E-02, attack: 0.994, loss: 1.312114, ce: 0.116555, reg: 74.722466, reg_best: 74.722466
step:  27, cost: 1.60E-02, attack: 0.992, loss: 1.335580, ce: 0.116992, reg: 76.129234, reg_best: 74.722466
step:  28, cost: 1.60E-02, attack: 0.997, loss: 1.246439, ce: 0.073484, reg: 73.309723, reg_best: 73.309723
step:  29, cost: 1.60E-02, attack: 0.993, loss: 1.277931, ce: 0.111268, reg: 72.916428, reg_best: 72.916428
step:  30, cost: 1.60E-02, attack: 0.990, loss: 1.311294, ce: 0.147733, reg: 72.722595, reg_best: 72.916428
step:  31, cost: 1.60E-02, attack: 0.988, loss: 1.320466, ce: 0.178157, reg: 71.394279, reg_best: 72.916428
step:  32, cost: 1.60E-02, attack: 0.995, loss: 1.262346, ce: 0.097859, reg: 72.780434, reg_best: 72.780434
step:  33, cost: 1.60E-02, attack: 0.989, loss: 1.312347, ce: 0.173594, reg: 71.172066, reg_best: 72.780434
step:  34, cost: 1.60E-02, attack: 0.996, loss: 1.256680, ce: 0.078508, reg: 73.635712, reg_best: 72.780434
step:  35, cost: 1.60E-02, attack: 0.993, loss: 1.263425, ce: 0.125476, reg: 71.121811, reg_best: 71.121811
step:  36, cost: 1.60E-02, attack: 0.993, loss: 1.267674, ce: 0.126884, reg: 71.299332, reg_best: 71.121811
step:  37, cost: 1.60E-02, attack: 0.992, loss: 1.246884, ce: 0.119334, reg: 70.471840, reg_best: 70.471840
step:  38, cost: 1.60E-02, attack: 0.986, loss: 1.334890, ce: 0.209322, reg: 70.347961, reg_best: 70.471840
step:  39, cost: 1.60E-02, attack: 0.990, loss: 1.293787, ce: 0.151747, reg: 71.377480, reg_best: 70.471840
step:  40, cost: 1.60E-02, attack: 0.997, loss: 1.244765, ce: 0.058836, reg: 74.131363, reg_best: 70.471840
step:  41, cost: 1.60E-02, attack: 0.993, loss: 1.266696, ce: 0.109323, reg: 72.335854, reg_best: 70.471840
step:  42, cost: 1.60E-02, attack: 0.990, loss: 1.334644, ce: 0.174086, reg: 72.534904, reg_best: 70.471840
step:  43, cost: 1.60E-02, attack: 0.997, loss: 1.237842, ce: 0.044453, reg: 74.586761, reg_best: 70.471840
step:  44, cost: 1.60E-02, attack: 0.989, loss: 1.234884, ce: 0.171568, reg: 66.457275, reg_best: 70.471840
step:  45, cost: 1.60E-02, attack: 0.993, loss: 1.221266, ce: 0.119339, reg: 68.870430, reg_best: 68.870430
step:  46, cost: 1.60E-02, attack: 0.985, loss: 1.326587, ce: 0.269155, reg: 66.089539, reg_best: 68.870430
step:  47, cost: 1.60E-02, attack: 0.991, loss: 1.219501, ce: 0.140489, reg: 67.438271, reg_best: 67.438271
step:  48, cost: 1.60E-02, attack: 0.992, loss: 1.235623, ce: 0.159994, reg: 67.226852, reg_best: 67.226852
step:  49, cost: 1.60E-02, attack: 0.992, loss: 1.220804, ce: 0.135489, reg: 67.832199, reg_best: 67.226852
step:  50, cost: 1.60E-02, attack: 0.992, loss: 1.290171, ce: 0.126904, reg: 72.704193, reg_best: 67.226852
step:  51, cost: 1.60E-02, attack: 0.992, loss: 1.241488, ce: 0.134496, reg: 69.187012, reg_best: 67.226852
up cost from 1.60E-02 to 3.20E-02
step:  52, cost: 3.20E-02, attack: 0.987, loss: 2.357169, ce: 0.236173, reg: 66.281120, reg_best: 67.226852
step:  53, cost: 3.20E-02, attack: 0.988, loss: 2.411478, ce: 0.231802, reg: 68.108315, reg_best: 67.226852
step:  54, cost: 3.20E-02, attack: 0.980, loss: 2.414819, ce: 0.349909, reg: 64.528412, reg_best: 67.226852
step:  55, cost: 3.20E-02, attack: 0.987, loss: 2.357819, ce: 0.206900, reg: 67.216232, reg_best: 67.226852
step:  56, cost: 3.20E-02, attack: 0.991, loss: 2.272600, ce: 0.147269, reg: 66.416603, reg_best: 66.416603
step:  57, cost: 3.20E-02, attack: 0.983, loss: 2.383220, ce: 0.277102, reg: 65.816200, reg_best: 66.416603
step:  58, cost: 3.20E-02, attack: 0.976, loss: 2.453892, ce: 0.395452, reg: 64.326256, reg_best: 66.416603
step:  59, cost: 3.20E-02, attack: 0.978, loss: 2.439217, ce: 0.364087, reg: 64.847801, reg_best: 66.416603
step:  60, cost: 3.20E-02, attack: 0.983, loss: 2.369117, ce: 0.295305, reg: 64.806602, reg_best: 66.416603
step:  61, cost: 3.20E-02, attack: 0.980, loss: 2.329470, ce: 0.327234, reg: 62.569866, reg_best: 66.416603
down cost from 3.20E-02 to 1.13E-02
step:  62, cost: 1.13E-02, attack: 0.992, loss: 0.903762, ce: 0.129785, reg: 68.410545, reg_best: 66.416603
step:  63, cost: 1.13E-02, attack: 0.994, loss: 0.877747, ce: 0.096102, reg: 69.088287, reg_best: 66.416603
step:  64, cost: 1.13E-02, attack: 0.989, loss: 0.949905, ce: 0.179268, reg: 68.115318, reg_best: 66.416603
step:  65, cost: 1.13E-02, attack: 0.992, loss: 0.938376, ce: 0.122706, reg: 72.095726, reg_best: 66.416603
step:  66, cost: 1.13E-02, attack: 0.990, loss: 0.959433, ce: 0.173801, reg: 69.453575, reg_best: 66.416603
step:  67, cost: 1.13E-02, attack: 0.991, loss: 0.927509, ce: 0.142166, reg: 69.415100, reg_best: 66.416603
step:  68, cost: 1.13E-02, attack: 0.995, loss: 0.876417, ce: 0.086055, reg: 69.858795, reg_best: 66.416603
step:  69, cost: 1.13E-02, attack: 0.994, loss: 0.912173, ce: 0.113149, reg: 70.624336, reg_best: 66.416603
step:  70, cost: 1.13E-02, attack: 0.992, loss: 0.943056, ce: 0.147770, reg: 70.293953, reg_best: 66.416603
step:  71, cost: 1.13E-02, attack: 0.993, loss: 0.918263, ce: 0.114433, reg: 71.049240, reg_best: 66.416603
up cost from 1.13E-02 to 2.26E-02
step:  72, cost: 2.26E-02, attack: 0.991, loss: 1.682228, ce: 0.154332, reg: 67.524117, reg_best: 66.416603
step:  73, cost: 2.26E-02, attack: 0.994, loss: 1.700340, ce: 0.113277, reg: 70.138954, reg_best: 66.416603
step:  74, cost: 2.26E-02, attack: 0.989, loss: 1.726696, ce: 0.176955, reg: 68.489555, reg_best: 66.416603
step:  75, cost: 2.26E-02, attack: 0.989, loss: 1.746115, ce: 0.190823, reg: 68.734840, reg_best: 66.416603
step:  76, cost: 2.26E-02, attack: 0.993, loss: 1.697351, ce: 0.116784, reg: 69.851845, reg_best: 66.416603
step:  77, cost: 2.26E-02, attack: 0.994, loss: 1.665897, ce: 0.099797, reg: 69.212463, reg_best: 66.416603
step:  78, cost: 2.26E-02, attack: 0.988, loss: 1.735396, ce: 0.215166, reg: 67.203621, reg_best: 66.416603
step:  79, cost: 2.26E-02, attack: 0.989, loss: 1.690135, ce: 0.191478, reg: 66.231911, reg_best: 66.416603
step:  80, cost: 2.26E-02, attack: 0.992, loss: 1.718589, ce: 0.138102, reg: 69.848328, reg_best: 66.416603
step:  81, cost: 2.26E-02, attack: 0.992, loss: 1.697089, ce: 0.139976, reg: 68.815315, reg_best: 66.416603
early stop
pattern, shape: (32, 32, 3), min: 0.000008, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 31: 66.026947
visualization cost 16.647467 seconds
processing label 32
resetting state
mask_tanh -6.426593692467038 3.451890250633589
pattern_tanh -3.841451283318903 4.911355865694213
step:   0, cost: 0.00E+00, attack: 0.836, loss: 2.735916, ce: 2.735916, reg: 553.023315, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000137, ce: 0.000137, reg: 573.382996, reg_best: 573.382996
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000064, ce: 0.000064, reg: 576.084290, reg_best: 573.382996
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 576.884338, reg_best: 573.382996
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 577.377869, reg_best: 573.382996
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 583.900757, reg_best: 573.382996
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.999, loss: 0.458753, ce: 0.029701, reg: 429.052582, reg_best: 429.052582
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.366109, ce: 0.036060, reg: 330.049133, reg_best: 330.049133
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.290504, ce: 0.009363, reg: 281.141205, reg_best: 281.141205
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.281779, ce: 0.031950, reg: 249.886856, reg_best: 249.886856
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.996, loss: 0.463798, ce: 0.055937, reg: 203.930237, reg_best: 203.930237
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.394794, ce: 0.019487, reg: 187.653717, reg_best: 187.653717
step:  12, cost: 2.00E-03, attack: 0.995, loss: 0.403216, ce: 0.079391, reg: 161.912262, reg_best: 161.912262
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.343529, ce: 0.030604, reg: 156.462296, reg_best: 156.462296
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.328159, ce: 0.021522, reg: 153.318634, reg_best: 153.318634
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.998, loss: 0.581624, ce: 0.045541, reg: 134.020737, reg_best: 134.020737
step:  16, cost: 4.00E-03, attack: 0.994, loss: 0.623297, ce: 0.103823, reg: 129.868683, reg_best: 129.868683
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.533928, ce: 0.025890, reg: 127.009514, reg_best: 127.009514
step:  18, cost: 4.00E-03, attack: 0.996, loss: 0.568052, ce: 0.083762, reg: 121.072357, reg_best: 121.072357
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.497445, ce: 0.017809, reg: 119.909203, reg_best: 119.909203
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.987, loss: 1.087705, ce: 0.217339, reg: 108.795700, reg_best: 119.909203
step:  21, cost: 8.00E-03, attack: 0.997, loss: 0.938041, ce: 0.061341, reg: 109.587479, reg_best: 109.587479
step:  22, cost: 8.00E-03, attack: 0.993, loss: 0.949578, ce: 0.103550, reg: 105.789642, reg_best: 105.789642
step:  23, cost: 8.00E-03, attack: 0.993, loss: 0.995282, ce: 0.132330, reg: 107.868950, reg_best: 105.789642
step:  24, cost: 8.00E-03, attack: 0.996, loss: 0.905905, ce: 0.071186, reg: 104.339821, reg_best: 104.339821
step:  25, cost: 8.00E-03, attack: 0.998, loss: 0.888078, ce: 0.049915, reg: 104.770370, reg_best: 104.339821
up cost from 8.00E-03 to 1.60E-02
step:  26, cost: 1.60E-02, attack: 0.989, loss: 1.749078, ce: 0.180050, reg: 98.064247, reg_best: 104.339821
step:  27, cost: 1.60E-02, attack: 0.985, loss: 1.763040, ce: 0.249006, reg: 94.627113, reg_best: 104.339821
step:  28, cost: 1.60E-02, attack: 0.993, loss: 1.699936, ce: 0.102478, reg: 99.841087, reg_best: 99.841087
step:  29, cost: 1.60E-02, attack: 0.993, loss: 1.663912, ce: 0.122924, reg: 96.311714, reg_best: 96.311714
step:  30, cost: 1.60E-02, attack: 0.993, loss: 1.612739, ce: 0.131028, reg: 92.606964, reg_best: 92.606964
step:  31, cost: 1.60E-02, attack: 0.994, loss: 1.594190, ce: 0.097724, reg: 93.529083, reg_best: 92.606964
step:  32, cost: 1.60E-02, attack: 0.993, loss: 1.588167, ce: 0.124118, reg: 91.503075, reg_best: 91.503075
up cost from 1.60E-02 to 3.20E-02
step:  33, cost: 3.20E-02, attack: 0.986, loss: 3.021480, ce: 0.263636, reg: 86.182610, reg_best: 91.503075
step:  34, cost: 3.20E-02, attack: 0.989, loss: 3.051466, ce: 0.195729, reg: 89.241737, reg_best: 91.503075
step:  35, cost: 3.20E-02, attack: 0.990, loss: 2.968972, ce: 0.183018, reg: 87.067001, reg_best: 91.503075
step:  36, cost: 3.20E-02, attack: 0.986, loss: 3.030433, ce: 0.253324, reg: 86.784630, reg_best: 91.503075
step:  37, cost: 3.20E-02, attack: 0.989, loss: 3.022178, ce: 0.196045, reg: 88.316635, reg_best: 91.503075
down cost from 3.20E-02 to 1.13E-02
step:  38, cost: 1.13E-02, attack: 0.990, loss: 1.194375, ce: 0.187693, reg: 88.978958, reg_best: 91.503075
step:  39, cost: 1.13E-02, attack: 0.995, loss: 1.128181, ce: 0.087369, reg: 91.995689, reg_best: 91.503075
step:  40, cost: 1.13E-02, attack: 0.998, loss: 1.095178, ce: 0.061315, reg: 91.381447, reg_best: 91.381447
step:  41, cost: 1.13E-02, attack: 0.993, loss: 1.128021, ce: 0.106574, reg: 90.284027, reg_best: 90.284027
step:  42, cost: 1.13E-02, attack: 0.995, loss: 1.128160, ce: 0.098744, reg: 90.988342, reg_best: 90.284027
step:  43, cost: 1.13E-02, attack: 0.994, loss: 1.109202, ce: 0.083880, reg: 90.626503, reg_best: 90.284027
up cost from 1.13E-02 to 2.26E-02
step:  44, cost: 2.26E-02, attack: 0.996, loss: 2.126132, ce: 0.094360, reg: 89.792488, reg_best: 89.792488
step:  45, cost: 2.26E-02, attack: 0.986, loss: 2.138426, ce: 0.226417, reg: 84.499641, reg_best: 89.792488
step:  46, cost: 2.26E-02, attack: 0.989, loss: 2.135786, ce: 0.180485, reg: 86.412933, reg_best: 89.792488
step:  47, cost: 2.26E-02, attack: 0.992, loss: 2.142051, ce: 0.100492, reg: 90.236656, reg_best: 89.792488
step:  48, cost: 2.26E-02, attack: 0.993, loss: 2.105163, ce: 0.120871, reg: 87.694122, reg_best: 87.694122
step:  49, cost: 2.26E-02, attack: 0.990, loss: 2.148237, ce: 0.191136, reg: 86.492462, reg_best: 87.694122
step:  50, cost: 2.26E-02, attack: 0.994, loss: 2.110383, ce: 0.132750, reg: 87.399818, reg_best: 87.399818
step:  51, cost: 2.26E-02, attack: 0.992, loss: 2.055628, ce: 0.120932, reg: 85.502281, reg_best: 85.502281
step:  52, cost: 2.26E-02, attack: 0.989, loss: 2.137562, ce: 0.192413, reg: 85.964256, reg_best: 85.502281
step:  53, cost: 2.26E-02, attack: 0.989, loss: 2.111202, ce: 0.163790, reg: 86.064240, reg_best: 85.502281
step:  54, cost: 2.26E-02, attack: 0.994, loss: 2.101923, ce: 0.099845, reg: 88.480171, reg_best: 85.502281
step:  55, cost: 2.26E-02, attack: 0.991, loss: 2.120344, ce: 0.150039, reg: 87.075981, reg_best: 85.502281
step:  56, cost: 2.26E-02, attack: 0.985, loss: 2.220486, ce: 0.239469, reg: 87.549408, reg_best: 85.502281
step:  57, cost: 2.26E-02, attack: 0.991, loss: 2.149567, ce: 0.154002, reg: 88.192360, reg_best: 85.502281
step:  58, cost: 2.26E-02, attack: 0.989, loss: 2.105005, ce: 0.171597, reg: 85.445366, reg_best: 85.502281
step:  59, cost: 2.26E-02, attack: 0.990, loss: 2.048761, ce: 0.156832, reg: 83.612228, reg_best: 85.502281
step:  60, cost: 2.26E-02, attack: 0.992, loss: 2.074862, ce: 0.117348, reg: 86.504128, reg_best: 85.502281
step:  61, cost: 2.26E-02, attack: 0.993, loss: 2.084831, ce: 0.140603, reg: 85.923569, reg_best: 85.502281
step:  62, cost: 2.26E-02, attack: 0.989, loss: 2.151429, ce: 0.170676, reg: 87.537766, reg_best: 85.502281
step:  63, cost: 2.26E-02, attack: 0.989, loss: 2.061023, ce: 0.183044, reg: 82.995743, reg_best: 85.502281
step:  64, cost: 2.26E-02, attack: 0.987, loss: 2.159735, ce: 0.252421, reg: 84.292175, reg_best: 85.502281
step:  65, cost: 2.26E-02, attack: 0.990, loss: 2.089786, ce: 0.172965, reg: 84.712349, reg_best: 85.502281
step:  66, cost: 2.26E-02, attack: 0.985, loss: 2.129728, ce: 0.251072, reg: 83.025604, reg_best: 85.502281
down cost from 2.26E-02 to 8.00E-03
step:  67, cost: 8.00E-03, attack: 0.995, loss: 0.770690, ce: 0.086046, reg: 85.580437, reg_best: 85.502281
step:  68, cost: 8.00E-03, attack: 0.997, loss: 0.776244, ce: 0.071106, reg: 88.142296, reg_best: 85.502281
step:  69, cost: 8.00E-03, attack: 0.994, loss: 0.820566, ce: 0.105361, reg: 89.400620, reg_best: 85.502281
step:  70, cost: 8.00E-03, attack: 0.997, loss: 0.769575, ce: 0.059667, reg: 88.738464, reg_best: 85.502281
step:  71, cost: 8.00E-03, attack: 0.992, loss: 0.840798, ce: 0.137332, reg: 87.933281, reg_best: 85.502281
up cost from 8.00E-03 to 1.60E-02
step:  72, cost: 1.60E-02, attack: 0.995, loss: 1.510547, ce: 0.096426, reg: 88.382545, reg_best: 85.502281
step:  73, cost: 1.60E-02, attack: 0.992, loss: 1.476936, ce: 0.134601, reg: 83.917526, reg_best: 83.917526
step:  74, cost: 1.60E-02, attack: 0.990, loss: 1.520441, ce: 0.164393, reg: 84.752960, reg_best: 83.917526
step:  75, cost: 1.60E-02, attack: 0.990, loss: 1.544371, ce: 0.145215, reg: 87.447281, reg_best: 83.917526
step:  76, cost: 1.60E-02, attack: 0.998, loss: 1.470428, ce: 0.059150, reg: 88.204872, reg_best: 83.917526
step:  77, cost: 1.60E-02, attack: 0.994, loss: 1.482857, ce: 0.114641, reg: 85.513466, reg_best: 83.917526
step:  78, cost: 1.60E-02, attack: 0.994, loss: 1.497757, ce: 0.105200, reg: 87.034775, reg_best: 83.917526
step:  79, cost: 1.60E-02, attack: 0.988, loss: 1.553207, ce: 0.192777, reg: 85.026871, reg_best: 83.917526
step:  80, cost: 1.60E-02, attack: 0.997, loss: 1.448194, ce: 0.055773, reg: 87.026344, reg_best: 83.917526
step:  81, cost: 1.60E-02, attack: 0.991, loss: 1.532051, ce: 0.149807, reg: 86.390251, reg_best: 83.917526
step:  82, cost: 1.60E-02, attack: 0.996, loss: 1.451712, ce: 0.091805, reg: 84.994225, reg_best: 83.917526
step:  83, cost: 1.60E-02, attack: 0.990, loss: 1.569663, ce: 0.170578, reg: 87.442818, reg_best: 83.917526
step:  84, cost: 1.60E-02, attack: 0.988, loss: 1.559470, ce: 0.172567, reg: 86.681412, reg_best: 83.917526
step:  85, cost: 1.60E-02, attack: 0.993, loss: 1.529296, ce: 0.137224, reg: 87.011398, reg_best: 83.917526
step:  86, cost: 1.60E-02, attack: 0.990, loss: 1.537186, ce: 0.165590, reg: 85.724754, reg_best: 83.917526
step:  87, cost: 1.60E-02, attack: 0.994, loss: 1.487274, ce: 0.117140, reg: 85.633408, reg_best: 83.917526
step:  88, cost: 1.60E-02, attack: 0.992, loss: 1.523131, ce: 0.147966, reg: 85.947792, reg_best: 83.917526
step:  89, cost: 1.60E-02, attack: 0.993, loss: 1.536468, ce: 0.122651, reg: 88.363571, reg_best: 83.917526
step:  90, cost: 1.60E-02, attack: 0.995, loss: 1.502526, ce: 0.113773, reg: 86.797050, reg_best: 83.917526
step:  91, cost: 1.60E-02, attack: 0.994, loss: 1.505365, ce: 0.112401, reg: 87.060219, reg_best: 83.917526
up cost from 1.60E-02 to 3.20E-02
step:  92, cost: 3.20E-02, attack: 0.993, loss: 2.897583, ce: 0.135244, reg: 86.323090, reg_best: 83.917526
step:  93, cost: 3.20E-02, attack: 0.984, loss: 2.914836, ce: 0.265075, reg: 82.805000, reg_best: 83.917526
step:  94, cost: 3.20E-02, attack: 0.992, loss: 2.899121, ce: 0.150217, reg: 85.903229, reg_best: 83.917526
step:  95, cost: 3.20E-02, attack: 0.988, loss: 2.809116, ce: 0.227225, reg: 80.684090, reg_best: 83.917526
step:  96, cost: 3.20E-02, attack: 0.990, loss: 2.918833, ce: 0.168078, reg: 85.961121, reg_best: 83.917526
step:  97, cost: 3.20E-02, attack: 0.984, loss: 2.858561, ce: 0.241712, reg: 81.776520, reg_best: 83.917526
step:  98, cost: 3.20E-02, attack: 0.992, loss: 2.831453, ce: 0.201419, reg: 82.192291, reg_best: 82.192291
step:  99, cost: 3.20E-02, attack: 0.991, loss: 2.817377, ce: 0.161854, reg: 82.985077, reg_best: 82.192291
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 32: 85.447266
visualization cost 20.129052 seconds
processing label 33
resetting state
mask_tanh -3.3936247663000816 3.161067350290505
pattern_tanh -4.7773884609817285 4.215559062972379
step:   0, cost: 0.00E+00, attack: 0.905, loss: 1.618190, ce: 1.618190, reg: 520.919617, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 528.889221, reg_best: 528.889221
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 528.892212, reg_best: 528.889221
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 528.892212, reg_best: 528.889221
step:   4, cost: 0.00E+00, attack: 0.999, loss: 0.016248, ce: 0.016248, reg: 529.064392, reg_best: 528.889221
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 530.254456, reg_best: 528.889221
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.992, loss: 0.422059, ce: 0.131336, reg: 290.723694, reg_best: 290.723694
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.156787, ce: 0.000369, reg: 156.417908, reg_best: 156.417908
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.101030, ce: 0.016374, reg: 84.655579, reg_best: 84.655579
step:   9, cost: 1.00E-03, attack: 1.000, loss: 0.066044, ce: 0.014529, reg: 51.515018, reg_best: 51.515018
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 1.000, loss: 0.099185, ce: 0.000000, reg: 49.592239, reg_best: 49.592239
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.091761, ce: 0.016206, reg: 37.781124, reg_best: 37.781124
step:  12, cost: 2.00E-03, attack: 1.000, loss: 0.065190, ce: 0.001227, reg: 31.981575, reg_best: 31.981575
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.066879, ce: 0.016673, reg: 25.102915, reg_best: 25.102915
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.068053, ce: 0.023652, reg: 22.200600, reg_best: 22.200600
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 1.000, loss: 0.080261, ce: 0.000500, reg: 19.940220, reg_best: 19.940220
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.100682, ce: 0.026080, reg: 18.650436, reg_best: 18.650436
step:  17, cost: 4.00E-03, attack: 1.000, loss: 0.079177, ce: 0.005096, reg: 18.520166, reg_best: 18.520166
step:  18, cost: 4.00E-03, attack: 0.999, loss: 0.100637, ce: 0.022644, reg: 19.498198, reg_best: 18.520166
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.092674, ce: 0.013241, reg: 19.858419, reg_best: 18.520166
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.988, loss: 0.327262, ce: 0.195948, reg: 16.414223, reg_best: 18.520166
step:  21, cost: 8.00E-03, attack: 0.996, loss: 0.197799, ce: 0.060017, reg: 17.222734, reg_best: 17.222734
step:  22, cost: 8.00E-03, attack: 0.996, loss: 0.206240, ce: 0.063507, reg: 17.841589, reg_best: 17.222734
step:  23, cost: 8.00E-03, attack: 0.997, loss: 0.206373, ce: 0.055224, reg: 18.893608, reg_best: 17.222734
step:  24, cost: 8.00E-03, attack: 0.998, loss: 0.166757, ce: 0.030021, reg: 17.109547, reg_best: 17.109547
step:  25, cost: 8.00E-03, attack: 0.997, loss: 0.181676, ce: 0.050458, reg: 16.402212, reg_best: 16.402212
up cost from 8.00E-03 to 1.60E-02
step:  26, cost: 1.60E-02, attack: 0.995, loss: 0.330273, ce: 0.087366, reg: 15.181684, reg_best: 15.181684
step:  27, cost: 1.60E-02, attack: 0.995, loss: 0.336009, ce: 0.076061, reg: 16.246759, reg_best: 15.181684
step:  28, cost: 1.60E-02, attack: 0.997, loss: 0.317850, ce: 0.054450, reg: 16.462536, reg_best: 15.181684
step:  29, cost: 1.60E-02, attack: 0.993, loss: 0.359980, ce: 0.109987, reg: 15.624539, reg_best: 15.181684
step:  30, cost: 1.60E-02, attack: 0.997, loss: 0.319100, ce: 0.045311, reg: 17.111799, reg_best: 15.181684
up cost from 1.60E-02 to 3.20E-02
step:  31, cost: 3.20E-02, attack: 0.998, loss: 0.554676, ce: 0.031782, reg: 16.340445, reg_best: 15.181684
step:  32, cost: 3.20E-02, attack: 0.995, loss: 0.599606, ce: 0.085462, reg: 16.067009, reg_best: 15.181684
step:  33, cost: 3.20E-02, attack: 0.986, loss: 0.691619, ce: 0.235066, reg: 14.267304, reg_best: 15.181684
step:  34, cost: 3.20E-02, attack: 0.985, loss: 0.684610, ce: 0.261346, reg: 13.226983, reg_best: 15.181684
step:  35, cost: 3.20E-02, attack: 0.995, loss: 0.598670, ce: 0.077885, reg: 16.274557, reg_best: 15.181684
step:  36, cost: 3.20E-02, attack: 0.996, loss: 0.546394, ce: 0.067215, reg: 14.964516, reg_best: 14.964516
step:  37, cost: 3.20E-02, attack: 0.984, loss: 0.692817, ce: 0.255492, reg: 13.666413, reg_best: 14.964516
step:  38, cost: 3.20E-02, attack: 0.996, loss: 0.559391, ce: 0.071696, reg: 15.240470, reg_best: 14.964516
step:  39, cost: 3.20E-02, attack: 0.996, loss: 0.576804, ce: 0.063053, reg: 16.054726, reg_best: 14.964516
step:  40, cost: 3.20E-02, attack: 0.999, loss: 0.553472, ce: 0.010127, reg: 16.979517, reg_best: 14.964516
step:  41, cost: 3.20E-02, attack: 0.989, loss: 0.639557, ce: 0.179953, reg: 14.362621, reg_best: 14.964516
step:  42, cost: 3.20E-02, attack: 0.995, loss: 0.559117, ce: 0.089020, reg: 14.690529, reg_best: 14.690529
step:  43, cost: 3.20E-02, attack: 0.996, loss: 0.596378, ce: 0.074050, reg: 16.322727, reg_best: 14.690529
step:  44, cost: 3.20E-02, attack: 0.995, loss: 0.586380, ce: 0.087727, reg: 15.582909, reg_best: 14.690529
step:  45, cost: 3.20E-02, attack: 0.991, loss: 0.627755, ce: 0.149080, reg: 14.958622, reg_best: 14.690529
step:  46, cost: 3.20E-02, attack: 0.989, loss: 0.607269, ce: 0.172981, reg: 13.571520, reg_best: 14.690529
step:  47, cost: 3.20E-02, attack: 0.988, loss: 0.660247, ce: 0.203743, reg: 14.265752, reg_best: 14.690529
step:  48, cost: 3.20E-02, attack: 0.997, loss: 0.573997, ce: 0.062642, reg: 15.979850, reg_best: 14.690529
step:  49, cost: 3.20E-02, attack: 0.999, loss: 0.529109, ce: 0.018038, reg: 15.965587, reg_best: 14.690529
step:  50, cost: 3.20E-02, attack: 0.993, loss: 0.605978, ce: 0.112419, reg: 15.423726, reg_best: 14.690529
step:  51, cost: 3.20E-02, attack: 0.996, loss: 0.575544, ce: 0.071626, reg: 15.747437, reg_best: 14.690529
step:  52, cost: 3.20E-02, attack: 0.990, loss: 0.606058, ce: 0.159451, reg: 13.956470, reg_best: 14.690529
step:  53, cost: 3.20E-02, attack: 0.995, loss: 0.590831, ce: 0.062527, reg: 16.509493, reg_best: 14.690529
step:  54, cost: 3.20E-02, attack: 0.996, loss: 0.561345, ce: 0.067768, reg: 15.424273, reg_best: 14.690529
step:  55, cost: 3.20E-02, attack: 0.988, loss: 0.637413, ce: 0.192681, reg: 13.897858, reg_best: 14.690529
step:  56, cost: 3.20E-02, attack: 0.983, loss: 0.679607, ce: 0.275065, reg: 12.641936, reg_best: 14.690529
step:  57, cost: 3.20E-02, attack: 0.992, loss: 0.582035, ce: 0.123218, reg: 14.338022, reg_best: 14.338022
step:  58, cost: 3.20E-02, attack: 0.995, loss: 0.581130, ce: 0.076412, reg: 15.772447, reg_best: 14.338022
step:  59, cost: 3.20E-02, attack: 1.000, loss: 0.549121, ce: 0.009884, reg: 16.851143, reg_best: 14.338022
step:  60, cost: 3.20E-02, attack: 0.995, loss: 0.580176, ce: 0.091004, reg: 15.286624, reg_best: 14.338022
step:  61, cost: 3.20E-02, attack: 0.993, loss: 0.610557, ce: 0.104880, reg: 15.802387, reg_best: 14.338022
up cost from 3.20E-02 to 6.40E-02
step:  62, cost: 6.40E-02, attack: 0.982, loss: 1.202839, ce: 0.305319, reg: 14.035691, reg_best: 14.338022
step:  63, cost: 6.40E-02, attack: 0.986, loss: 1.103006, ce: 0.225986, reg: 13.703437, reg_best: 14.338022
step:  64, cost: 6.40E-02, attack: 0.994, loss: 1.035119, ce: 0.088880, reg: 14.784986, reg_best: 14.338022
step:  65, cost: 6.40E-02, attack: 0.984, loss: 1.135759, ce: 0.272700, reg: 13.485286, reg_best: 14.338022
step:  66, cost: 6.40E-02, attack: 0.990, loss: 1.027101, ce: 0.163500, reg: 13.493771, reg_best: 14.338022
step:  67, cost: 6.40E-02, attack: 0.994, loss: 1.017136, ce: 0.105893, reg: 14.238172, reg_best: 14.238172
step:  68, cost: 6.40E-02, attack: 0.986, loss: 1.133571, ce: 0.221435, reg: 14.252112, reg_best: 14.238172
step:  69, cost: 6.40E-02, attack: 0.996, loss: 1.041278, ce: 0.064717, reg: 15.258763, reg_best: 14.238172
step:  70, cost: 6.40E-02, attack: 0.990, loss: 1.076607, ce: 0.166989, reg: 14.212782, reg_best: 14.238172
step:  71, cost: 6.40E-02, attack: 0.973, loss: 1.246051, ce: 0.428513, reg: 12.774034, reg_best: 14.238172
step:  72, cost: 6.40E-02, attack: 0.984, loss: 1.108520, ce: 0.272762, reg: 13.058716, reg_best: 14.238172
step:  73, cost: 6.40E-02, attack: 0.992, loss: 1.114153, ce: 0.148384, reg: 15.090135, reg_best: 14.238172
step:  74, cost: 6.40E-02, attack: 0.994, loss: 1.060874, ce: 0.093668, reg: 15.112589, reg_best: 14.238172
step:  75, cost: 6.40E-02, attack: 0.986, loss: 1.066077, ce: 0.244446, reg: 12.839190, reg_best: 14.238172
step:  76, cost: 6.40E-02, attack: 0.982, loss: 1.153351, ce: 0.298634, reg: 13.354943, reg_best: 14.238172
step:  77, cost: 6.40E-02, attack: 0.994, loss: 1.036966, ce: 0.097117, reg: 14.685138, reg_best: 14.238172
step:  78, cost: 6.40E-02, attack: 0.988, loss: 1.075944, ce: 0.190638, reg: 13.832898, reg_best: 14.238172
step:  79, cost: 6.40E-02, attack: 0.989, loss: 1.071402, ce: 0.187061, reg: 13.817835, reg_best: 14.238172
step:  80, cost: 6.40E-02, attack: 0.986, loss: 1.077263, ce: 0.231462, reg: 13.215636, reg_best: 14.238172
step:  81, cost: 6.40E-02, attack: 0.981, loss: 1.145816, ce: 0.294838, reg: 13.296536, reg_best: 14.238172
step:  82, cost: 6.40E-02, attack: 0.995, loss: 0.995795, ce: 0.097197, reg: 14.040595, reg_best: 14.040595
step:  83, cost: 6.40E-02, attack: 0.997, loss: 1.032809, ce: 0.056786, reg: 15.250356, reg_best: 14.040595
step:  84, cost: 6.40E-02, attack: 0.994, loss: 0.970712, ce: 0.102865, reg: 13.560112, reg_best: 13.560112
step:  85, cost: 6.40E-02, attack: 0.986, loss: 1.102841, ce: 0.225467, reg: 13.708966, reg_best: 13.560112
step:  86, cost: 6.40E-02, attack: 0.990, loss: 1.099463, ce: 0.153037, reg: 14.787911, reg_best: 13.560112
step:  87, cost: 6.40E-02, attack: 0.993, loss: 1.098647, ce: 0.111293, reg: 15.419502, reg_best: 13.560112
step:  88, cost: 6.40E-02, attack: 0.988, loss: 1.085657, ce: 0.204917, reg: 13.761560, reg_best: 13.560112
step:  89, cost: 6.40E-02, attack: 0.990, loss: 1.073406, ce: 0.159168, reg: 14.284967, reg_best: 13.560112
step:  90, cost: 6.40E-02, attack: 0.995, loss: 0.983967, ce: 0.076181, reg: 14.184149, reg_best: 13.560112
step:  91, cost: 6.40E-02, attack: 0.993, loss: 1.067515, ce: 0.128126, reg: 14.677946, reg_best: 13.560112
step:  92, cost: 6.40E-02, attack: 0.995, loss: 1.035957, ce: 0.097060, reg: 14.670269, reg_best: 13.560112
step:  93, cost: 6.40E-02, attack: 0.984, loss: 1.156007, ce: 0.255223, reg: 14.074750, reg_best: 13.560112
step:  94, cost: 6.40E-02, attack: 0.985, loss: 1.114840, ce: 0.245099, reg: 13.589707, reg_best: 13.560112
step:  95, cost: 6.40E-02, attack: 0.990, loss: 1.039456, ce: 0.164440, reg: 13.672128, reg_best: 13.560112
step:  96, cost: 6.40E-02, attack: 0.988, loss: 1.137800, ce: 0.187971, reg: 14.841084, reg_best: 13.560112
step:  97, cost: 6.40E-02, attack: 0.991, loss: 1.084833, ce: 0.147105, reg: 14.651998, reg_best: 13.560112
step:  98, cost: 6.40E-02, attack: 0.982, loss: 1.104221, ce: 0.300597, reg: 12.556636, reg_best: 13.560112
step:  99, cost: 6.40E-02, attack: 0.957, loss: 1.434758, ce: 0.695503, reg: 11.550859, reg_best: 13.560112
pattern, shape: (32, 32, 3), min: 0.000008, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 33: 11.470906
visualization cost 20.109221 seconds
processing label 34
resetting state
mask_tanh -4.797068874823789 4.266447722449826
pattern_tanh -4.807859851877991 4.099576954735539
step:   0, cost: 0.00E+00, attack: 0.796, loss: 3.373713, ce: 3.373713, reg: 539.578918, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000444, ce: 0.000444, reg: 569.877563, reg_best: 569.877563
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000015, ce: 0.000015, reg: 572.838257, reg_best: 569.877563
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000004, ce: 0.000004, reg: 573.658752, reg_best: 569.877563
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000003, ce: 0.000003, reg: 575.989685, reg_best: 569.877563
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 578.556274, reg_best: 569.877563
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.478308, ce: 0.062621, reg: 415.687927, reg_best: 415.687927
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.352455, ce: 0.035371, reg: 317.083923, reg_best: 317.083923
step:   8, cost: 1.00E-03, attack: 0.998, loss: 0.322844, ce: 0.037369, reg: 285.475189, reg_best: 285.475189
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.290398, ce: 0.024218, reg: 266.180054, reg_best: 266.180054
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.463425, ce: 0.024543, reg: 219.440979, reg_best: 219.440979
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.422156, ce: 0.031050, reg: 195.552841, reg_best: 195.552841
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.397553, ce: 0.032409, reg: 182.571899, reg_best: 182.571899
step:  13, cost: 2.00E-03, attack: 0.998, loss: 0.382282, ce: 0.036159, reg: 173.048080, reg_best: 173.048080
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.339768, ce: 0.012000, reg: 163.883636, reg_best: 163.883636
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.996, loss: 0.651823, ce: 0.059169, reg: 148.163391, reg_best: 148.163391
step:  16, cost: 4.00E-03, attack: 0.996, loss: 0.604129, ce: 0.076616, reg: 131.878082, reg_best: 131.878082
step:  17, cost: 4.00E-03, attack: 0.994, loss: 0.619664, ce: 0.104136, reg: 128.881821, reg_best: 128.881821
step:  18, cost: 4.00E-03, attack: 0.996, loss: 0.573662, ce: 0.069916, reg: 125.936371, reg_best: 125.936371
step:  19, cost: 4.00E-03, attack: 0.996, loss: 0.558102, ce: 0.073608, reg: 121.123611, reg_best: 121.123611
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.990, loss: 1.027291, ce: 0.148106, reg: 109.898132, reg_best: 121.123611
step:  21, cost: 8.00E-03, attack: 0.992, loss: 1.037301, ce: 0.112522, reg: 115.597260, reg_best: 115.597260
step:  22, cost: 8.00E-03, attack: 0.995, loss: 0.970118, ce: 0.073925, reg: 112.024078, reg_best: 112.024078
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.966603, ce: 0.080388, reg: 110.776855, reg_best: 110.776855
step:  24, cost: 8.00E-03, attack: 0.994, loss: 0.978459, ce: 0.099987, reg: 109.809021, reg_best: 109.809021
step:  25, cost: 8.00E-03, attack: 0.998, loss: 0.904931, ce: 0.041929, reg: 107.875252, reg_best: 107.875252
up cost from 8.00E-03 to 1.60E-02
step:  26, cost: 1.60E-02, attack: 0.993, loss: 1.749706, ce: 0.123068, reg: 101.721497, reg_best: 101.721497
step:  27, cost: 1.60E-02, attack: 0.987, loss: 1.781364, ce: 0.219967, reg: 97.587288, reg_best: 101.721497
step:  28, cost: 1.60E-02, attack: 0.992, loss: 1.693429, ce: 0.151026, reg: 96.400185, reg_best: 96.400185
step:  29, cost: 1.60E-02, attack: 0.991, loss: 1.713304, ce: 0.142699, reg: 98.162804, reg_best: 96.400185
step:  30, cost: 1.60E-02, attack: 0.987, loss: 1.762282, ce: 0.200192, reg: 97.630600, reg_best: 96.400185
step:  31, cost: 1.60E-02, attack: 0.992, loss: 1.691938, ce: 0.151138, reg: 96.299980, reg_best: 96.299980
step:  32, cost: 1.60E-02, attack: 0.993, loss: 1.653412, ce: 0.096948, reg: 97.279015, reg_best: 96.299980
step:  33, cost: 1.60E-02, attack: 0.991, loss: 1.630901, ce: 0.131064, reg: 93.739807, reg_best: 93.739807
step:  34, cost: 1.60E-02, attack: 0.992, loss: 1.634421, ce: 0.138497, reg: 93.495255, reg_best: 93.495255
step:  35, cost: 1.60E-02, attack: 0.992, loss: 1.622695, ce: 0.140176, reg: 92.657440, reg_best: 92.657440
up cost from 1.60E-02 to 3.20E-02
step:  36, cost: 3.20E-02, attack: 0.988, loss: 3.092642, ce: 0.222990, reg: 89.676590, reg_best: 92.657440
step:  37, cost: 3.20E-02, attack: 0.989, loss: 2.977077, ce: 0.186332, reg: 87.210762, reg_best: 92.657440
step:  38, cost: 3.20E-02, attack: 0.987, loss: 3.022643, ce: 0.240862, reg: 86.952164, reg_best: 92.657440
step:  39, cost: 3.20E-02, attack: 0.983, loss: 3.057502, ce: 0.296417, reg: 86.283897, reg_best: 92.657440
step:  40, cost: 3.20E-02, attack: 0.982, loss: 3.074198, ce: 0.290108, reg: 87.002800, reg_best: 92.657440
down cost from 3.20E-02 to 1.13E-02
step:  41, cost: 1.13E-02, attack: 0.993, loss: 1.133726, ce: 0.120493, reg: 89.557930, reg_best: 89.557930
step:  42, cost: 1.13E-02, attack: 0.989, loss: 1.227876, ce: 0.179964, reg: 92.623260, reg_best: 89.557930
step:  43, cost: 1.13E-02, attack: 0.995, loss: 1.113169, ce: 0.074205, reg: 91.832344, reg_best: 89.557930
step:  44, cost: 1.13E-02, attack: 0.992, loss: 1.172593, ce: 0.136874, reg: 91.545494, reg_best: 89.557930
step:  45, cost: 1.13E-02, attack: 0.995, loss: 1.134358, ce: 0.092169, reg: 92.117332, reg_best: 89.557930
step:  46, cost: 1.13E-02, attack: 0.996, loss: 1.095719, ce: 0.073568, reg: 90.346191, reg_best: 89.557930
step:  47, cost: 1.13E-02, attack: 0.994, loss: 1.120508, ce: 0.101589, reg: 90.060524, reg_best: 89.557930
up cost from 1.13E-02 to 2.26E-02
step:  48, cost: 2.26E-02, attack: 0.991, loss: 2.152314, ce: 0.154348, reg: 88.298447, reg_best: 88.298447
step:  49, cost: 2.26E-02, attack: 0.992, loss: 2.139575, ce: 0.144529, reg: 88.169373, reg_best: 88.169373
step:  50, cost: 2.26E-02, attack: 0.989, loss: 2.123404, ce: 0.189619, reg: 85.462044, reg_best: 88.169373
step:  51, cost: 2.26E-02, attack: 0.987, loss: 2.181206, ce: 0.218392, reg: 86.728867, reg_best: 88.169373
step:  52, cost: 2.26E-02, attack: 0.988, loss: 2.149028, ce: 0.181549, reg: 86.951126, reg_best: 88.169373
step:  53, cost: 2.26E-02, attack: 0.988, loss: 2.180239, ce: 0.188369, reg: 88.029030, reg_best: 88.169373
step:  54, cost: 2.26E-02, attack: 0.987, loss: 2.133355, ce: 0.203859, reg: 85.272484, reg_best: 88.169373
down cost from 2.26E-02 to 8.00E-03
step:  55, cost: 8.00E-03, attack: 0.990, loss: 0.876766, ce: 0.164307, reg: 89.057449, reg_best: 88.169373
step:  56, cost: 8.00E-03, attack: 0.998, loss: 0.810200, ce: 0.073009, reg: 92.148819, reg_best: 88.169373
step:  57, cost: 8.00E-03, attack: 0.994, loss: 0.830025, ce: 0.088550, reg: 92.684357, reg_best: 88.169373
step:  58, cost: 8.00E-03, attack: 0.992, loss: 0.866195, ce: 0.136858, reg: 91.167213, reg_best: 88.169373
step:  59, cost: 8.00E-03, attack: 0.995, loss: 0.817992, ce: 0.081019, reg: 92.121628, reg_best: 88.169373
step:  60, cost: 8.00E-03, attack: 0.998, loss: 0.792049, ce: 0.035180, reg: 94.608604, reg_best: 88.169373
up cost from 8.00E-03 to 1.60E-02
step:  61, cost: 1.60E-02, attack: 0.996, loss: 1.529254, ce: 0.098612, reg: 89.415062, reg_best: 88.169373
step:  62, cost: 1.60E-02, attack: 0.995, loss: 1.529041, ce: 0.093730, reg: 89.706963, reg_best: 88.169373
step:  63, cost: 1.60E-02, attack: 0.992, loss: 1.556262, ce: 0.143102, reg: 88.322517, reg_best: 88.169373
step:  64, cost: 1.60E-02, attack: 0.993, loss: 1.523670, ce: 0.133070, reg: 86.915382, reg_best: 86.915382
step:  65, cost: 1.60E-02, attack: 0.996, loss: 1.493488, ce: 0.087109, reg: 87.898720, reg_best: 86.915382
up cost from 1.60E-02 to 3.20E-02
step:  66, cost: 3.20E-02, attack: 0.981, loss: 3.064441, ce: 0.292754, reg: 86.615227, reg_best: 86.915382
step:  67, cost: 3.20E-02, attack: 0.982, loss: 2.989161, ce: 0.303267, reg: 83.934189, reg_best: 86.915382
step:  68, cost: 3.20E-02, attack: 0.989, loss: 2.887718, ce: 0.186728, reg: 84.405945, reg_best: 86.915382
step:  69, cost: 3.20E-02, attack: 0.987, loss: 2.909230, ce: 0.238466, reg: 83.461380, reg_best: 86.915382
step:  70, cost: 3.20E-02, attack: 0.975, loss: 3.114062, ce: 0.415802, reg: 84.320602, reg_best: 86.915382
down cost from 3.20E-02 to 1.13E-02
step:  71, cost: 1.13E-02, attack: 0.985, loss: 1.248850, ce: 0.252550, reg: 88.061295, reg_best: 86.915382
step:  72, cost: 1.13E-02, attack: 0.995, loss: 1.118779, ce: 0.100497, reg: 90.004280, reg_best: 86.915382
step:  73, cost: 1.13E-02, attack: 0.989, loss: 1.183655, ce: 0.195205, reg: 87.367409, reg_best: 86.915382
step:  74, cost: 1.13E-02, attack: 0.993, loss: 1.149461, ce: 0.127902, reg: 90.293854, reg_best: 86.915382
step:  75, cost: 1.13E-02, attack: 0.993, loss: 1.133096, ce: 0.118118, reg: 89.712242, reg_best: 86.915382
step:  76, cost: 1.13E-02, attack: 0.997, loss: 1.098280, ce: 0.062740, reg: 91.529716, reg_best: 86.915382
step:  77, cost: 1.13E-02, attack: 0.996, loss: 1.105035, ce: 0.069732, reg: 91.501167, reg_best: 86.915382
step:  78, cost: 1.13E-02, attack: 0.993, loss: 1.118649, ce: 0.110047, reg: 89.148628, reg_best: 86.915382
up cost from 1.13E-02 to 2.26E-02
step:  79, cost: 2.26E-02, attack: 0.991, loss: 2.138867, ce: 0.149727, reg: 87.908409, reg_best: 86.915382
step:  80, cost: 2.26E-02, attack: 0.991, loss: 2.100293, ce: 0.176625, reg: 85.014900, reg_best: 85.014900
step:  81, cost: 2.26E-02, attack: 0.992, loss: 2.080756, ce: 0.128284, reg: 86.287895, reg_best: 85.014900
step:  82, cost: 2.26E-02, attack: 0.990, loss: 2.133477, ce: 0.162908, reg: 87.087685, reg_best: 85.014900
step:  83, cost: 2.26E-02, attack: 0.990, loss: 2.125480, ce: 0.168136, reg: 86.503204, reg_best: 85.014900
step:  84, cost: 2.26E-02, attack: 0.992, loss: 2.145807, ce: 0.141254, reg: 88.589546, reg_best: 85.014900
step:  85, cost: 2.26E-02, attack: 0.989, loss: 2.172205, ce: 0.203029, reg: 87.026085, reg_best: 85.014900
step:  86, cost: 2.26E-02, attack: 0.991, loss: 2.124851, ce: 0.163113, reg: 86.697372, reg_best: 85.014900
step:  87, cost: 2.26E-02, attack: 0.992, loss: 2.111464, ce: 0.150626, reg: 86.657616, reg_best: 85.014900
step:  88, cost: 2.26E-02, attack: 0.991, loss: 2.087551, ce: 0.155389, reg: 85.390282, reg_best: 85.014900
step:  89, cost: 2.26E-02, attack: 0.980, loss: 2.248904, ce: 0.312675, reg: 85.618973, reg_best: 85.014900
step:  90, cost: 2.26E-02, attack: 0.986, loss: 2.186715, ce: 0.212452, reg: 87.250961, reg_best: 85.014900
step:  91, cost: 2.26E-02, attack: 0.988, loss: 2.168730, ce: 0.206186, reg: 86.733002, reg_best: 85.014900
step:  92, cost: 2.26E-02, attack: 0.984, loss: 2.180439, ce: 0.259694, reg: 84.885727, reg_best: 85.014900
step:  93, cost: 2.26E-02, attack: 0.983, loss: 2.210235, ce: 0.296463, reg: 84.577576, reg_best: 85.014900
down cost from 2.26E-02 to 8.00E-03
step:  94, cost: 8.00E-03, attack: 0.990, loss: 0.883117, ce: 0.177029, reg: 88.260918, reg_best: 85.014900
step:  95, cost: 8.00E-03, attack: 0.990, loss: 0.863094, ce: 0.151728, reg: 88.920708, reg_best: 85.014900
step:  96, cost: 8.00E-03, attack: 0.993, loss: 0.849993, ce: 0.139344, reg: 88.831184, reg_best: 85.014900
step:  97, cost: 8.00E-03, attack: 0.990, loss: 0.884711, ce: 0.164224, reg: 90.060959, reg_best: 85.014900
step:  98, cost: 8.00E-03, attack: 0.995, loss: 0.799355, ce: 0.092921, reg: 88.304268, reg_best: 85.014900
step:  99, cost: 8.00E-03, attack: 0.992, loss: 0.856388, ce: 0.141386, reg: 89.375252, reg_best: 85.014900
pattern, shape: (32, 32, 3), min: 0.000015, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 34: 89.025459
visualization cost 20.228605 seconds
processing label 35
resetting state
mask_tanh -4.323466728428545 3.7689639098237677
pattern_tanh -3.9710062993676 4.428991022420704
step:   0, cost: 0.00E+00, attack: 0.838, loss: 2.707902, ce: 2.707902, reg: 546.651306, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000873, ce: 0.000873, reg: 571.699646, reg_best: 571.699646
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.002447, ce: 0.002447, reg: 581.756470, reg_best: 571.699646
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 583.331238, reg_best: 571.699646
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 583.374390, reg_best: 571.699646
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 583.790894, reg_best: 571.699646
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.999, loss: 0.430843, ce: 0.033720, reg: 397.122742, reg_best: 397.122742
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.313517, ce: 0.018968, reg: 294.548584, reg_best: 294.548584
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.265577, ce: 0.016121, reg: 249.455368, reg_best: 249.455368
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.244796, ce: 0.014580, reg: 230.215622, reg_best: 230.215622
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 1.000, loss: 0.400969, ce: 0.007237, reg: 196.866272, reg_best: 196.866272
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.367728, ce: 0.038731, reg: 164.498413, reg_best: 164.498413
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.338401, ce: 0.026343, reg: 156.029068, reg_best: 156.029068
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.304451, ce: 0.023960, reg: 140.245804, reg_best: 140.245804
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.290862, ce: 0.015772, reg: 137.545212, reg_best: 137.545212
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.996, loss: 0.583110, ce: 0.052244, reg: 132.691299, reg_best: 132.691299
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.509874, ce: 0.030903, reg: 119.742668, reg_best: 119.742668
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.519720, ce: 0.061440, reg: 114.570229, reg_best: 114.570229
step:  18, cost: 4.00E-03, attack: 1.000, loss: 0.456026, ce: 0.017507, reg: 109.629829, reg_best: 109.629829
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.470972, ce: 0.046717, reg: 106.063553, reg_best: 106.063553
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.990, loss: 0.925156, ce: 0.142286, reg: 97.858795, reg_best: 106.063553
step:  21, cost: 8.00E-03, attack: 0.995, loss: 0.877083, ce: 0.071845, reg: 100.654732, reg_best: 100.654732
step:  22, cost: 8.00E-03, attack: 0.996, loss: 0.838750, ce: 0.066330, reg: 96.552467, reg_best: 96.552467
step:  23, cost: 8.00E-03, attack: 0.996, loss: 0.820041, ce: 0.070889, reg: 93.643944, reg_best: 93.643944
step:  24, cost: 8.00E-03, attack: 0.993, loss: 0.840000, ce: 0.106273, reg: 91.715927, reg_best: 91.715927
step:  25, cost: 8.00E-03, attack: 0.990, loss: 0.831658, ce: 0.153870, reg: 84.723564, reg_best: 91.715927
step:  26, cost: 8.00E-03, attack: 0.993, loss: 0.822183, ce: 0.113956, reg: 88.528374, reg_best: 88.528374
step:  27, cost: 8.00E-03, attack: 0.998, loss: 0.763457, ce: 0.060777, reg: 87.834915, reg_best: 87.834915
step:  28, cost: 8.00E-03, attack: 0.995, loss: 0.771717, ce: 0.080158, reg: 86.468765, reg_best: 86.468765
step:  29, cost: 8.00E-03, attack: 0.996, loss: 0.738371, ce: 0.071392, reg: 83.372391, reg_best: 83.372391
step:  30, cost: 8.00E-03, attack: 0.995, loss: 0.741840, ce: 0.089820, reg: 81.502487, reg_best: 81.502487
up cost from 8.00E-03 to 1.60E-02
step:  31, cost: 1.60E-02, attack: 0.993, loss: 1.429564, ce: 0.119652, reg: 81.869469, reg_best: 81.502487
step:  32, cost: 1.60E-02, attack: 0.995, loss: 1.377122, ce: 0.091003, reg: 80.382416, reg_best: 80.382416
step:  33, cost: 1.60E-02, attack: 0.990, loss: 1.375859, ce: 0.173497, reg: 75.147644, reg_best: 80.382416
step:  34, cost: 1.60E-02, attack: 0.995, loss: 1.384646, ce: 0.104087, reg: 80.034904, reg_best: 80.034904
step:  35, cost: 1.60E-02, attack: 0.993, loss: 1.360393, ce: 0.110047, reg: 78.146652, reg_best: 78.146652
step:  36, cost: 1.60E-02, attack: 0.995, loss: 1.313274, ce: 0.104446, reg: 75.551682, reg_best: 75.551682
step:  37, cost: 1.60E-02, attack: 0.992, loss: 1.361995, ce: 0.121001, reg: 77.562103, reg_best: 75.551682
step:  38, cost: 1.60E-02, attack: 0.992, loss: 1.347358, ce: 0.135807, reg: 75.721962, reg_best: 75.551682
up cost from 1.60E-02 to 3.20E-02
step:  39, cost: 3.20E-02, attack: 0.994, loss: 2.497204, ce: 0.137804, reg: 73.731232, reg_best: 73.731232
step:  40, cost: 3.20E-02, attack: 0.991, loss: 2.485435, ce: 0.178498, reg: 72.071320, reg_best: 72.071320
step:  41, cost: 3.20E-02, attack: 0.987, loss: 2.425185, ce: 0.244549, reg: 68.144875, reg_best: 72.071320
step:  42, cost: 3.20E-02, attack: 0.976, loss: 2.569959, ce: 0.432318, reg: 66.801277, reg_best: 72.071320
step:  43, cost: 3.20E-02, attack: 0.986, loss: 2.365164, ce: 0.227606, reg: 66.798668, reg_best: 72.071320
step:  44, cost: 3.20E-02, attack: 0.982, loss: 2.384439, ce: 0.291301, reg: 65.410591, reg_best: 72.071320
step:  45, cost: 3.20E-02, attack: 0.986, loss: 2.386866, ce: 0.258169, reg: 66.521751, reg_best: 72.071320
down cost from 3.20E-02 to 1.13E-02
step:  46, cost: 1.13E-02, attack: 0.991, loss: 0.947753, ce: 0.165762, reg: 69.118858, reg_best: 69.118858
step:  47, cost: 1.13E-02, attack: 0.991, loss: 0.963377, ce: 0.136304, reg: 73.103622, reg_best: 69.118858
step:  48, cost: 1.13E-02, attack: 0.998, loss: 0.877129, ce: 0.055291, reg: 72.640884, reg_best: 69.118858
step:  49, cost: 1.13E-02, attack: 0.989, loss: 0.953074, ce: 0.203319, reg: 66.269539, reg_best: 69.118858
step:  50, cost: 1.13E-02, attack: 0.991, loss: 0.922479, ce: 0.130789, reg: 69.976158, reg_best: 69.118858
step:  51, cost: 1.13E-02, attack: 0.996, loss: 0.873966, ce: 0.066129, reg: 71.403366, reg_best: 69.118858
step:  52, cost: 1.13E-02, attack: 0.992, loss: 0.948626, ce: 0.128973, reg: 72.447723, reg_best: 69.118858
step:  53, cost: 1.13E-02, attack: 0.994, loss: 0.917257, ce: 0.094896, reg: 72.684021, reg_best: 69.118858
step:  54, cost: 1.13E-02, attack: 0.993, loss: 0.916829, ce: 0.120974, reg: 70.344322, reg_best: 69.118858
up cost from 1.13E-02 to 2.26E-02
step:  55, cost: 2.26E-02, attack: 0.992, loss: 1.722663, ce: 0.138434, reg: 70.013680, reg_best: 69.118858
step:  56, cost: 2.26E-02, attack: 0.987, loss: 1.791206, ce: 0.232880, reg: 68.868904, reg_best: 69.118858
step:  57, cost: 2.26E-02, attack: 0.984, loss: 1.799866, ce: 0.264953, reg: 67.834206, reg_best: 69.118858
step:  58, cost: 2.26E-02, attack: 0.980, loss: 1.793727, ce: 0.336260, reg: 64.411583, reg_best: 69.118858
step:  59, cost: 2.26E-02, attack: 0.996, loss: 1.595413, ce: 0.083449, reg: 66.819992, reg_best: 66.819992
step:  60, cost: 2.26E-02, attack: 0.989, loss: 1.690311, ce: 0.165729, reg: 67.377678, reg_best: 66.819992
step:  61, cost: 2.26E-02, attack: 0.997, loss: 1.689824, ce: 0.087204, reg: 70.826477, reg_best: 66.819992
step:  62, cost: 2.26E-02, attack: 0.992, loss: 1.658016, ce: 0.134130, reg: 67.346893, reg_best: 66.819992
step:  63, cost: 2.26E-02, attack: 0.990, loss: 1.712785, ce: 0.185843, reg: 67.481972, reg_best: 66.819992
step:  64, cost: 2.26E-02, attack: 0.993, loss: 1.627513, ce: 0.145641, reg: 65.490128, reg_best: 65.490128
step:  65, cost: 2.26E-02, attack: 0.984, loss: 1.768316, ce: 0.268289, reg: 66.292458, reg_best: 65.490128
step:  66, cost: 2.26E-02, attack: 0.991, loss: 1.666214, ce: 0.158501, reg: 66.637924, reg_best: 65.490128
step:  67, cost: 2.26E-02, attack: 0.986, loss: 1.693496, ce: 0.241950, reg: 64.149887, reg_best: 65.490128
step:  68, cost: 2.26E-02, attack: 0.991, loss: 1.694300, ce: 0.138613, reg: 68.752327, reg_best: 65.490128
step:  69, cost: 2.26E-02, attack: 0.993, loss: 1.656107, ce: 0.119780, reg: 67.896721, reg_best: 65.490128
step:  70, cost: 2.26E-02, attack: 0.979, loss: 1.807715, ce: 0.357536, reg: 64.089500, reg_best: 65.490128
step:  71, cost: 2.26E-02, attack: 0.986, loss: 1.713221, ce: 0.230038, reg: 65.548050, reg_best: 65.490128
step:  72, cost: 2.26E-02, attack: 0.989, loss: 1.683807, ce: 0.187479, reg: 66.128983, reg_best: 65.490128
step:  73, cost: 2.26E-02, attack: 0.992, loss: 1.705815, ce: 0.144516, reg: 69.000320, reg_best: 65.490128
step:  74, cost: 2.26E-02, attack: 0.986, loss: 1.725619, ce: 0.255515, reg: 64.970039, reg_best: 65.490128
step:  75, cost: 2.26E-02, attack: 0.993, loss: 1.617092, ce: 0.132242, reg: 65.621719, reg_best: 65.490128
step:  76, cost: 2.26E-02, attack: 0.979, loss: 1.780364, ce: 0.333855, reg: 63.927280, reg_best: 65.490128
step:  77, cost: 2.26E-02, attack: 0.989, loss: 1.676542, ce: 0.206829, reg: 64.952744, reg_best: 65.490128
step:  78, cost: 2.26E-02, attack: 0.991, loss: 1.689631, ce: 0.156388, reg: 67.760406, reg_best: 65.490128
step:  79, cost: 2.26E-02, attack: 0.987, loss: 1.722415, ce: 0.211384, reg: 66.811508, reg_best: 65.490128
step:  80, cost: 2.26E-02, attack: 0.990, loss: 1.670828, ce: 0.170317, reg: 66.313873, reg_best: 65.490128
step:  81, cost: 2.26E-02, attack: 0.986, loss: 1.670768, ce: 0.223533, reg: 63.959366, reg_best: 65.490128
step:  82, cost: 2.26E-02, attack: 0.981, loss: 1.737475, ce: 0.304825, reg: 63.314754, reg_best: 65.490128
step:  83, cost: 2.26E-02, attack: 0.980, loss: 1.780629, ce: 0.332934, reg: 63.979702, reg_best: 65.490128
down cost from 2.26E-02 to 8.00E-03
step:  84, cost: 8.00E-03, attack: 0.995, loss: 0.650874, ce: 0.096955, reg: 69.239876, reg_best: 65.490128
step:  85, cost: 8.00E-03, attack: 0.996, loss: 0.646776, ce: 0.070434, reg: 72.042793, reg_best: 65.490128
step:  86, cost: 8.00E-03, attack: 0.995, loss: 0.648561, ce: 0.069795, reg: 72.345787, reg_best: 65.490128
step:  87, cost: 8.00E-03, attack: 0.994, loss: 0.670950, ce: 0.114946, reg: 69.500511, reg_best: 65.490128
step:  88, cost: 8.00E-03, attack: 0.996, loss: 0.631599, ce: 0.065764, reg: 70.729408, reg_best: 65.490128
up cost from 8.00E-03 to 1.60E-02
step:  89, cost: 1.60E-02, attack: 0.992, loss: 1.239061, ce: 0.128292, reg: 69.423050, reg_best: 65.490128
early stop
pattern, shape: (32, 32, 3), min: 0.000000, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 35: 63.078392
visualization cost 18.176123 seconds
processing label 36
resetting state
mask_tanh -5.287992447674002 3.5072247514765693
pattern_tanh -3.96450180550145 4.274176764721673
step:   0, cost: 0.00E+00, attack: 0.847, loss: 2.537922, ce: 2.537922, reg: 542.042542, reg_best: inf
step:   1, cost: 0.00E+00, attack: 0.999, loss: 0.022443, ce: 0.022443, reg: 567.232483, reg_best: 567.232483
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000017, ce: 0.000017, reg: 581.801453, reg_best: 567.232483
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000007, ce: 0.000007, reg: 582.087402, reg_best: 567.232483
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 582.301575, reg_best: 567.232483
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000004, ce: 0.000004, reg: 583.219360, reg_best: 567.232483
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.995, loss: 0.495970, ce: 0.095254, reg: 400.715057, reg_best: 400.715057
step:   7, cost: 1.00E-03, attack: 0.999, loss: 0.347118, ce: 0.013247, reg: 333.870056, reg_best: 333.870056
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.272536, ce: 0.010259, reg: 262.277130, reg_best: 262.277130
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.245620, ce: 0.017249, reg: 228.371155, reg_best: 228.371155
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.406614, ce: 0.018342, reg: 194.135925, reg_best: 194.135925
step:  11, cost: 2.00E-03, attack: 1.000, loss: 0.364287, ce: 0.009426, reg: 177.430313, reg_best: 177.430313
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.345173, ce: 0.032441, reg: 156.365952, reg_best: 156.365952
step:  13, cost: 2.00E-03, attack: 0.996, loss: 0.352273, ce: 0.055403, reg: 148.434845, reg_best: 148.434845
step:  14, cost: 2.00E-03, attack: 0.998, loss: 0.315245, ce: 0.026116, reg: 144.588013, reg_best: 144.588013
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.998, loss: 0.580717, ce: 0.039444, reg: 135.318329, reg_best: 135.318329
step:  16, cost: 4.00E-03, attack: 0.999, loss: 0.528788, ce: 0.017253, reg: 127.883675, reg_best: 127.883675
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.501696, ce: 0.041222, reg: 115.118484, reg_best: 115.118484
step:  18, cost: 4.00E-03, attack: 1.000, loss: 0.463905, ce: 0.016292, reg: 111.903130, reg_best: 111.903130
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.448788, ce: 0.030128, reg: 104.665001, reg_best: 104.665001
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.990, loss: 0.929937, ce: 0.166961, reg: 95.371925, reg_best: 104.665001
step:  21, cost: 8.00E-03, attack: 0.997, loss: 0.837723, ce: 0.058686, reg: 97.379684, reg_best: 97.379684
step:  22, cost: 8.00E-03, attack: 0.996, loss: 0.825940, ce: 0.069047, reg: 94.611610, reg_best: 94.611610
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.794161, ce: 0.073629, reg: 90.066391, reg_best: 90.066391
step:  24, cost: 8.00E-03, attack: 0.994, loss: 0.851440, ce: 0.100592, reg: 93.855934, reg_best: 90.066391
step:  25, cost: 8.00E-03, attack: 0.995, loss: 0.860706, ce: 0.110098, reg: 93.825951, reg_best: 90.066391
up cost from 8.00E-03 to 1.60E-02
step:  26, cost: 1.60E-02, attack: 0.991, loss: 1.595537, ce: 0.153397, reg: 90.133728, reg_best: 90.066391
step:  27, cost: 1.60E-02, attack: 0.991, loss: 1.516237, ce: 0.149196, reg: 85.428230, reg_best: 85.428230
step:  28, cost: 1.60E-02, attack: 0.991, loss: 1.460237, ce: 0.136616, reg: 82.726288, reg_best: 82.726288
step:  29, cost: 1.60E-02, attack: 0.993, loss: 1.457435, ce: 0.103641, reg: 84.612083, reg_best: 82.726288
step:  30, cost: 1.60E-02, attack: 0.991, loss: 1.509905, ce: 0.148894, reg: 85.063171, reg_best: 82.726288
up cost from 1.60E-02 to 3.20E-02
step:  31, cost: 3.20E-02, attack: 0.992, loss: 2.831715, ce: 0.152611, reg: 83.721985, reg_best: 82.726288
step:  32, cost: 3.20E-02, attack: 0.989, loss: 2.751539, ce: 0.202164, reg: 79.667976, reg_best: 82.726288
step:  33, cost: 3.20E-02, attack: 0.986, loss: 2.764850, ce: 0.220109, reg: 79.523163, reg_best: 82.726288
step:  34, cost: 3.20E-02, attack: 0.986, loss: 2.677404, ce: 0.216091, reg: 76.916008, reg_best: 82.726288
step:  35, cost: 3.20E-02, attack: 0.979, loss: 2.779374, ce: 0.361693, reg: 75.552505, reg_best: 82.726288
step:  36, cost: 3.20E-02, attack: 0.978, loss: 2.748576, ce: 0.383878, reg: 73.896812, reg_best: 82.726288
down cost from 3.20E-02 to 1.13E-02
step:  37, cost: 1.13E-02, attack: 0.991, loss: 1.057559, ce: 0.156065, reg: 79.681511, reg_best: 79.681511
step:  38, cost: 1.13E-02, attack: 0.993, loss: 1.044309, ce: 0.130078, reg: 80.807396, reg_best: 79.681511
step:  39, cost: 1.13E-02, attack: 0.986, loss: 1.101829, ce: 0.228129, reg: 77.224907, reg_best: 79.681511
step:  40, cost: 1.13E-02, attack: 0.994, loss: 1.022071, ce: 0.103864, reg: 81.136414, reg_best: 79.681511
step:  41, cost: 1.13E-02, attack: 0.995, loss: 1.021935, ce: 0.100667, reg: 81.429337, reg_best: 79.681511
step:  42, cost: 1.13E-02, attack: 0.994, loss: 1.014872, ce: 0.093847, reg: 81.407921, reg_best: 79.681511
step:  43, cost: 1.13E-02, attack: 0.996, loss: 1.016690, ce: 0.082108, reg: 82.606178, reg_best: 79.681511
step:  44, cost: 1.13E-02, attack: 0.990, loss: 1.067018, ce: 0.161738, reg: 80.016197, reg_best: 79.681511
step:  45, cost: 1.13E-02, attack: 0.995, loss: 0.987438, ce: 0.079925, reg: 80.213593, reg_best: 79.681511
step:  46, cost: 1.13E-02, attack: 0.989, loss: 1.070889, ce: 0.163104, reg: 80.237633, reg_best: 79.681511
step:  47, cost: 1.13E-02, attack: 0.996, loss: 0.997153, ce: 0.060583, reg: 82.781845, reg_best: 79.681511
step:  48, cost: 1.13E-02, attack: 0.989, loss: 1.057292, ce: 0.190509, reg: 76.613503, reg_best: 79.681511
step:  49, cost: 1.13E-02, attack: 0.994, loss: 1.010387, ce: 0.087833, reg: 81.543030, reg_best: 79.681511
step:  50, cost: 1.13E-02, attack: 0.996, loss: 0.957741, ce: 0.064258, reg: 78.973427, reg_best: 78.973427
step:  51, cost: 1.13E-02, attack: 0.993, loss: 1.030118, ce: 0.124214, reg: 80.071312, reg_best: 78.973427
step:  52, cost: 1.13E-02, attack: 0.992, loss: 1.010988, ce: 0.141837, reg: 76.796333, reg_best: 76.796333
step:  53, cost: 1.13E-02, attack: 0.997, loss: 0.977022, ce: 0.059275, reg: 81.118202, reg_best: 76.796333
up cost from 1.13E-02 to 2.26E-02
step:  54, cost: 2.26E-02, attack: 0.988, loss: 1.948200, ce: 0.199298, reg: 77.291290, reg_best: 76.796333
step:  55, cost: 2.26E-02, attack: 0.992, loss: 1.863361, ce: 0.141164, reg: 76.111084, reg_best: 76.111084
step:  56, cost: 2.26E-02, attack: 0.993, loss: 1.833557, ce: 0.133067, reg: 75.151718, reg_best: 75.151718
step:  57, cost: 2.26E-02, attack: 0.987, loss: 1.983086, ce: 0.204393, reg: 78.607903, reg_best: 75.151718
step:  58, cost: 2.26E-02, attack: 0.989, loss: 1.926946, ce: 0.180136, reg: 77.198845, reg_best: 75.151718
step:  59, cost: 2.26E-02, attack: 0.991, loss: 1.881870, ce: 0.128953, reg: 77.468742, reg_best: 75.151718
step:  60, cost: 2.26E-02, attack: 0.993, loss: 1.840046, ce: 0.131895, reg: 75.490311, reg_best: 75.151718
step:  61, cost: 2.26E-02, attack: 0.995, loss: 1.825042, ce: 0.103422, reg: 76.085587, reg_best: 75.151718
step:  62, cost: 2.26E-02, attack: 0.983, loss: 1.940535, ce: 0.281983, reg: 73.298325, reg_best: 75.151718
step:  63, cost: 2.26E-02, attack: 0.983, loss: 1.901957, ce: 0.270964, reg: 72.080406, reg_best: 75.151718
step:  64, cost: 2.26E-02, attack: 0.986, loss: 1.935652, ce: 0.225113, reg: 75.595863, reg_best: 75.151718
step:  65, cost: 2.26E-02, attack: 0.995, loss: 1.804740, ce: 0.111834, reg: 74.808235, reg_best: 74.808235
step:  66, cost: 2.26E-02, attack: 0.990, loss: 1.886545, ce: 0.180826, reg: 75.382835, reg_best: 74.808235
step:  67, cost: 2.26E-02, attack: 0.989, loss: 1.861853, ce: 0.188539, reg: 73.950722, reg_best: 74.808235
step:  68, cost: 2.26E-02, attack: 0.989, loss: 1.875217, ce: 0.206419, reg: 73.751129, reg_best: 74.808235
step:  69, cost: 2.26E-02, attack: 0.988, loss: 1.873411, ce: 0.187061, reg: 74.526833, reg_best: 74.808235
step:  70, cost: 2.26E-02, attack: 0.987, loss: 1.865885, ce: 0.210635, reg: 73.152405, reg_best: 74.808235
down cost from 2.26E-02 to 8.00E-03
step:  71, cost: 8.00E-03, attack: 0.992, loss: 0.762629, ce: 0.127044, reg: 79.448090, reg_best: 74.808235
step:  72, cost: 8.00E-03, attack: 0.997, loss: 0.707797, ce: 0.054115, reg: 81.710236, reg_best: 74.808235
step:  73, cost: 8.00E-03, attack: 0.992, loss: 0.741974, ce: 0.113673, reg: 78.537590, reg_best: 74.808235
step:  74, cost: 8.00E-03, attack: 0.998, loss: 0.683055, ce: 0.044190, reg: 79.858116, reg_best: 74.808235
step:  75, cost: 8.00E-03, attack: 0.997, loss: 0.703635, ce: 0.050253, reg: 81.672798, reg_best: 74.808235
up cost from 8.00E-03 to 1.60E-02
step:  76, cost: 1.60E-02, attack: 0.995, loss: 1.372918, ce: 0.085037, reg: 80.492599, reg_best: 74.808235
step:  77, cost: 1.60E-02, attack: 0.990, loss: 1.397512, ce: 0.172145, reg: 76.585434, reg_best: 74.808235
step:  78, cost: 1.60E-02, attack: 0.993, loss: 1.372964, ce: 0.118692, reg: 78.418381, reg_best: 74.808235
step:  79, cost: 1.60E-02, attack: 0.992, loss: 1.384054, ce: 0.140374, reg: 77.729996, reg_best: 74.808235
step:  80, cost: 1.60E-02, attack: 0.996, loss: 1.329667, ce: 0.082921, reg: 77.921638, reg_best: 74.808235
step:  81, cost: 1.60E-02, attack: 0.994, loss: 1.334106, ce: 0.093958, reg: 77.509285, reg_best: 74.808235
step:  82, cost: 1.60E-02, attack: 0.993, loss: 1.351183, ce: 0.125814, reg: 76.585548, reg_best: 74.808235
up cost from 1.60E-02 to 3.20E-02
step:  83, cost: 3.20E-02, attack: 0.989, loss: 2.600893, ce: 0.179440, reg: 75.670403, reg_best: 74.808235
step:  84, cost: 3.20E-02, attack: 0.993, loss: 2.554729, ce: 0.145673, reg: 75.283012, reg_best: 74.808235
step:  85, cost: 3.20E-02, attack: 0.987, loss: 2.563514, ce: 0.228423, reg: 72.971588, reg_best: 74.808235
step:  86, cost: 3.20E-02, attack: 0.988, loss: 2.499725, ce: 0.209377, reg: 71.573357, reg_best: 74.808235
step:  87, cost: 3.20E-02, attack: 0.986, loss: 2.632611, ce: 0.266043, reg: 73.955208, reg_best: 74.808235
step:  88, cost: 3.20E-02, attack: 0.983, loss: 2.609925, ce: 0.287873, reg: 72.564133, reg_best: 74.808235
step:  89, cost: 3.20E-02, attack: 0.992, loss: 2.471852, ce: 0.162929, reg: 72.153824, reg_best: 72.153824
step:  90, cost: 3.20E-02, attack: 0.981, loss: 2.593455, ce: 0.297457, reg: 71.769798, reg_best: 72.153824
step:  91, cost: 3.20E-02, attack: 0.985, loss: 2.532136, ce: 0.234972, reg: 71.786369, reg_best: 72.153824
step:  92, cost: 3.20E-02, attack: 0.986, loss: 2.599544, ce: 0.239326, reg: 73.756813, reg_best: 72.153824
step:  93, cost: 3.20E-02, attack: 0.985, loss: 2.533359, ce: 0.244183, reg: 71.536728, reg_best: 72.153824
step:  94, cost: 3.20E-02, attack: 0.984, loss: 2.587714, ce: 0.277090, reg: 72.206993, reg_best: 72.153824
down cost from 3.20E-02 to 1.13E-02
step:  95, cost: 1.13E-02, attack: 0.992, loss: 1.029659, ce: 0.150988, reg: 77.664314, reg_best: 72.153824
step:  96, cost: 1.13E-02, attack: 0.997, loss: 0.957476, ce: 0.053233, reg: 79.924576, reg_best: 72.153824
step:  97, cost: 1.13E-02, attack: 0.996, loss: 0.941240, ce: 0.068934, reg: 77.101723, reg_best: 72.153824
step:  98, cost: 1.13E-02, attack: 0.990, loss: 1.048910, ce: 0.161233, reg: 78.460342, reg_best: 72.153824
step:  99, cost: 1.13E-02, attack: 0.990, loss: 1.017660, ce: 0.170457, reg: 74.882889, reg_best: 72.153824
pattern, shape: (32, 32, 3), min: 0.000008, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 36: 70.889542
visualization cost 20.195959 seconds
processing label 37
resetting state
mask_tanh -2.6662412110981473 3.3358614800270505
pattern_tanh -4.356915232280047 3.8551411574417536
step:   0, cost: 0.00E+00, attack: 0.821, loss: 3.032243, ce: 3.032243, reg: 545.317505, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.011621, ce: 0.011621, reg: 581.362427, reg_best: 581.362427
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000151, ce: 0.000151, reg: 590.611572, reg_best: 581.362427
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000023, ce: 0.000023, reg: 592.218201, reg_best: 581.362427
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 593.132812, reg_best: 581.362427
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 594.238892, reg_best: 581.362427
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.998, loss: 0.479335, ce: 0.058485, reg: 420.850037, reg_best: 420.850037
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.359300, ce: 0.001426, reg: 357.873901, reg_best: 357.873901
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.329812, ce: 0.017994, reg: 311.818665, reg_best: 311.818665
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.281993, ce: 0.034010, reg: 247.982544, reg_best: 247.982544
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.997, loss: 0.512560, ce: 0.048061, reg: 232.249084, reg_best: 232.249084
step:  11, cost: 2.00E-03, attack: 1.000, loss: 0.424099, ce: 0.012553, reg: 205.772797, reg_best: 205.772797
step:  12, cost: 2.00E-03, attack: 1.000, loss: 0.405095, ce: 0.024168, reg: 190.463577, reg_best: 190.463577
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.385433, ce: 0.023333, reg: 181.050079, reg_best: 181.050079
step:  14, cost: 2.00E-03, attack: 1.000, loss: 0.364343, ce: 0.016351, reg: 173.996017, reg_best: 173.996017
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.995, loss: 0.710922, ce: 0.085626, reg: 156.324097, reg_best: 156.324097
step:  16, cost: 4.00E-03, attack: 0.999, loss: 0.621770, ce: 0.027847, reg: 148.501328, reg_best: 148.501328
step:  17, cost: 4.00E-03, attack: 0.993, loss: 0.665951, ce: 0.105963, reg: 139.997025, reg_best: 139.997025
step:  18, cost: 4.00E-03, attack: 0.997, loss: 0.605668, ce: 0.060628, reg: 136.259933, reg_best: 136.259933
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.577448, ce: 0.040304, reg: 134.285934, reg_best: 134.285934
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.999, loss: 1.106664, ce: 0.027026, reg: 134.954620, reg_best: 134.285934
step:  21, cost: 8.00E-03, attack: 0.992, loss: 1.140769, ce: 0.133412, reg: 125.919563, reg_best: 125.919563
step:  22, cost: 8.00E-03, attack: 0.992, loss: 1.091227, ce: 0.138160, reg: 119.133308, reg_best: 119.133308
step:  23, cost: 8.00E-03, attack: 0.998, loss: 1.018069, ce: 0.050017, reg: 121.006447, reg_best: 119.133308
step:  24, cost: 8.00E-03, attack: 0.988, loss: 1.120760, ce: 0.170671, reg: 118.761131, reg_best: 119.133308
step:  25, cost: 8.00E-03, attack: 0.996, loss: 1.054890, ce: 0.094676, reg: 120.026665, reg_best: 119.133308
step:  26, cost: 8.00E-03, attack: 0.995, loss: 1.042172, ce: 0.083508, reg: 119.832947, reg_best: 119.133308
step:  27, cost: 8.00E-03, attack: 0.994, loss: 1.016436, ce: 0.100655, reg: 114.472717, reg_best: 114.472717
step:  28, cost: 8.00E-03, attack: 0.995, loss: 1.005381, ce: 0.093702, reg: 113.959846, reg_best: 113.959846
step:  29, cost: 8.00E-03, attack: 0.994, loss: 0.983851, ce: 0.071870, reg: 114.025261, reg_best: 113.959846
up cost from 8.00E-03 to 1.60E-02
step:  30, cost: 1.60E-02, attack: 0.998, loss: 1.821666, ce: 0.060169, reg: 110.093552, reg_best: 110.093552
step:  31, cost: 1.60E-02, attack: 0.989, loss: 1.920399, ce: 0.188285, reg: 108.257141, reg_best: 110.093552
step:  32, cost: 1.60E-02, attack: 0.994, loss: 1.835077, ce: 0.120361, reg: 107.169724, reg_best: 107.169724
step:  33, cost: 1.60E-02, attack: 0.990, loss: 1.795752, ce: 0.153792, reg: 102.622528, reg_best: 107.169724
step:  34, cost: 1.60E-02, attack: 0.994, loss: 1.756463, ce: 0.106859, reg: 103.100288, reg_best: 103.100288
step:  35, cost: 1.60E-02, attack: 0.993, loss: 1.821003, ce: 0.125290, reg: 105.982063, reg_best: 103.100288
step:  36, cost: 1.60E-02, attack: 0.980, loss: 1.942304, ce: 0.326352, reg: 100.996964, reg_best: 103.100288
step:  37, cost: 1.60E-02, attack: 0.991, loss: 1.814392, ce: 0.157227, reg: 103.572807, reg_best: 103.100288
step:  38, cost: 1.60E-02, attack: 0.994, loss: 1.742175, ce: 0.099053, reg: 102.695099, reg_best: 102.695099
step:  39, cost: 1.60E-02, attack: 0.987, loss: 1.803412, ce: 0.207826, reg: 99.724129, reg_best: 102.695099
step:  40, cost: 1.60E-02, attack: 0.988, loss: 1.834584, ce: 0.204675, reg: 101.869354, reg_best: 102.695099
step:  41, cost: 1.60E-02, attack: 0.990, loss: 1.774102, ce: 0.146211, reg: 101.694153, reg_best: 102.695099
step:  42, cost: 1.60E-02, attack: 0.992, loss: 1.743501, ce: 0.164438, reg: 98.691422, reg_best: 98.691422
step:  43, cost: 1.60E-02, attack: 0.993, loss: 1.772969, ce: 0.141749, reg: 101.951233, reg_best: 98.691422
step:  44, cost: 1.60E-02, attack: 0.988, loss: 1.795879, ce: 0.211314, reg: 99.035309, reg_best: 98.691422
step:  45, cost: 1.60E-02, attack: 0.988, loss: 1.819178, ce: 0.208243, reg: 100.683411, reg_best: 98.691422
step:  46, cost: 1.60E-02, attack: 0.989, loss: 1.783833, ce: 0.179713, reg: 100.257469, reg_best: 98.691422
step:  47, cost: 1.60E-02, attack: 0.990, loss: 1.772426, ce: 0.160647, reg: 100.736122, reg_best: 98.691422
step:  48, cost: 1.60E-02, attack: 0.993, loss: 1.730054, ce: 0.110949, reg: 101.194023, reg_best: 98.691422
step:  49, cost: 1.60E-02, attack: 0.996, loss: 1.680117, ce: 0.080784, reg: 99.958305, reg_best: 98.691422
step:  50, cost: 1.60E-02, attack: 0.990, loss: 1.728038, ce: 0.153266, reg: 98.423233, reg_best: 98.691422
step:  51, cost: 1.60E-02, attack: 0.998, loss: 1.626224, ce: 0.053381, reg: 98.302643, reg_best: 98.302643
step:  52, cost: 1.60E-02, attack: 0.997, loss: 1.645168, ce: 0.062786, reg: 98.898895, reg_best: 98.302643
step:  53, cost: 1.60E-02, attack: 0.989, loss: 1.740502, ce: 0.182492, reg: 97.375633, reg_best: 98.302643
step:  54, cost: 1.60E-02, attack: 0.989, loss: 1.738234, ce: 0.182742, reg: 97.235519, reg_best: 98.302643
step:  55, cost: 1.60E-02, attack: 0.991, loss: 1.714121, ce: 0.163609, reg: 96.907028, reg_best: 96.907028
step:  56, cost: 1.60E-02, attack: 0.990, loss: 1.696865, ce: 0.155488, reg: 96.336052, reg_best: 96.907028
step:  57, cost: 1.60E-02, attack: 0.993, loss: 1.625075, ce: 0.129420, reg: 93.478409, reg_best: 93.478409
step:  58, cost: 1.60E-02, attack: 0.989, loss: 1.693299, ce: 0.171657, reg: 95.102646, reg_best: 93.478409
step:  59, cost: 1.60E-02, attack: 0.987, loss: 1.732965, ce: 0.231394, reg: 93.848145, reg_best: 93.478409
step:  60, cost: 1.60E-02, attack: 0.989, loss: 1.697246, ce: 0.180600, reg: 94.790352, reg_best: 93.478409
step:  61, cost: 1.60E-02, attack: 0.990, loss: 1.691105, ce: 0.153771, reg: 96.083366, reg_best: 93.478409
step:  62, cost: 1.60E-02, attack: 0.985, loss: 1.759635, ce: 0.245177, reg: 94.653603, reg_best: 93.478409
down cost from 1.60E-02 to 5.66E-03
step:  63, cost: 5.66E-03, attack: 0.995, loss: 0.651210, ce: 0.096143, reg: 98.122993, reg_best: 93.478409
step:  64, cost: 5.66E-03, attack: 0.996, loss: 0.630371, ce: 0.070635, reg: 98.948212, reg_best: 93.478409
step:  65, cost: 5.66E-03, attack: 0.998, loss: 0.623804, ce: 0.044628, reg: 102.384766, reg_best: 93.478409
step:  66, cost: 5.66E-03, attack: 0.994, loss: 0.677053, ce: 0.103486, reg: 101.393196, reg_best: 93.478409
step:  67, cost: 5.66E-03, attack: 0.996, loss: 0.621943, ce: 0.066065, reg: 98.263710, reg_best: 93.478409
up cost from 5.66E-03 to 1.13E-02
step:  68, cost: 1.13E-02, attack: 0.997, loss: 1.189000, ce: 0.053648, reg: 100.351868, reg_best: 93.478409
step:  69, cost: 1.13E-02, attack: 0.992, loss: 1.230010, ce: 0.141019, reg: 96.254120, reg_best: 93.478409
step:  70, cost: 1.13E-02, attack: 0.994, loss: 1.178417, ce: 0.094488, reg: 95.806747, reg_best: 93.478409
step:  71, cost: 1.13E-02, attack: 0.990, loss: 1.284570, ce: 0.185168, reg: 97.174332, reg_best: 93.478409
step:  72, cost: 1.13E-02, attack: 0.988, loss: 1.278533, ce: 0.186780, reg: 96.498260, reg_best: 93.478409
step:  73, cost: 1.13E-02, attack: 0.996, loss: 1.151726, ce: 0.058465, reg: 96.631561, reg_best: 93.478409
step:  74, cost: 1.13E-02, attack: 0.993, loss: 1.189596, ce: 0.100207, reg: 96.289276, reg_best: 93.478409
step:  75, cost: 1.13E-02, attack: 0.994, loss: 1.205881, ce: 0.127768, reg: 95.292534, reg_best: 93.478409
step:  76, cost: 1.13E-02, attack: 0.996, loss: 1.165995, ce: 0.076516, reg: 96.297310, reg_best: 93.478409
step:  77, cost: 1.13E-02, attack: 0.994, loss: 1.198693, ce: 0.118459, reg: 95.480095, reg_best: 93.478409
up cost from 1.13E-02 to 2.26E-02
step:  78, cost: 2.26E-02, attack: 0.990, loss: 2.328755, ce: 0.190757, reg: 94.487053, reg_best: 93.478409
step:  79, cost: 2.26E-02, attack: 0.992, loss: 2.315689, ce: 0.132690, reg: 96.475800, reg_best: 93.478409
step:  80, cost: 2.26E-02, attack: 0.992, loss: 2.239588, ce: 0.137257, reg: 92.929489, reg_best: 92.929489
step:  81, cost: 2.26E-02, attack: 0.984, loss: 2.333064, ce: 0.242271, reg: 92.400856, reg_best: 92.929489
step:  82, cost: 2.26E-02, attack: 0.978, loss: 2.387893, ce: 0.325203, reg: 91.158867, reg_best: 92.929489
step:  83, cost: 2.26E-02, attack: 0.989, loss: 2.328312, ce: 0.184784, reg: 94.731461, reg_best: 92.929489
step:  84, cost: 2.26E-02, attack: 0.992, loss: 2.310316, ce: 0.143678, reg: 95.752747, reg_best: 92.929489
step:  85, cost: 2.26E-02, attack: 0.992, loss: 2.279774, ce: 0.162327, reg: 93.578789, reg_best: 92.929489
step:  86, cost: 2.26E-02, attack: 0.982, loss: 2.369499, ce: 0.306834, reg: 91.157806, reg_best: 92.929489
step:  87, cost: 2.26E-02, attack: 0.991, loss: 2.257017, ce: 0.186564, reg: 91.501976, reg_best: 91.501976
step:  88, cost: 2.26E-02, attack: 0.984, loss: 2.334193, ce: 0.241952, reg: 92.464813, reg_best: 91.501976
step:  89, cost: 2.26E-02, attack: 0.989, loss: 2.244025, ce: 0.209600, reg: 89.909691, reg_best: 91.501976
step:  90, cost: 2.26E-02, attack: 0.988, loss: 2.343359, ce: 0.222940, reg: 93.710152, reg_best: 91.501976
step:  91, cost: 2.26E-02, attack: 0.991, loss: 2.271736, ce: 0.159860, reg: 93.332603, reg_best: 91.501976
step:  92, cost: 2.26E-02, attack: 0.983, loss: 2.335386, ce: 0.272241, reg: 91.158783, reg_best: 91.501976
step:  93, cost: 2.26E-02, attack: 0.986, loss: 2.307278, ce: 0.239923, reg: 91.365051, reg_best: 91.501976
step:  94, cost: 2.26E-02, attack: 0.987, loss: 2.334003, ce: 0.231103, reg: 92.935905, reg_best: 91.501976
step:  95, cost: 2.26E-02, attack: 0.984, loss: 2.356289, ce: 0.285018, reg: 91.538071, reg_best: 91.501976
step:  96, cost: 2.26E-02, attack: 0.986, loss: 2.354241, ce: 0.223559, reg: 94.163719, reg_best: 91.501976
down cost from 2.26E-02 to 8.00E-03
step:  97, cost: 8.00E-03, attack: 0.985, loss: 0.972731, ce: 0.228055, reg: 93.084496, reg_best: 91.501976
step:  98, cost: 8.00E-03, attack: 0.995, loss: 0.871575, ce: 0.081806, reg: 98.721191, reg_best: 91.501976
step:  99, cost: 8.00E-03, attack: 0.997, loss: 0.833132, ce: 0.056071, reg: 97.132660, reg_best: 91.501976
pattern, shape: (32, 32, 3), min: 0.000000, max: 254.999985
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 37: 93.396500
visualization cost 20.246913 seconds
processing label 38
resetting state
mask_tanh -4.44680802301051 3.049979630959192
pattern_tanh -3.896854603544193 4.197670266197699
step:   0, cost: 0.00E+00, attack: 0.898, loss: 1.692304, ce: 1.692304, reg: 552.134949, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000815, ce: 0.000815, reg: 565.423523, reg_best: 565.423523
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000022, ce: 0.000022, reg: 569.807678, reg_best: 565.423523
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000004, ce: 0.000004, reg: 570.289673, reg_best: 565.423523
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 571.242004, reg_best: 565.423523
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 576.615295, reg_best: 565.423523
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.998, loss: 0.417014, ce: 0.037513, reg: 379.501862, reg_best: 379.501862
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.314079, ce: 0.041436, reg: 272.642700, reg_best: 272.642700
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.235303, ce: 0.006982, reg: 228.321014, reg_best: 228.321014
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.220345, ce: 0.028346, reg: 191.999146, reg_best: 191.999146
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.335255, ce: 0.012121, reg: 161.567230, reg_best: 161.567230
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.308746, ce: 0.021833, reg: 143.456680, reg_best: 143.456680
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.250099, ce: 0.019394, reg: 115.352486, reg_best: 115.352486
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.223249, ce: 0.013986, reg: 104.631569, reg_best: 104.631569
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.211189, ce: 0.021475, reg: 94.857201, reg_best: 94.857201
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.999, loss: 0.348417, ce: 0.017691, reg: 82.681473, reg_best: 82.681473
step:  16, cost: 4.00E-03, attack: 0.990, loss: 0.444806, ce: 0.156307, reg: 72.124756, reg_best: 82.681473
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.345394, ce: 0.041925, reg: 75.867348, reg_best: 75.867348
step:  18, cost: 4.00E-03, attack: 0.999, loss: 0.295840, ce: 0.018401, reg: 69.355362, reg_best: 69.355362
step:  19, cost: 4.00E-03, attack: 0.996, loss: 0.325141, ce: 0.067177, reg: 64.490807, reg_best: 64.490807
step:  20, cost: 4.00E-03, attack: 0.994, loss: 0.361786, ce: 0.088120, reg: 68.416489, reg_best: 64.490807
step:  21, cost: 4.00E-03, attack: 1.000, loss: 0.266147, ce: 0.006575, reg: 64.893204, reg_best: 64.490807
up cost from 4.00E-03 to 8.00E-03
step:  22, cost: 8.00E-03, attack: 0.997, loss: 0.544051, ce: 0.063359, reg: 60.086468, reg_best: 60.086468
step:  23, cost: 8.00E-03, attack: 0.997, loss: 0.540317, ce: 0.054199, reg: 60.764740, reg_best: 60.086468
step:  24, cost: 8.00E-03, attack: 0.993, loss: 0.559164, ce: 0.117837, reg: 55.165966, reg_best: 55.165966
step:  25, cost: 8.00E-03, attack: 0.997, loss: 0.515301, ce: 0.043764, reg: 58.942097, reg_best: 55.165966
step:  26, cost: 8.00E-03, attack: 0.999, loss: 0.498673, ce: 0.026003, reg: 59.083744, reg_best: 55.165966
up cost from 8.00E-03 to 1.60E-02
step:  27, cost: 1.60E-02, attack: 0.994, loss: 0.957734, ce: 0.107480, reg: 53.140869, reg_best: 53.140869
step:  28, cost: 1.60E-02, attack: 0.995, loss: 0.961356, ce: 0.078196, reg: 55.197544, reg_best: 53.140869
step:  29, cost: 1.60E-02, attack: 0.996, loss: 0.915994, ce: 0.060851, reg: 53.446453, reg_best: 53.140869
step:  30, cost: 1.60E-02, attack: 0.992, loss: 0.927158, ce: 0.124223, reg: 50.183422, reg_best: 50.183422
step:  31, cost: 1.60E-02, attack: 0.993, loss: 0.921006, ce: 0.109273, reg: 50.722931, reg_best: 50.183422
up cost from 1.60E-02 to 3.20E-02
step:  32, cost: 3.20E-02, attack: 0.989, loss: 1.740567, ce: 0.189174, reg: 48.481030, reg_best: 50.183422
step:  33, cost: 3.20E-02, attack: 0.982, loss: 1.822238, ce: 0.285033, reg: 48.037666, reg_best: 50.183422
step:  34, cost: 3.20E-02, attack: 0.994, loss: 1.640796, ce: 0.119286, reg: 47.547161, reg_best: 47.547161
step:  35, cost: 3.20E-02, attack: 0.984, loss: 1.720873, ce: 0.273050, reg: 45.244488, reg_best: 47.547161
step:  36, cost: 3.20E-02, attack: 0.987, loss: 1.659771, ce: 0.216238, reg: 45.110424, reg_best: 47.547161
step:  37, cost: 3.20E-02, attack: 0.994, loss: 1.598505, ce: 0.109390, reg: 46.534821, reg_best: 46.534821
step:  38, cost: 3.20E-02, attack: 0.990, loss: 1.656077, ce: 0.166178, reg: 46.559334, reg_best: 46.534821
step:  39, cost: 3.20E-02, attack: 0.995, loss: 1.625208, ce: 0.091389, reg: 47.931850, reg_best: 46.534821
step:  40, cost: 3.20E-02, attack: 0.992, loss: 1.580548, ce: 0.125175, reg: 45.480392, reg_best: 45.480392
step:  41, cost: 3.20E-02, attack: 0.996, loss: 1.571858, ce: 0.083284, reg: 46.517918, reg_best: 45.480392
step:  42, cost: 3.20E-02, attack: 0.979, loss: 1.726834, ce: 0.345170, reg: 43.176971, reg_best: 45.480392
step:  43, cost: 3.20E-02, attack: 0.990, loss: 1.630269, ce: 0.165508, reg: 45.764805, reg_best: 45.480392
step:  44, cost: 3.20E-02, attack: 0.992, loss: 1.580771, ce: 0.142041, reg: 44.960323, reg_best: 44.960323
step:  45, cost: 3.20E-02, attack: 0.992, loss: 1.563958, ce: 0.126419, reg: 44.923069, reg_best: 44.923069
step:  46, cost: 3.20E-02, attack: 0.993, loss: 1.580869, ce: 0.141887, reg: 44.968174, reg_best: 44.923069
step:  47, cost: 3.20E-02, attack: 0.992, loss: 1.563594, ce: 0.118729, reg: 45.152020, reg_best: 44.923069
step:  48, cost: 3.20E-02, attack: 0.986, loss: 1.601160, ce: 0.233645, reg: 42.734837, reg_best: 44.923069
step:  49, cost: 3.20E-02, attack: 0.985, loss: 1.707417, ce: 0.234638, reg: 46.024345, reg_best: 44.923069
step:  50, cost: 3.20E-02, attack: 0.988, loss: 1.633832, ce: 0.181018, reg: 45.400463, reg_best: 44.923069
step:  51, cost: 3.20E-02, attack: 0.984, loss: 1.642470, ce: 0.248667, reg: 43.556358, reg_best: 44.923069
step:  52, cost: 3.20E-02, attack: 0.987, loss: 1.653197, ce: 0.223356, reg: 44.682541, reg_best: 44.923069
down cost from 3.20E-02 to 1.13E-02
step:  53, cost: 1.13E-02, attack: 0.991, loss: 0.679130, ce: 0.155895, reg: 46.247913, reg_best: 44.923069
step:  54, cost: 1.13E-02, attack: 0.993, loss: 0.647878, ce: 0.130635, reg: 45.718281, reg_best: 44.923069
step:  55, cost: 1.13E-02, attack: 0.986, loss: 0.727404, ce: 0.213015, reg: 45.465961, reg_best: 44.923069
step:  56, cost: 1.13E-02, attack: 0.995, loss: 0.627214, ce: 0.092377, reg: 47.266674, reg_best: 44.923069
step:  57, cost: 1.13E-02, attack: 0.992, loss: 0.659791, ce: 0.123213, reg: 47.427273, reg_best: 44.923069
step:  58, cost: 1.13E-02, attack: 0.991, loss: 0.664634, ce: 0.121657, reg: 47.992870, reg_best: 44.923069
step:  59, cost: 1.13E-02, attack: 0.995, loss: 0.625921, ce: 0.081980, reg: 48.078068, reg_best: 44.923069
step:  60, cost: 1.13E-02, attack: 0.995, loss: 0.617163, ce: 0.069060, reg: 48.445934, reg_best: 44.923069
up cost from 1.13E-02 to 2.26E-02
step:  61, cost: 2.26E-02, attack: 0.993, loss: 1.187372, ce: 0.114215, reg: 47.427265, reg_best: 44.923069
step:  62, cost: 2.26E-02, attack: 0.992, loss: 1.154392, ce: 0.130965, reg: 45.229534, reg_best: 44.923069
step:  63, cost: 2.26E-02, attack: 0.994, loss: 1.136340, ce: 0.135027, reg: 44.252171, reg_best: 44.252171
step:  64, cost: 2.26E-02, attack: 0.992, loss: 1.166052, ce: 0.117669, reg: 46.332397, reg_best: 44.252171
step:  65, cost: 2.26E-02, attack: 0.993, loss: 1.125129, ce: 0.114226, reg: 44.676003, reg_best: 44.252171
up cost from 2.26E-02 to 4.53E-02
step:  66, cost: 4.53E-02, attack: 0.990, loss: 2.164298, ce: 0.170805, reg: 44.050373, reg_best: 44.252171
step:  67, cost: 4.53E-02, attack: 0.987, loss: 2.196936, ce: 0.212108, reg: 43.858910, reg_best: 44.252171
step:  68, cost: 4.53E-02, attack: 0.994, loss: 2.055956, ce: 0.105981, reg: 43.088753, reg_best: 43.088753
step:  69, cost: 4.53E-02, attack: 0.983, loss: 2.198825, ce: 0.272860, reg: 42.556465, reg_best: 43.088753
step:  70, cost: 4.53E-02, attack: 0.986, loss: 2.173190, ce: 0.242202, reg: 42.669220, reg_best: 43.088753
step:  71, cost: 4.53E-02, attack: 0.986, loss: 2.175731, ce: 0.240208, reg: 42.769428, reg_best: 43.088753
step:  72, cost: 4.53E-02, attack: 0.985, loss: 2.190372, ce: 0.237330, reg: 43.156544, reg_best: 43.088753
step:  73, cost: 4.53E-02, attack: 0.983, loss: 2.192646, ce: 0.258757, reg: 42.733311, reg_best: 43.088753
down cost from 4.53E-02 to 1.60E-02
step:  74, cost: 1.60E-02, attack: 0.989, loss: 0.898450, ce: 0.190094, reg: 44.272240, reg_best: 43.088753
step:  75, cost: 1.60E-02, attack: 0.993, loss: 0.851361, ce: 0.124508, reg: 45.428307, reg_best: 43.088753
step:  76, cost: 1.60E-02, attack: 0.993, loss: 0.849106, ce: 0.119993, reg: 45.569572, reg_best: 43.088753
step:  77, cost: 1.60E-02, attack: 0.991, loss: 0.859964, ce: 0.141295, reg: 44.916836, reg_best: 43.088753
step:  78, cost: 1.60E-02, attack: 0.993, loss: 0.854301, ce: 0.117690, reg: 46.038197, reg_best: 43.088753
step:  79, cost: 1.60E-02, attack: 0.993, loss: 0.885559, ce: 0.137458, reg: 46.756302, reg_best: 43.088753
up cost from 1.60E-02 to 3.20E-02
step:  80, cost: 3.20E-02, attack: 0.992, loss: 1.572832, ce: 0.130241, reg: 45.080967, reg_best: 43.088753
step:  81, cost: 3.20E-02, attack: 0.988, loss: 1.554558, ce: 0.198087, reg: 42.389721, reg_best: 43.088753
step:  82, cost: 3.20E-02, attack: 0.992, loss: 1.531588, ce: 0.125612, reg: 43.933819, reg_best: 43.088753
step:  83, cost: 3.20E-02, attack: 0.994, loss: 1.564586, ce: 0.121255, reg: 45.104088, reg_best: 43.088753
step:  84, cost: 3.20E-02, attack: 0.995, loss: 1.568749, ce: 0.106789, reg: 45.686268, reg_best: 43.088753
step:  85, cost: 3.20E-02, attack: 0.989, loss: 1.608396, ce: 0.216865, reg: 43.485344, reg_best: 43.088753
step:  86, cost: 3.20E-02, attack: 0.994, loss: 1.621220, ce: 0.098982, reg: 47.569923, reg_best: 43.088753
step:  87, cost: 3.20E-02, attack: 0.994, loss: 1.575179, ce: 0.104603, reg: 45.955498, reg_best: 43.088753
step:  88, cost: 3.20E-02, attack: 0.995, loss: 1.520509, ce: 0.108268, reg: 44.132523, reg_best: 43.088753
step:  89, cost: 3.20E-02, attack: 0.991, loss: 1.562825, ce: 0.152267, reg: 44.079941, reg_best: 43.088753
step:  90, cost: 3.20E-02, attack: 0.984, loss: 1.584458, ce: 0.280390, reg: 40.752113, reg_best: 43.088753
step:  91, cost: 3.20E-02, attack: 0.973, loss: 1.785543, ce: 0.438139, reg: 42.106354, reg_best: 43.088753
step:  92, cost: 3.20E-02, attack: 0.985, loss: 1.634312, ce: 0.245918, reg: 43.387306, reg_best: 43.088753
step:  93, cost: 3.20E-02, attack: 0.991, loss: 1.572752, ce: 0.158764, reg: 44.187107, reg_best: 43.088753
early stop
pattern, shape: (32, 32, 3), min: 0.000000, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 38: 42.613495
visualization cost 19.097798 seconds
processing label 39
resetting state
mask_tanh -3.8531731490855607 3.9915047425471117
pattern_tanh -4.739629722568012 4.526129047825069
step:   0, cost: 0.00E+00, attack: 0.850, loss: 2.591405, ce: 2.591405, reg: 568.225403, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.001818, ce: 0.001818, reg: 595.772827, reg_best: 595.772827
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000011, ce: 0.000011, reg: 599.730835, reg_best: 595.772827
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000051, ce: 0.000051, reg: 602.245361, reg_best: 595.772827
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000017, ce: 0.000017, reg: 613.581665, reg_best: 595.772827
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 614.435608, reg_best: 595.772827
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.498106, ce: 0.055609, reg: 442.496796, reg_best: 442.496796
step:   7, cost: 1.00E-03, attack: 0.997, loss: 0.374791, ce: 0.049860, reg: 324.930481, reg_best: 324.930481
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.269162, ce: 0.020849, reg: 248.312698, reg_best: 248.312698
step:   9, cost: 1.00E-03, attack: 0.997, loss: 0.252050, ce: 0.043530, reg: 208.519470, reg_best: 208.519470
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.384716, ce: 0.024280, reg: 180.217773, reg_best: 180.217773
step:  11, cost: 2.00E-03, attack: 0.999, loss: 0.335957, ce: 0.018715, reg: 158.621048, reg_best: 158.621048
step:  12, cost: 2.00E-03, attack: 0.999, loss: 0.315507, ce: 0.019916, reg: 147.795700, reg_best: 147.795700
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.293423, ce: 0.025834, reg: 133.788910, reg_best: 133.788910
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.272571, ce: 0.012132, reg: 130.219559, reg_best: 130.219559
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.994, loss: 0.582410, ce: 0.100259, reg: 120.537689, reg_best: 120.537689
step:  16, cost: 4.00E-03, attack: 0.999, loss: 0.474267, ce: 0.020944, reg: 113.330650, reg_best: 113.330650
step:  17, cost: 4.00E-03, attack: 0.996, loss: 0.521171, ce: 0.079563, reg: 110.402016, reg_best: 110.402016
step:  18, cost: 4.00E-03, attack: 0.997, loss: 0.488269, ce: 0.043077, reg: 111.297951, reg_best: 110.402016
step:  19, cost: 4.00E-03, attack: 0.999, loss: 0.455512, ce: 0.021544, reg: 108.492050, reg_best: 108.492050
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.989, loss: 0.986265, ce: 0.187408, reg: 99.857201, reg_best: 108.492050
step:  21, cost: 8.00E-03, attack: 0.996, loss: 0.876419, ce: 0.066234, reg: 101.273087, reg_best: 101.273087
step:  22, cost: 8.00E-03, attack: 0.993, loss: 0.908043, ce: 0.114519, reg: 99.190483, reg_best: 99.190483
step:  23, cost: 8.00E-03, attack: 0.995, loss: 0.876281, ce: 0.107287, reg: 96.124168, reg_best: 96.124168
step:  24, cost: 8.00E-03, attack: 0.997, loss: 0.830290, ce: 0.046601, reg: 97.961205, reg_best: 96.124168
step:  25, cost: 8.00E-03, attack: 0.993, loss: 0.880815, ce: 0.109956, reg: 96.357292, reg_best: 96.124168
up cost from 8.00E-03 to 1.60E-02
step:  26, cost: 1.60E-02, attack: 0.993, loss: 1.649588, ce: 0.128098, reg: 95.113914, reg_best: 95.113914
step:  27, cost: 1.60E-02, attack: 0.995, loss: 1.527452, ce: 0.089580, reg: 89.866966, reg_best: 89.866966
step:  28, cost: 1.60E-02, attack: 0.988, loss: 1.625985, ce: 0.204233, reg: 88.859489, reg_best: 89.866966
step:  29, cost: 1.60E-02, attack: 0.996, loss: 1.525336, ce: 0.073031, reg: 90.769104, reg_best: 89.866966
step:  30, cost: 1.60E-02, attack: 0.990, loss: 1.608511, ce: 0.168257, reg: 90.015839, reg_best: 89.866966
step:  31, cost: 1.60E-02, attack: 0.996, loss: 1.548385, ce: 0.094288, reg: 90.881020, reg_best: 89.866966
step:  32, cost: 1.60E-02, attack: 0.994, loss: 1.551337, ce: 0.093418, reg: 91.119919, reg_best: 89.866966
step:  33, cost: 1.60E-02, attack: 0.995, loss: 1.532011, ce: 0.078001, reg: 90.875641, reg_best: 89.866966
step:  34, cost: 1.60E-02, attack: 0.997, loss: 1.509163, ce: 0.073929, reg: 89.702164, reg_best: 89.702164
step:  35, cost: 1.60E-02, attack: 0.993, loss: 1.548496, ce: 0.121444, reg: 89.190735, reg_best: 89.190735
up cost from 1.60E-02 to 3.20E-02
step:  36, cost: 3.20E-02, attack: 0.990, loss: 2.961419, ce: 0.188130, reg: 86.665260, reg_best: 89.190735
step:  37, cost: 3.20E-02, attack: 0.982, loss: 2.952050, ce: 0.304523, reg: 82.735214, reg_best: 89.190735
step:  38, cost: 3.20E-02, attack: 0.982, loss: 3.062289, ce: 0.325112, reg: 85.536797, reg_best: 89.190735
step:  39, cost: 3.20E-02, attack: 0.984, loss: 2.988142, ce: 0.280909, reg: 84.598717, reg_best: 89.190735
step:  40, cost: 3.20E-02, attack: 0.991, loss: 2.930232, ce: 0.146675, reg: 86.986137, reg_best: 86.986137
step:  41, cost: 3.20E-02, attack: 0.979, loss: 2.995998, ce: 0.349828, reg: 82.692802, reg_best: 86.986137
step:  42, cost: 3.20E-02, attack: 0.980, loss: 2.925358, ce: 0.319851, reg: 81.422096, reg_best: 86.986137
step:  43, cost: 3.20E-02, attack: 0.982, loss: 2.917515, ce: 0.305813, reg: 81.615685, reg_best: 86.986137
step:  44, cost: 3.20E-02, attack: 0.984, loss: 2.978331, ce: 0.277678, reg: 84.395401, reg_best: 86.986137
step:  45, cost: 3.20E-02, attack: 0.987, loss: 2.869829, ce: 0.217582, reg: 82.882729, reg_best: 86.986137
down cost from 3.20E-02 to 1.13E-02
step:  46, cost: 1.13E-02, attack: 0.990, loss: 1.141919, ce: 0.172996, reg: 85.641457, reg_best: 86.986137
step:  47, cost: 1.13E-02, attack: 0.992, loss: 1.130588, ce: 0.145312, reg: 87.086945, reg_best: 86.986137
step:  48, cost: 1.13E-02, attack: 0.997, loss: 1.085947, ce: 0.070905, reg: 89.717865, reg_best: 86.986137
step:  49, cost: 1.13E-02, attack: 0.994, loss: 1.082402, ce: 0.106197, reg: 86.285210, reg_best: 86.285210
step:  50, cost: 1.13E-02, attack: 0.993, loss: 1.139673, ce: 0.113316, reg: 90.718048, reg_best: 86.285210
step:  51, cost: 1.13E-02, attack: 0.998, loss: 1.060876, ce: 0.045637, reg: 89.726974, reg_best: 86.285210
up cost from 1.13E-02 to 2.26E-02
step:  52, cost: 2.26E-02, attack: 0.991, loss: 2.099164, ce: 0.160235, reg: 85.689301, reg_best: 85.689301
step:  53, cost: 2.26E-02, attack: 0.984, loss: 2.132627, ce: 0.257547, reg: 82.867638, reg_best: 85.689301
step:  54, cost: 2.26E-02, attack: 0.995, loss: 2.008336, ce: 0.098426, reg: 84.406914, reg_best: 84.406914
step:  55, cost: 2.26E-02, attack: 0.989, loss: 2.072043, ce: 0.185496, reg: 83.374397, reg_best: 84.406914
step:  56, cost: 2.26E-02, attack: 0.988, loss: 2.108795, ce: 0.201622, reg: 84.285973, reg_best: 84.406914
step:  57, cost: 2.26E-02, attack: 0.982, loss: 2.179221, ce: 0.330129, reg: 81.719109, reg_best: 84.406914
step:  58, cost: 2.26E-02, attack: 0.986, loss: 2.160532, ce: 0.254760, reg: 84.224075, reg_best: 84.406914
step:  59, cost: 2.26E-02, attack: 0.985, loss: 2.129937, ce: 0.229924, reg: 83.969505, reg_best: 84.406914
down cost from 2.26E-02 to 8.00E-03
step:  60, cost: 8.00E-03, attack: 0.996, loss: 0.808884, ce: 0.079373, reg: 91.188965, reg_best: 84.406914
step:  61, cost: 8.00E-03, attack: 0.995, loss: 0.814065, ce: 0.094335, reg: 89.966194, reg_best: 84.406914
step:  62, cost: 8.00E-03, attack: 0.997, loss: 0.774298, ce: 0.054355, reg: 89.992836, reg_best: 84.406914
step:  63, cost: 8.00E-03, attack: 0.998, loss: 0.760935, ce: 0.045923, reg: 89.376534, reg_best: 84.406914
step:  64, cost: 8.00E-03, attack: 0.997, loss: 0.775875, ce: 0.076056, reg: 87.466972, reg_best: 84.406914
up cost from 8.00E-03 to 1.60E-02
step:  65, cost: 1.60E-02, attack: 0.992, loss: 1.537816, ce: 0.124917, reg: 88.306229, reg_best: 84.406914
step:  66, cost: 1.60E-02, attack: 0.993, loss: 1.520603, ce: 0.131668, reg: 86.808403, reg_best: 84.406914
step:  67, cost: 1.60E-02, attack: 0.999, loss: 1.436664, ce: 0.029295, reg: 87.960541, reg_best: 84.406914
step:  68, cost: 1.60E-02, attack: 0.992, loss: 1.496694, ce: 0.134390, reg: 85.143944, reg_best: 84.406914
step:  69, cost: 1.60E-02, attack: 0.995, loss: 1.455745, ce: 0.098923, reg: 84.801361, reg_best: 84.406914
up cost from 1.60E-02 to 3.20E-02
step:  70, cost: 3.20E-02, attack: 0.993, loss: 2.827105, ce: 0.129059, reg: 84.313942, reg_best: 84.313942
step:  71, cost: 3.20E-02, attack: 0.982, loss: 2.896199, ce: 0.324046, reg: 80.379768, reg_best: 84.313942
step:  72, cost: 3.20E-02, attack: 0.986, loss: 2.824652, ce: 0.230233, reg: 81.075584, reg_best: 84.313942
step:  73, cost: 3.20E-02, attack: 0.984, loss: 2.851860, ce: 0.300689, reg: 79.724091, reg_best: 84.313942
step:  74, cost: 3.20E-02, attack: 0.984, loss: 2.897572, ce: 0.282030, reg: 81.735672, reg_best: 84.313942
step:  75, cost: 3.20E-02, attack: 0.984, loss: 2.929809, ce: 0.275360, reg: 82.951515, reg_best: 84.313942
down cost from 3.20E-02 to 1.13E-02
step:  76, cost: 1.13E-02, attack: 0.994, loss: 1.089046, ce: 0.100146, reg: 87.407265, reg_best: 84.313942
step:  77, cost: 1.13E-02, attack: 0.997, loss: 1.047515, ce: 0.050046, reg: 88.164101, reg_best: 84.313942
step:  78, cost: 1.13E-02, attack: 0.996, loss: 1.089285, ce: 0.074127, reg: 89.728172, reg_best: 84.313942
step:  79, cost: 1.13E-02, attack: 0.996, loss: 1.070947, ce: 0.068499, reg: 88.604759, reg_best: 84.313942
step:  80, cost: 1.13E-02, attack: 0.998, loss: 1.012437, ce: 0.033792, reg: 86.500877, reg_best: 84.313942
up cost from 1.13E-02 to 2.26E-02
step:  81, cost: 2.26E-02, attack: 0.984, loss: 2.135223, ce: 0.265713, reg: 82.621475, reg_best: 84.313942
step:  82, cost: 2.26E-02, attack: 0.987, loss: 2.040946, ce: 0.205496, reg: 81.116180, reg_best: 84.313942
step:  83, cost: 2.26E-02, attack: 0.991, loss: 2.035192, ce: 0.152782, reg: 83.191544, reg_best: 83.191544
step:  84, cost: 2.26E-02, attack: 0.992, loss: 2.062584, ce: 0.126841, reg: 85.548592, reg_best: 83.191544
step:  85, cost: 2.26E-02, attack: 0.982, loss: 2.174524, ce: 0.277458, reg: 83.839310, reg_best: 83.191544
step:  86, cost: 2.26E-02, attack: 0.986, loss: 2.087112, ce: 0.214736, reg: 82.748100, reg_best: 83.191544
step:  87, cost: 2.26E-02, attack: 0.991, loss: 2.117367, ce: 0.143166, reg: 87.248146, reg_best: 83.191544
step:  88, cost: 2.26E-02, attack: 0.986, loss: 2.107239, ce: 0.237312, reg: 82.639908, reg_best: 83.191544
step:  89, cost: 2.26E-02, attack: 0.987, loss: 2.112341, ce: 0.224122, reg: 83.448280, reg_best: 83.191544
step:  90, cost: 2.26E-02, attack: 0.992, loss: 2.037950, ce: 0.117478, reg: 84.844391, reg_best: 83.191544
step:  91, cost: 2.26E-02, attack: 0.994, loss: 2.042297, ce: 0.084863, reg: 86.507149, reg_best: 83.191544
step:  92, cost: 2.26E-02, attack: 0.988, loss: 2.109062, ce: 0.180055, reg: 85.250862, reg_best: 83.191544
step:  93, cost: 2.26E-02, attack: 0.992, loss: 2.104622, ce: 0.145191, reg: 86.595406, reg_best: 83.191544
step:  94, cost: 2.26E-02, attack: 0.993, loss: 2.026283, ce: 0.141276, reg: 83.306328, reg_best: 83.191544
step:  95, cost: 2.26E-02, attack: 0.991, loss: 2.093741, ce: 0.161462, reg: 85.395485, reg_best: 83.191544
step:  96, cost: 2.26E-02, attack: 0.996, loss: 1.982594, ce: 0.092414, reg: 83.534935, reg_best: 83.191544
step:  97, cost: 2.26E-02, attack: 0.981, loss: 2.178449, ce: 0.292957, reg: 83.327766, reg_best: 83.191544
step:  98, cost: 2.26E-02, attack: 0.995, loss: 2.045225, ce: 0.078267, reg: 86.928085, reg_best: 83.191544
step:  99, cost: 2.26E-02, attack: 0.993, loss: 2.093294, ce: 0.128942, reg: 86.812912, reg_best: 83.191544
pattern, shape: (32, 32, 3), min: 0.000008, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 39: 81.532532
visualization cost 20.208321 seconds
processing label 40
resetting state
mask_tanh -3.0036873403696136 3.678999934198489
pattern_tanh -4.174491943980071 3.9222602115695713
step:   0, cost: 0.00E+00, attack: 0.875, loss: 2.074890, ce: 2.074890, reg: 533.206970, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.000345, ce: 0.000345, reg: 549.370483, reg_best: 549.370483
step:   2, cost: 0.00E+00, attack: 0.999, loss: 0.023601, ce: 0.023601, reg: 555.723816, reg_best: 549.370483
step:   3, cost: 0.00E+00, attack: 0.999, loss: 0.012554, ce: 0.012554, reg: 562.196533, reg_best: 549.370483
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000010, ce: 0.000010, reg: 563.600037, reg_best: 549.370483
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 564.237732, reg_best: 549.370483
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.431311, ce: 0.058111, reg: 373.200531, reg_best: 373.200531
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.300105, ce: 0.009668, reg: 290.437347, reg_best: 290.437347
step:   8, cost: 1.00E-03, attack: 0.999, loss: 0.238005, ce: 0.018126, reg: 219.878342, reg_best: 219.878342
step:   9, cost: 1.00E-03, attack: 0.998, loss: 0.235813, ce: 0.038580, reg: 197.232880, reg_best: 197.232880
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.361079, ce: 0.014201, reg: 173.438812, reg_best: 173.438812
step:  11, cost: 2.00E-03, attack: 1.000, loss: 0.312650, ce: 0.012272, reg: 150.188553, reg_best: 150.188553
step:  12, cost: 2.00E-03, attack: 1.000, loss: 0.268193, ce: 0.002933, reg: 132.630066, reg_best: 132.630066
step:  13, cost: 2.00E-03, attack: 0.996, loss: 0.318762, ce: 0.062072, reg: 128.345200, reg_best: 128.345200
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.268134, ce: 0.012501, reg: 127.816437, reg_best: 127.816437
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.996, loss: 0.535378, ce: 0.076216, reg: 114.795547, reg_best: 114.795547
step:  16, cost: 4.00E-03, attack: 0.996, loss: 0.506866, ce: 0.065423, reg: 110.360748, reg_best: 110.360748
step:  17, cost: 4.00E-03, attack: 0.999, loss: 0.460282, ce: 0.019135, reg: 110.286697, reg_best: 110.286697
step:  18, cost: 4.00E-03, attack: 0.999, loss: 0.445310, ce: 0.026086, reg: 104.805977, reg_best: 104.805977
step:  19, cost: 4.00E-03, attack: 0.997, loss: 0.444378, ce: 0.045340, reg: 99.759605, reg_best: 99.759605
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.997, loss: 0.849042, ce: 0.060920, reg: 98.515251, reg_best: 98.515251
step:  21, cost: 8.00E-03, attack: 0.998, loss: 0.805408, ce: 0.043124, reg: 95.285530, reg_best: 95.285530
step:  22, cost: 8.00E-03, attack: 0.994, loss: 0.852726, ce: 0.103027, reg: 93.712326, reg_best: 93.712326
step:  23, cost: 8.00E-03, attack: 0.999, loss: 0.795217, ce: 0.032677, reg: 95.317474, reg_best: 93.712326
step:  24, cost: 8.00E-03, attack: 0.993, loss: 0.846913, ce: 0.098474, reg: 93.554848, reg_best: 93.554848
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.996, loss: 1.567463, ce: 0.096386, reg: 91.942284, reg_best: 91.942284
step:  26, cost: 1.60E-02, attack: 0.997, loss: 1.539646, ce: 0.071874, reg: 91.735741, reg_best: 91.735741
step:  27, cost: 1.60E-02, attack: 0.991, loss: 1.558042, ce: 0.183785, reg: 85.891068, reg_best: 85.891068
step:  28, cost: 1.60E-02, attack: 0.996, loss: 1.448866, ce: 0.089408, reg: 84.966072, reg_best: 84.966072
step:  29, cost: 1.60E-02, attack: 0.993, loss: 1.451562, ce: 0.112350, reg: 83.700737, reg_best: 83.700737
up cost from 1.60E-02 to 3.20E-02
step:  30, cost: 3.20E-02, attack: 0.991, loss: 2.752170, ce: 0.119331, reg: 82.276207, reg_best: 82.276207
step:  31, cost: 3.20E-02, attack: 0.992, loss: 2.721068, ce: 0.159290, reg: 80.055557, reg_best: 80.055557
step:  32, cost: 3.20E-02, attack: 0.986, loss: 2.740605, ce: 0.225075, reg: 78.610298, reg_best: 80.055557
step:  33, cost: 3.20E-02, attack: 0.990, loss: 2.679412, ce: 0.174898, reg: 78.266052, reg_best: 80.055557
step:  34, cost: 3.20E-02, attack: 0.986, loss: 2.700868, ce: 0.232250, reg: 77.144295, reg_best: 80.055557
step:  35, cost: 3.20E-02, attack: 0.991, loss: 2.583807, ce: 0.176837, reg: 75.217812, reg_best: 75.217812
step:  36, cost: 3.20E-02, attack: 0.983, loss: 2.637487, ce: 0.277142, reg: 73.760773, reg_best: 75.217812
step:  37, cost: 3.20E-02, attack: 0.993, loss: 2.515667, ce: 0.146523, reg: 74.035721, reg_best: 74.035721
step:  38, cost: 3.20E-02, attack: 0.978, loss: 2.609610, ce: 0.358738, reg: 70.339752, reg_best: 74.035721
step:  39, cost: 3.20E-02, attack: 0.981, loss: 2.619321, ce: 0.306405, reg: 72.278625, reg_best: 74.035721
step:  40, cost: 3.20E-02, attack: 0.988, loss: 2.481951, ce: 0.215844, reg: 70.815857, reg_best: 74.035721
step:  41, cost: 3.20E-02, attack: 0.979, loss: 2.554454, ce: 0.374797, reg: 68.117744, reg_best: 74.035721
step:  42, cost: 3.20E-02, attack: 0.987, loss: 2.486842, ce: 0.229858, reg: 70.530746, reg_best: 74.035721
down cost from 3.20E-02 to 1.13E-02
step:  43, cost: 1.13E-02, attack: 0.983, loss: 1.093202, ce: 0.265023, reg: 73.201370, reg_best: 74.035721
step:  44, cost: 1.13E-02, attack: 0.993, loss: 0.950047, ce: 0.107478, reg: 74.473251, reg_best: 74.035721
step:  45, cost: 1.13E-02, attack: 0.995, loss: 0.933174, ce: 0.094976, reg: 74.087021, reg_best: 74.035721
step:  46, cost: 1.13E-02, attack: 0.990, loss: 0.974678, ce: 0.166606, reg: 71.424110, reg_best: 74.035721
step:  47, cost: 1.13E-02, attack: 0.995, loss: 0.911408, ce: 0.087549, reg: 72.819580, reg_best: 72.819580
step:  48, cost: 1.13E-02, attack: 0.994, loss: 0.907122, ce: 0.096901, reg: 71.614067, reg_best: 71.614067
step:  49, cost: 1.13E-02, attack: 0.991, loss: 0.984674, ce: 0.158255, reg: 73.045738, reg_best: 71.614067
step:  50, cost: 1.13E-02, attack: 0.994, loss: 0.931047, ce: 0.095027, reg: 73.894432, reg_best: 71.614067
step:  51, cost: 1.13E-02, attack: 0.993, loss: 0.933159, ce: 0.125331, reg: 71.402634, reg_best: 71.402634
up cost from 1.13E-02 to 2.26E-02
step:  52, cost: 2.26E-02, attack: 0.993, loss: 1.749965, ce: 0.128719, reg: 71.649605, reg_best: 71.402634
step:  53, cost: 2.26E-02, attack: 0.992, loss: 1.708147, ce: 0.124245, reg: 69.988701, reg_best: 69.988701
step:  54, cost: 2.26E-02, attack: 0.983, loss: 1.846400, ce: 0.297479, reg: 68.453270, reg_best: 69.988701
step:  55, cost: 2.26E-02, attack: 0.992, loss: 1.721965, ce: 0.145097, reg: 69.688370, reg_best: 69.688370
step:  56, cost: 2.26E-02, attack: 0.991, loss: 1.694895, ce: 0.158765, reg: 67.888008, reg_best: 67.888008
step:  57, cost: 2.26E-02, attack: 0.994, loss: 1.715916, ce: 0.107875, reg: 71.066048, reg_best: 67.888008
step:  58, cost: 2.26E-02, attack: 0.989, loss: 1.740364, ce: 0.202600, reg: 67.960190, reg_best: 67.888008
step:  59, cost: 2.26E-02, attack: 0.989, loss: 1.684176, ce: 0.173588, reg: 66.759171, reg_best: 67.888008
step:  60, cost: 2.26E-02, attack: 0.993, loss: 1.697098, ce: 0.156246, reg: 68.096649, reg_best: 67.888008
step:  61, cost: 2.26E-02, attack: 0.986, loss: 1.747379, ce: 0.241888, reg: 66.533928, reg_best: 67.888008
step:  62, cost: 2.26E-02, attack: 0.990, loss: 1.716151, ce: 0.188249, reg: 67.524338, reg_best: 67.888008
step:  63, cost: 2.26E-02, attack: 0.993, loss: 1.710571, ce: 0.124285, reg: 70.104637, reg_best: 67.888008
step:  64, cost: 2.26E-02, attack: 0.993, loss: 1.695807, ce: 0.097816, reg: 70.621895, reg_best: 67.888008
step:  65, cost: 2.26E-02, attack: 0.988, loss: 1.747264, ce: 0.180076, reg: 69.260574, reg_best: 67.888008
step:  66, cost: 2.26E-02, attack: 0.989, loss: 1.736688, ce: 0.183232, reg: 68.652794, reg_best: 67.888008
step:  67, cost: 2.26E-02, attack: 0.991, loss: 1.683257, ce: 0.182724, reg: 66.314827, reg_best: 66.314827
step:  68, cost: 2.26E-02, attack: 0.985, loss: 1.768781, ce: 0.242942, reg: 67.433189, reg_best: 66.314827
step:  69, cost: 2.26E-02, attack: 0.992, loss: 1.689508, ce: 0.147137, reg: 68.163818, reg_best: 66.314827
step:  70, cost: 2.26E-02, attack: 0.989, loss: 1.686957, ce: 0.194648, reg: 65.951347, reg_best: 66.314827
step:  71, cost: 2.26E-02, attack: 0.988, loss: 1.691075, ce: 0.186877, reg: 66.476791, reg_best: 66.314827
step:  72, cost: 2.26E-02, attack: 0.991, loss: 1.678425, ce: 0.151639, reg: 67.475052, reg_best: 66.314827
step:  73, cost: 2.26E-02, attack: 0.988, loss: 1.688100, ce: 0.186101, reg: 66.379578, reg_best: 66.314827
step:  74, cost: 2.26E-02, attack: 0.988, loss: 1.696293, ce: 0.190489, reg: 66.547760, reg_best: 66.314827
step:  75, cost: 2.26E-02, attack: 0.994, loss: 1.599626, ce: 0.104035, reg: 66.096405, reg_best: 66.096405
step:  76, cost: 2.26E-02, attack: 0.988, loss: 1.742770, ce: 0.201531, reg: 68.113754, reg_best: 66.096405
step:  77, cost: 2.26E-02, attack: 0.996, loss: 1.675581, ce: 0.081331, reg: 70.456604, reg_best: 66.096405
step:  78, cost: 2.26E-02, attack: 0.988, loss: 1.749728, ce: 0.205936, reg: 68.226601, reg_best: 66.096405
step:  79, cost: 2.26E-02, attack: 0.994, loss: 1.642441, ce: 0.123865, reg: 67.120415, reg_best: 66.096405
step:  80, cost: 2.26E-02, attack: 0.993, loss: 1.632905, ce: 0.107140, reg: 67.429970, reg_best: 66.096405
step:  81, cost: 2.26E-02, attack: 0.997, loss: 1.593506, ce: 0.069446, reg: 67.354546, reg_best: 66.096405
step:  82, cost: 2.26E-02, attack: 0.986, loss: 1.735289, ce: 0.212162, reg: 67.313332, reg_best: 66.096405
step:  83, cost: 2.26E-02, attack: 0.989, loss: 1.658851, ce: 0.190242, reg: 64.903954, reg_best: 66.096405
step:  84, cost: 2.26E-02, attack: 0.993, loss: 1.631681, ce: 0.128381, reg: 66.437096, reg_best: 66.096405
step:  85, cost: 2.26E-02, attack: 0.991, loss: 1.623755, ce: 0.130251, reg: 66.004158, reg_best: 66.004158
step:  86, cost: 2.26E-02, attack: 0.988, loss: 1.687897, ce: 0.206456, reg: 65.471077, reg_best: 66.004158
step:  87, cost: 2.26E-02, attack: 0.989, loss: 1.665804, ce: 0.190019, reg: 65.221100, reg_best: 66.004158
step:  88, cost: 2.26E-02, attack: 0.986, loss: 1.721846, ce: 0.228697, reg: 65.988503, reg_best: 66.004158
step:  89, cost: 2.26E-02, attack: 0.988, loss: 1.675137, ce: 0.203416, reg: 65.041481, reg_best: 66.004158
step:  90, cost: 2.26E-02, attack: 0.994, loss: 1.629848, ce: 0.128784, reg: 66.338295, reg_best: 66.004158
step:  91, cost: 2.26E-02, attack: 0.990, loss: 1.639905, ce: 0.172428, reg: 64.850571, reg_best: 66.004158
step:  92, cost: 2.26E-02, attack: 0.991, loss: 1.622083, ce: 0.167826, reg: 64.269676, reg_best: 64.269676
step:  93, cost: 2.26E-02, attack: 0.988, loss: 1.632050, ce: 0.204492, reg: 63.089748, reg_best: 64.269676
step:  94, cost: 2.26E-02, attack: 0.992, loss: 1.614957, ce: 0.130170, reg: 65.618942, reg_best: 64.269676
step:  95, cost: 2.26E-02, attack: 0.992, loss: 1.662976, ce: 0.117989, reg: 68.279411, reg_best: 64.269676
step:  96, cost: 2.26E-02, attack: 0.992, loss: 1.648795, ce: 0.127935, reg: 67.213181, reg_best: 64.269676
step:  97, cost: 2.26E-02, attack: 0.986, loss: 1.707192, ce: 0.235195, reg: 65.053665, reg_best: 64.269676
step:  98, cost: 2.26E-02, attack: 0.983, loss: 1.753124, ce: 0.277340, reg: 65.221046, reg_best: 64.269676
step:  99, cost: 2.26E-02, attack: 0.995, loss: 1.583592, ce: 0.091316, reg: 65.949905, reg_best: 64.269676
pattern, shape: (32, 32, 3), min: 0.000008, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 40: 64.831276
visualization cost 20.192419 seconds
processing label 41
resetting state
mask_tanh -3.0520725354513845 4.905224720500328
pattern_tanh -4.6065009995915736 4.9602351200183135
step:   0, cost: 0.00E+00, attack: 0.754, loss: 4.188978, ce: 4.188978, reg: 562.732849, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.002714, ce: 0.002714, reg: 598.718201, reg_best: 598.718201
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000038, ce: 0.000038, reg: 600.445496, reg_best: 598.718201
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000005, ce: 0.000005, reg: 601.568115, reg_best: 598.718201
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000002, ce: 0.000002, reg: 602.311951, reg_best: 598.718201
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000000, ce: 0.000000, reg: 604.404053, reg_best: 598.718201
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.997, loss: 0.473949, ce: 0.042513, reg: 431.435120, reg_best: 431.435120
step:   7, cost: 1.00E-03, attack: 0.998, loss: 0.361954, ce: 0.032587, reg: 329.367035, reg_best: 329.367035
step:   8, cost: 1.00E-03, attack: 0.996, loss: 0.325608, ce: 0.065531, reg: 260.076813, reg_best: 260.076813
step:   9, cost: 1.00E-03, attack: 0.999, loss: 0.249021, ce: 0.018280, reg: 230.740799, reg_best: 230.740799
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 0.999, loss: 0.411361, ce: 0.018884, reg: 196.238602, reg_best: 196.238602
step:  11, cost: 2.00E-03, attack: 0.997, loss: 0.381023, ce: 0.055973, reg: 162.525360, reg_best: 162.525360
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.334926, ce: 0.031128, reg: 151.898865, reg_best: 151.898865
step:  13, cost: 2.00E-03, attack: 0.999, loss: 0.310116, ce: 0.020647, reg: 144.734406, reg_best: 144.734406
step:  14, cost: 2.00E-03, attack: 0.997, loss: 0.329619, ce: 0.056968, reg: 136.325378, reg_best: 136.325378
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.997, loss: 0.587320, ce: 0.049126, reg: 134.548386, reg_best: 134.548386
step:  16, cost: 4.00E-03, attack: 0.998, loss: 0.528886, ce: 0.027460, reg: 125.356354, reg_best: 125.356354
step:  17, cost: 4.00E-03, attack: 0.997, loss: 0.543901, ce: 0.060099, reg: 120.983299, reg_best: 120.983299
step:  18, cost: 4.00E-03, attack: 0.996, loss: 0.523275, ce: 0.070452, reg: 113.205513, reg_best: 113.205513
step:  19, cost: 4.00E-03, attack: 0.997, loss: 0.488015, ce: 0.043560, reg: 111.113708, reg_best: 111.113708
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.990, loss: 0.982763, ce: 0.151940, reg: 103.852890, reg_best: 111.113708
step:  21, cost: 8.00E-03, attack: 0.991, loss: 0.986954, ce: 0.137693, reg: 106.157623, reg_best: 106.157623
step:  22, cost: 8.00E-03, attack: 0.995, loss: 0.892076, ce: 0.088160, reg: 100.489594, reg_best: 100.489594
step:  23, cost: 8.00E-03, attack: 0.999, loss: 0.830541, ce: 0.026384, reg: 100.519585, reg_best: 100.489594
step:  24, cost: 8.00E-03, attack: 0.994, loss: 0.858172, ce: 0.087327, reg: 96.355659, reg_best: 96.355659
step:  25, cost: 8.00E-03, attack: 0.996, loss: 0.886636, ce: 0.069436, reg: 102.150009, reg_best: 96.355659
up cost from 8.00E-03 to 1.60E-02
step:  26, cost: 1.60E-02, attack: 0.985, loss: 1.672630, ce: 0.247557, reg: 89.067047, reg_best: 96.355659
step:  27, cost: 1.60E-02, attack: 0.990, loss: 1.593671, ce: 0.164213, reg: 89.341110, reg_best: 96.355659
step:  28, cost: 1.60E-02, attack: 0.990, loss: 1.560582, ce: 0.170606, reg: 86.873451, reg_best: 96.355659
step:  29, cost: 1.60E-02, attack: 0.985, loss: 1.595802, ce: 0.214021, reg: 86.361313, reg_best: 96.355659
step:  30, cost: 1.60E-02, attack: 0.992, loss: 1.542790, ce: 0.146350, reg: 87.298561, reg_best: 87.298561
step:  31, cost: 1.60E-02, attack: 0.993, loss: 1.508744, ce: 0.133823, reg: 85.932587, reg_best: 85.932587
step:  32, cost: 1.60E-02, attack: 0.995, loss: 1.499095, ce: 0.112807, reg: 86.642982, reg_best: 85.932587
step:  33, cost: 1.60E-02, attack: 0.986, loss: 1.602013, ce: 0.211982, reg: 86.876945, reg_best: 85.932587
step:  34, cost: 1.60E-02, attack: 0.997, loss: 1.464783, ce: 0.081024, reg: 86.484947, reg_best: 85.932587
step:  35, cost: 1.60E-02, attack: 0.995, loss: 1.476784, ce: 0.100996, reg: 85.986679, reg_best: 85.932587
step:  36, cost: 1.60E-02, attack: 0.994, loss: 1.513176, ce: 0.115392, reg: 87.361481, reg_best: 85.932587
step:  37, cost: 1.60E-02, attack: 0.986, loss: 1.580443, ce: 0.236174, reg: 84.016792, reg_best: 85.932587
step:  38, cost: 1.60E-02, attack: 0.997, loss: 1.414917, ce: 0.056385, reg: 84.908279, reg_best: 84.908279
step:  39, cost: 1.60E-02, attack: 0.990, loss: 1.470597, ce: 0.134229, reg: 83.523026, reg_best: 84.908279
step:  40, cost: 1.60E-02, attack: 0.993, loss: 1.472556, ce: 0.115794, reg: 84.797615, reg_best: 84.797615
step:  41, cost: 1.60E-02, attack: 0.991, loss: 1.431910, ce: 0.169409, reg: 78.906281, reg_best: 78.906281
step:  42, cost: 1.60E-02, attack: 0.991, loss: 1.432690, ce: 0.159872, reg: 79.554497, reg_best: 78.906281
step:  43, cost: 1.60E-02, attack: 0.992, loss: 1.430693, ce: 0.140155, reg: 80.658646, reg_best: 78.906281
step:  44, cost: 1.60E-02, attack: 0.993, loss: 1.438741, ce: 0.123000, reg: 82.233803, reg_best: 78.906281
up cost from 1.60E-02 to 3.20E-02
step:  45, cost: 3.20E-02, attack: 0.990, loss: 2.730121, ce: 0.158329, reg: 80.368500, reg_best: 78.906281
step:  46, cost: 3.20E-02, attack: 0.988, loss: 2.697201, ce: 0.194343, reg: 78.214294, reg_best: 78.906281
step:  47, cost: 3.20E-02, attack: 0.982, loss: 2.678476, ce: 0.296743, reg: 74.429146, reg_best: 78.906281
step:  48, cost: 3.20E-02, attack: 0.983, loss: 2.749789, ce: 0.287730, reg: 76.939362, reg_best: 78.906281
step:  49, cost: 3.20E-02, attack: 0.979, loss: 2.793182, ce: 0.350970, reg: 76.319122, reg_best: 78.906281
down cost from 3.20E-02 to 1.13E-02
step:  50, cost: 1.13E-02, attack: 0.996, loss: 1.010524, ce: 0.081693, reg: 82.097839, reg_best: 78.906281
step:  51, cost: 1.13E-02, attack: 0.993, loss: 1.034688, ce: 0.118225, reg: 81.004707, reg_best: 78.906281
step:  52, cost: 1.13E-02, attack: 0.995, loss: 1.007027, ce: 0.084881, reg: 81.506943, reg_best: 78.906281
step:  53, cost: 1.13E-02, attack: 0.995, loss: 1.036664, ce: 0.100643, reg: 82.733376, reg_best: 78.906281
step:  54, cost: 1.13E-02, attack: 0.987, loss: 1.108824, ce: 0.216058, reg: 78.910080, reg_best: 78.906281
step:  55, cost: 1.13E-02, attack: 0.993, loss: 1.058699, ce: 0.123442, reg: 82.692184, reg_best: 78.906281
step:  56, cost: 1.13E-02, attack: 0.993, loss: 1.034392, ce: 0.122995, reg: 80.556877, reg_best: 78.906281
step:  57, cost: 1.13E-02, attack: 0.995, loss: 0.984525, ce: 0.079323, reg: 80.009300, reg_best: 78.906281
step:  58, cost: 1.13E-02, attack: 0.991, loss: 1.076897, ce: 0.167716, reg: 80.361038, reg_best: 78.906281
step:  59, cost: 1.13E-02, attack: 0.990, loss: 1.056220, ce: 0.165562, reg: 78.723816, reg_best: 78.906281
step:  60, cost: 1.13E-02, attack: 0.991, loss: 1.079412, ce: 0.146009, reg: 82.501884, reg_best: 78.906281
step:  61, cost: 1.13E-02, attack: 0.991, loss: 1.064010, ce: 0.149304, reg: 80.849312, reg_best: 78.906281
step:  62, cost: 1.13E-02, attack: 0.996, loss: 0.993969, ce: 0.079230, reg: 80.852287, reg_best: 78.906281
step:  63, cost: 1.13E-02, attack: 0.995, loss: 1.018072, ce: 0.096206, reg: 81.482208, reg_best: 78.906281
step:  64, cost: 1.13E-02, attack: 0.992, loss: 1.044857, ce: 0.120888, reg: 81.668121, reg_best: 78.906281
up cost from 1.13E-02 to 2.26E-02
step:  65, cost: 2.26E-02, attack: 0.986, loss: 1.938921, ce: 0.220674, reg: 75.936501, reg_best: 78.906281
step:  66, cost: 2.26E-02, attack: 0.986, loss: 1.946734, ce: 0.224397, reg: 76.117294, reg_best: 78.906281
early stop
pattern, shape: (32, 32, 3), min: 0.000008, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 41: 81.701263
visualization cost 13.596260 seconds
processing label 42
resetting state
mask_tanh -3.7974376095680342 3.087083176752071
pattern_tanh -4.653177318364729 4.053083199289308
step:   0, cost: 0.00E+00, attack: 0.845, loss: 2.607391, ce: 2.607391, reg: 561.088196, reg_best: inf
step:   1, cost: 0.00E+00, attack: 1.000, loss: 0.001855, ce: 0.001855, reg: 582.452881, reg_best: 582.452881
step:   2, cost: 0.00E+00, attack: 1.000, loss: 0.000055, ce: 0.000055, reg: 583.878845, reg_best: 582.452881
step:   3, cost: 0.00E+00, attack: 1.000, loss: 0.000018, ce: 0.000018, reg: 587.100220, reg_best: 582.452881
step:   4, cost: 0.00E+00, attack: 1.000, loss: 0.000004, ce: 0.000004, reg: 591.269531, reg_best: 582.452881
step:   5, cost: 0.00E+00, attack: 1.000, loss: 0.000001, ce: 0.000001, reg: 594.778198, reg_best: 582.452881
initialize cost to 1.00E-03
step:   6, cost: 1.00E-03, attack: 0.998, loss: 0.496048, ce: 0.029185, reg: 466.862915, reg_best: 466.862915
step:   7, cost: 1.00E-03, attack: 1.000, loss: 0.358782, ce: 0.002748, reg: 356.033997, reg_best: 356.033997
step:   8, cost: 1.00E-03, attack: 1.000, loss: 0.287762, ce: 0.009092, reg: 278.670105, reg_best: 278.670105
step:   9, cost: 1.00E-03, attack: 1.000, loss: 0.242287, ce: 0.010280, reg: 232.006851, reg_best: 232.006851
up cost from 1.00E-03 to 2.00E-03
step:  10, cost: 2.00E-03, attack: 1.000, loss: 0.411201, ce: 0.006323, reg: 202.439270, reg_best: 202.439270
step:  11, cost: 2.00E-03, attack: 0.998, loss: 0.401194, ce: 0.028826, reg: 186.183807, reg_best: 186.183807
step:  12, cost: 2.00E-03, attack: 0.998, loss: 0.351798, ce: 0.034575, reg: 158.611588, reg_best: 158.611588
step:  13, cost: 2.00E-03, attack: 0.997, loss: 0.343082, ce: 0.041844, reg: 150.619064, reg_best: 150.619064
step:  14, cost: 2.00E-03, attack: 0.999, loss: 0.306606, ce: 0.015412, reg: 145.580597, reg_best: 145.580597
up cost from 2.00E-03 to 4.00E-03
step:  15, cost: 4.00E-03, attack: 0.997, loss: 0.588088, ce: 0.059419, reg: 132.167297, reg_best: 132.167297
step:  16, cost: 4.00E-03, attack: 1.000, loss: 0.531462, ce: 0.025801, reg: 126.415039, reg_best: 126.415039
step:  17, cost: 4.00E-03, attack: 0.998, loss: 0.523776, ce: 0.027489, reg: 124.071777, reg_best: 124.071777
step:  18, cost: 4.00E-03, attack: 0.995, loss: 0.543041, ce: 0.085844, reg: 114.299088, reg_best: 114.299088
step:  19, cost: 4.00E-03, attack: 0.998, loss: 0.481577, ce: 0.033829, reg: 111.936813, reg_best: 111.936813
up cost from 4.00E-03 to 8.00E-03
step:  20, cost: 8.00E-03, attack: 0.995, loss: 0.916624, ce: 0.087294, reg: 103.666267, reg_best: 103.666267
step:  21, cost: 8.00E-03, attack: 0.999, loss: 0.874592, ce: 0.033020, reg: 105.196541, reg_best: 103.666267
step:  22, cost: 8.00E-03, attack: 0.998, loss: 0.847394, ce: 0.044401, reg: 100.374138, reg_best: 100.374138
step:  23, cost: 8.00E-03, attack: 0.997, loss: 0.833587, ce: 0.062307, reg: 96.410049, reg_best: 96.410049
step:  24, cost: 8.00E-03, attack: 0.998, loss: 0.823959, ce: 0.044273, reg: 97.460831, reg_best: 96.410049
up cost from 8.00E-03 to 1.60E-02
step:  25, cost: 1.60E-02, attack: 0.989, loss: 1.621583, ce: 0.183149, reg: 89.902100, reg_best: 96.410049
step:  26, cost: 1.60E-02, attack: 0.994, loss: 1.534814, ce: 0.130945, reg: 87.741982, reg_best: 87.741982
step:  27, cost: 1.60E-02, attack: 0.994, loss: 1.486877, ce: 0.110320, reg: 86.034798, reg_best: 86.034798
step:  28, cost: 1.60E-02, attack: 0.990, loss: 1.538219, ce: 0.172358, reg: 85.366371, reg_best: 86.034798
step:  29, cost: 1.60E-02, attack: 0.993, loss: 1.503908, ce: 0.125127, reg: 86.173820, reg_best: 86.034798
step:  30, cost: 1.60E-02, attack: 0.984, loss: 1.592450, ce: 0.232546, reg: 84.994003, reg_best: 86.034798
step:  31, cost: 1.60E-02, attack: 0.993, loss: 1.485331, ce: 0.124132, reg: 85.074936, reg_best: 85.074936
step:  32, cost: 1.60E-02, attack: 0.990, loss: 1.516086, ce: 0.156480, reg: 84.975380, reg_best: 85.074936
step:  33, cost: 1.60E-02, attack: 0.991, loss: 1.449679, ce: 0.153030, reg: 81.040520, reg_best: 81.040520
step:  34, cost: 1.60E-02, attack: 0.990, loss: 1.509777, ce: 0.161491, reg: 84.267921, reg_best: 81.040520
step:  35, cost: 1.60E-02, attack: 0.993, loss: 1.448051, ce: 0.124335, reg: 82.732262, reg_best: 81.040520
step:  36, cost: 1.60E-02, attack: 0.995, loss: 1.460872, ce: 0.091234, reg: 85.602371, reg_best: 81.040520
step:  37, cost: 1.60E-02, attack: 0.995, loss: 1.463002, ce: 0.102840, reg: 85.010124, reg_best: 81.040520
step:  38, cost: 1.60E-02, attack: 0.992, loss: 1.448110, ce: 0.120907, reg: 82.950233, reg_best: 81.040520
step:  39, cost: 1.60E-02, attack: 0.990, loss: 1.519799, ce: 0.164915, reg: 84.695282, reg_best: 81.040520
step:  40, cost: 1.60E-02, attack: 0.996, loss: 1.423355, ce: 0.070745, reg: 84.538155, reg_best: 81.040520
step:  41, cost: 1.60E-02, attack: 0.997, loss: 1.402218, ce: 0.069375, reg: 83.302719, reg_best: 81.040520
step:  42, cost: 1.60E-02, attack: 0.979, loss: 1.597223, ce: 0.316088, reg: 80.070946, reg_best: 81.040520
step:  43, cost: 1.60E-02, attack: 0.989, loss: 1.478215, ce: 0.190034, reg: 80.511276, reg_best: 81.040520
step:  44, cost: 1.60E-02, attack: 0.995, loss: 1.435305, ce: 0.091498, reg: 83.987885, reg_best: 81.040520
step:  45, cost: 1.60E-02, attack: 0.994, loss: 1.414272, ce: 0.103468, reg: 81.925262, reg_best: 81.040520
step:  46, cost: 1.60E-02, attack: 0.990, loss: 1.473951, ce: 0.162346, reg: 81.975334, reg_best: 81.040520
step:  47, cost: 1.60E-02, attack: 0.995, loss: 1.404938, ce: 0.097885, reg: 81.690781, reg_best: 81.040520
step:  48, cost: 1.60E-02, attack: 0.995, loss: 1.411073, ce: 0.097557, reg: 82.094795, reg_best: 81.040520
step:  49, cost: 1.60E-02, attack: 0.990, loss: 1.460514, ce: 0.159965, reg: 81.284286, reg_best: 81.040520
step:  50, cost: 1.60E-02, attack: 0.987, loss: 1.482722, ce: 0.192531, reg: 80.636955, reg_best: 81.040520
step:  51, cost: 1.60E-02, attack: 0.992, loss: 1.425133, ce: 0.126134, reg: 81.187393, reg_best: 81.040520
step:  52, cost: 1.60E-02, attack: 0.996, loss: 1.395122, ce: 0.074304, reg: 82.566185, reg_best: 81.040520
step:  53, cost: 1.60E-02, attack: 0.991, loss: 1.455635, ce: 0.161932, reg: 80.856430, reg_best: 80.856430
step:  54, cost: 1.60E-02, attack: 0.994, loss: 1.419161, ce: 0.104863, reg: 82.143623, reg_best: 80.856430
step:  55, cost: 1.60E-02, attack: 0.996, loss: 1.396821, ce: 0.083345, reg: 82.092216, reg_best: 80.856430
up cost from 1.60E-02 to 3.20E-02
step:  56, cost: 3.20E-02, attack: 0.989, loss: 2.720428, ce: 0.180243, reg: 79.380783, reg_best: 80.856430
step:  57, cost: 3.20E-02, attack: 0.988, loss: 2.686265, ce: 0.222768, reg: 76.984299, reg_best: 80.856430
step:  58, cost: 3.20E-02, attack: 0.988, loss: 2.694252, ce: 0.235483, reg: 76.836517, reg_best: 80.856430
step:  59, cost: 3.20E-02, attack: 0.981, loss: 2.758450, ce: 0.305729, reg: 76.647507, reg_best: 80.856430
step:  60, cost: 3.20E-02, attack: 0.985, loss: 2.735341, ce: 0.242999, reg: 77.885696, reg_best: 80.856430
down cost from 3.20E-02 to 1.13E-02
step:  61, cost: 1.13E-02, attack: 0.995, loss: 1.003164, ce: 0.086340, reg: 81.036575, reg_best: 80.856430
step:  62, cost: 1.13E-02, attack: 0.991, loss: 1.077767, ce: 0.180086, reg: 79.344620, reg_best: 79.344620
step:  63, cost: 1.13E-02, attack: 0.992, loss: 1.077065, ce: 0.144445, reg: 82.432770, reg_best: 79.344620
step:  64, cost: 1.13E-02, attack: 0.993, loss: 1.039105, ce: 0.108730, reg: 82.234306, reg_best: 79.344620
step:  65, cost: 1.13E-02, attack: 0.995, loss: 1.013721, ce: 0.097002, reg: 81.058212, reg_best: 79.344620
up cost from 1.13E-02 to 2.26E-02
step:  66, cost: 2.26E-02, attack: 0.995, loss: 1.941686, ce: 0.117871, reg: 80.601959, reg_best: 79.344620
step:  67, cost: 2.26E-02, attack: 0.990, loss: 1.976252, ce: 0.169597, reg: 79.843613, reg_best: 79.344620
step:  68, cost: 2.26E-02, attack: 0.987, loss: 1.991506, ce: 0.229983, reg: 77.849060, reg_best: 79.344620
step:  69, cost: 2.26E-02, attack: 0.993, loss: 1.928903, ce: 0.121593, reg: 79.872604, reg_best: 79.344620
step:  70, cost: 2.26E-02, attack: 0.991, loss: 1.951932, ce: 0.179804, reg: 78.317719, reg_best: 78.317719
step:  71, cost: 2.26E-02, attack: 0.983, loss: 2.020636, ce: 0.270677, reg: 77.338036, reg_best: 78.317719
step:  72, cost: 2.26E-02, attack: 0.986, loss: 1.986427, ce: 0.223793, reg: 77.898148, reg_best: 78.317719
step:  73, cost: 2.26E-02, attack: 0.990, loss: 1.923606, ce: 0.151028, reg: 78.337639, reg_best: 78.317719
step:  74, cost: 2.26E-02, attack: 0.993, loss: 1.932752, ce: 0.140399, reg: 79.211571, reg_best: 78.317719
step:  75, cost: 2.26E-02, attack: 0.981, loss: 2.061564, ce: 0.321287, reg: 76.910110, reg_best: 78.317719
step:  76, cost: 2.26E-02, attack: 0.989, loss: 1.951182, ce: 0.188317, reg: 77.908371, reg_best: 78.317719
step:  77, cost: 2.26E-02, attack: 0.981, loss: 2.047900, ce: 0.315553, reg: 76.581497, reg_best: 78.317719
step:  78, cost: 2.26E-02, attack: 0.989, loss: 1.940920, ce: 0.185717, reg: 77.569763, reg_best: 78.317719
step:  79, cost: 2.26E-02, attack: 0.980, loss: 2.038924, ce: 0.307001, reg: 76.540901, reg_best: 78.317719
down cost from 2.26E-02 to 8.00E-03
step:  80, cost: 8.00E-03, attack: 0.990, loss: 0.795290, ce: 0.154010, reg: 80.159935, reg_best: 78.317719
step:  81, cost: 8.00E-03, attack: 0.998, loss: 0.708636, ce: 0.044448, reg: 83.023460, reg_best: 78.317719
step:  82, cost: 8.00E-03, attack: 0.997, loss: 0.737023, ce: 0.075355, reg: 82.708572, reg_best: 78.317719
step:  83, cost: 8.00E-03, attack: 0.995, loss: 0.744777, ce: 0.067686, reg: 84.636429, reg_best: 78.317719
step:  84, cost: 8.00E-03, attack: 0.997, loss: 0.704845, ce: 0.043242, reg: 82.700470, reg_best: 78.317719
step:  85, cost: 8.00E-03, attack: 0.992, loss: 0.820055, ce: 0.156954, reg: 82.887558, reg_best: 78.317719
up cost from 8.00E-03 to 1.60E-02
step:  86, cost: 1.60E-02, attack: 0.992, loss: 1.445356, ce: 0.120671, reg: 82.792839, reg_best: 78.317719
step:  87, cost: 1.60E-02, attack: 0.993, loss: 1.422394, ce: 0.109558, reg: 82.052200, reg_best: 78.317719
step:  88, cost: 1.60E-02, attack: 0.993, loss: 1.411108, ce: 0.106024, reg: 81.567757, reg_best: 78.317719
step:  89, cost: 1.60E-02, attack: 0.995, loss: 1.370139, ce: 0.082203, reg: 80.495949, reg_best: 78.317719
step:  90, cost: 1.60E-02, attack: 0.996, loss: 1.361844, ce: 0.078819, reg: 80.180733, reg_best: 78.317719
up cost from 1.60E-02 to 3.20E-02
step:  91, cost: 3.20E-02, attack: 0.985, loss: 2.719508, ce: 0.240844, reg: 77.458244, reg_best: 78.317719
step:  92, cost: 3.20E-02, attack: 0.988, loss: 2.676660, ce: 0.217709, reg: 76.842239, reg_best: 78.317719
step:  93, cost: 3.20E-02, attack: 0.988, loss: 2.706006, ce: 0.191002, reg: 78.593826, reg_best: 78.317719
step:  94, cost: 3.20E-02, attack: 0.992, loss: 2.594295, ce: 0.144863, reg: 76.544746, reg_best: 76.544746
step:  95, cost: 3.20E-02, attack: 0.987, loss: 2.708970, ce: 0.213999, reg: 77.967812, reg_best: 76.544746
step:  96, cost: 3.20E-02, attack: 0.987, loss: 2.732587, ce: 0.239606, reg: 77.905670, reg_best: 76.544746
step:  97, cost: 3.20E-02, attack: 0.980, loss: 2.776888, ce: 0.313539, reg: 76.979675, reg_best: 76.544746
step:  98, cost: 3.20E-02, attack: 0.986, loss: 2.706929, ce: 0.228579, reg: 77.448433, reg_best: 76.544746
step:  99, cost: 3.20E-02, attack: 0.984, loss: 2.754886, ce: 0.266979, reg: 77.747101, reg_best: 76.544746
down cost from 3.20E-02 to 1.13E-02
pattern, shape: (32, 32, 3), min: 0.000000, max: 255.000000
mask, shape: (32, 32), min: 0.000000, max: 1.000000
mask norm of label 42: 75.804520
visualization cost 20.268992 seconds
elapsed time 874.2579510211945 s
